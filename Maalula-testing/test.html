<head>

<title>Maalula Perfects</title>

<style>
.header {
    background-color: lightgray;
    border: none;
    color: black;
    padding: 17px 25px;
    text-align: center;
    font-size: 36px;
    width: 1000px;
}
</style>

</head>


<meta charset="UTF-8">
<h2 id="dictName" class="header"> 
  Maalula Perfects Database
</h2>

<span id="keyboard">
 &nbsp;
  <button onclick="keyb('a')" style="font-size:10pt;height:27px;width:22px">a</button>
  <button onclick="keyb('b')" style="font-size:10pt;height:27px;width:22px">b</button>
  <button onclick="keyb('c')" style="font-size:10pt;height:27px;width:22px">c</button>
  <button onclick="keyb('d')" style="font-size:10pt;height:27px;width:22px">d</button>
  <button onclick="keyb('e')" style="font-size:10pt;height:27px;width:22px">e</button>
  <button onclick="keyb('f')" style="font-size:10pt;height:27px;width:22px">f</button>
  <button onclick="keyb('g')" style="font-size:10pt;height:27px;width:22px">g</button>
  <button onclick="keyb('h')" style="font-size:10pt;height:27px;width:22px">h</button>
  <button onclick="keyb('i')" style="font-size:10pt;height:27px;width:22px">i</button>
  <button onclick="keyb('j')" style="font-size:10pt;height:27px;width:22px">j</button>
  <button onclick="keyb('k')" style="font-size:10pt;height:27px;width:22px">k</button>
  <button onclick="keyb('l')" style="font-size:10pt;height:27px;width:22px">l</button>
  <button onclick="keyb('m')" style="font-size:10pt;height:27px;width:22px">m</button>
  <button onclick="keyb('n')" style="font-size:10pt;height:27px;width:22px">n</button>
  <button onclick="keyb('o')" style="font-size:10pt;height:27px;width:22px">o</button>
  <button onclick="keyb('p')" style="font-size:10pt;height:27px;width:22px">p</button>
  <button onclick="keyb('q')" style="font-size:10pt;height:27px;width:22px">q</button>
  <button onclick="keyb('r')" style="font-size:10pt;height:27px;width:22px">r</button>
  <button onclick="keyb('s')" style="font-size:10pt;height:27px;width:22px">s</button>
  <button onclick="keyb('t')" style="font-size:10pt;height:27px;width:22px">t</button>
  <button onclick="keyb('u')" style="font-size:10pt;height:27px;width:22px">u</button>
  <button onclick="keyb('v')" style="font-size:10pt;height:27px;width:22px">v</button>
  <button onclick="keyb('w')" style="font-size:10pt;height:27px;width:22px">w</button>
  <button onclick="keyb('x')" style="font-size:10pt;height:27px;width:22px">x</button>
  <button onclick="keyb('y')" style="font-size:10pt;height:27px;width:22px">y</button>
  <button onclick="keyb('z')" style="font-size:10pt;height:27px;width:22px">z</button>
  &nbsp;
  <button onclick="keyb('space')" style="color:#008000;font-size:10pt;height:27px;width:53px">Space</button>
  <button onclick="keyb('del')" style="color:#008000;font-size:10pt;height:27px;width:40px">Del</button>
  <button onclick="keyb('⌫')" style="color:#008000;font-size:10pt;height:27px;width:35px">⌫</button>
 
  <div style="line-height:40%;">
    <br>
  </div>&nbsp;
  

  <button onclick="keyb('^')" style="color:#cc0066;font-size:16pt;height:40px;width:40px">^</button>
  <button onclick="keyb('*')" style="color:#cc0066;font-size:16pt;height:40px;width:40px">*</button>
  <button onclick="keyb('+')" style="color:#cc0066;font-size:16pt;height:40px;width:40px">+</button>
  <button onclick="keyb('?')" style="color:#cc0066;font-size:16pt;height:40px;width:40px">?</button>
  <button onclick="keyb('\\b')" style="color:#cc0066;font-size:16pt;height:40px;width:40px">\b</button>
  <button onclick="keyb('\\w')" style="color:#cc0066;font-size:16pt;height:40px;width:40px">\w</button>
  &nbsp;
  <button onclick="keyb('ʕ')" style="font-size:16pt;height:40px;width:40px">ʕ</button>
  <button onclick="keyb('ʔ')" style="font-size:16pt;height:40px;width:40px">ʔ</button>
  <button onclick="keyb('č')" style="font-size:16pt;height:40px;width:40px">č</button>
  <button onclick="keyb('ḏ')" style="font-size:16pt;height:40px;width:40px">ḏ</button>
  <button onclick="keyb('ḏ̣')" style="font-size:16pt;height:40px;width:40px">ḏ̣</button>
  <button onclick="keyb('ə')" style="font-size:16pt;height:40px;width:40px">ə</button>
  <button onclick="keyb('ġ')" style="font-size:16pt;height:40px;width:40px">ġ</button>
  <button onclick="keyb('ǧ')" style="font-size:16pt;height:40px;width:40px">ǧ</button>
  <button onclick="keyb('ḥ')" style="font-size:16pt;height:40px;width:40px">ḥ</button>
  <button onclick="keyb('ṣ')" style="font-size:16pt;height:40px;width:40px">ṣ</button>
  <button onclick="keyb('š')" style="font-size:16pt;height:40px;width:40px">š</button>
  <button onclick="keyb('ṭ')" style="font-size:16pt;height:40px;width:40px">ṭ</button>
  <button onclick="keyb('ṯ')" style="font-size:16pt;height:40px;width:40px">ṯ</button>
  <button onclick="keyb('ž')" style="font-size:16pt;height:40px;width:40px">ž</button>
  <br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  

<b>Case-insensitive:</b> <input type="checkbox" id="insens"  onclick="caseInsensitive()">
</span>  
  
  <br> &nbsp; &nbsp;
  
  <input 
     type="search" 
     id="myInput" 
     style="font-size:20pt;height:35pt" 
     value=""
  />
  <button 
     id="myBtn" 
     style="font-size:20pt;height:35pt" 
     onclick="search()"
  >
       Search
  </button>

&nbsp; &nbsp; 
<a href="regex_help.html">Regular expressions help</a>

   <br>
 

<p id="output"></p>

<script src="Perfect_MW_ALL.js">
</script>
<script src="myLibraries/unicodeBorders.js">
</script>


<script>
const keyboard = false;
const blue = ["<font color='blue'>","</font>"];
const bluebold = ["<b><font color='blue'>","</font></b>"];
const redbold = ["<b><font color='red'>","</font></b>"];
const numColor = ["<b><font color='#b30000'>","</font></b>"];
const outputMax = 500;

if (!keyboard){
  document.getElementById("keyboard").innerHTML = '';
}

let insens = "";


var input = document.getElementById("myInput");
input.focus();
input.addEventListener("keyup", 
  function(event) {
    event.preventDefault();
    if (event.keyCode === 13) {
        document.getElementById("myBtn").click();
    }
  }
);



function search() {
  let reg = input.value;
  input.focus();
  if (reg.length == 0){
    document.getElementById("output").innerHTML = '';
    return;
  }
  main(reg);
}



function main(reg){
  let perfects = perfectsInit();
  let output = [];
  let outputCounter = 0;

  reg = toUnicode( reg );
  reg = RegExp( reg, 'gu'+insens );

  output.push( perfects[0] + "<br>" );
  for (let i=1; i<perfects.length; i++) {
    let perfectsTest = perfects[i].replace( /<[^>]*>/g, "");
    if (reg.test(perfectsTest)) { 
      outputCounter++;
      if (outputCounter > outputMax) {
        output = [];
        message = "Output too large" + 
          ", please change the search pattern";
        output.push(numColor.join(message));
        outputCounter = 0;
        break;
      }
      output.push( perfects[i]
	   .replace(reg, bluebold.join("$&"))
	);
      output.push("");
    }
  }
  
  
  if (outputCounter > 0) {
    let numMessage = 
       `Number of lines in output: ${outputCounter}`; 
    numMessage = numColor.join(numMessage);
    output.unshift(numMessage + "<br>");
  }


  document.getElementById("output").innerHTML = 
    output.join("<br>");
}

function keyb(a){
  idx = input.selectionStart;
  idy = input.selectionEnd;
  let x = input.value;
  if (a == "⌫"){
    if ((idx > 0) && (idx == idy)) {
      idx--;
    }
    a = "";
  }
  if (a == "del"){
    if ((idx < x.length) && (idx == idy)) {
      idy++;
    }
    a = "";
  }
  if (a == "space"){
    a = " ";
  }
  input.value = 
    x.slice(0, idx) + a + x.slice(idy, x.length); 
  input.focus();
  input.selectionStart = idx + a.length;
  input.selectionEnd = idx + a.length;
}

function caseInsensitive(){
  insens = "";
  let checkBox = document.getElementById("insens");
  if (checkBox.checked){ insens = "i" }
  search();
}


  
</script>
