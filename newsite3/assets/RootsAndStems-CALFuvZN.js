var M=Object.defineProperty;var A=(t,e,r)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var b=(t,e,r)=>A(t,typeof e!="symbol"?e+"":e,r);import{_ as B}from"./InfiniteScroll-z7n4a8H_.js";import{i as T,j as f,o as n,b as i,F as g,q as S,t as h,_ as w,C as d,m as F,s as G,v as N,d as o,c as p,f as D,w as m,V as x,e as K,h as _,x as V,n as R}from"./index-BrQ7iQyq.js";import{s as P}from"./sleep-mAKpSMLY.js";import{V as j}from"./VTextField-fEm9CFHR.js";import{V as L,a as z}from"./VTabs-DGHHN5jB.js";import"./VInput-DxqsqG-9.js";import"./forwardRefs-DWGaNmQL.js";import"./lazy-Bk5Iyf1g.js";import"./VSlideGroup-np5ggxqr.js";const U={class:"grep-multiline"},q=T({__name:"GrepMultiline",props:{multiline:{type:String,default:""},colorSearcherString:{type:String,default:""}},setup(t){const e=f(()=>t.multiline.split(/\n+/)),r=f(()=>new RegExp(`(${t.colorSearcherString})`,"iu")),k=s=>t.colorSearcherString?s.split(r.value):[s],l=f(()=>e.value.map(k));return(s,I)=>(n(),i("div",U,[(n(!0),i(g,null,S(l.value,(y,a)=>(n(),i("div",{key:a,class:"stem"},[(n(!0),i(g,null,S(y,(u,c)=>(n(),i("span",{key:c,class:"part"},h(u),1))),128))]))),128))]))}}),O=w(q,[["__scopeId","data-v-ec7f7d79"]]),H=Object.freeze([{key:"roots",name:"Roots and Stems"},{key:"perfect",name:"Perfects"}]);var E=(t=>(t.any="any",t.yes="yes",t.no="no",t))(E||{});const J=["any","yes","no"],C={any:"",yes:d.green,no:d.tomato},Q=["I","II","III","IV","I(2)","II(2)","III(2)","IV(2)","I(7)","I(8)","I(10)"];class v{constructor(e){b(this,"number");b(this,"state");this.number=e,this.state="any"}static instantiate(e){return new v(e)}get searcherString(){return X(N.escapeRegExp(this.number))}get style(){return{backgroundColor:C[this.state],color:C[this.state]?d.white:""}}buttonColor(e){return this.state===e?C[this.state]:""}clearState(){this.state="any"}setOption(e){if(e===this.state){this.clearState();return}this.state=E[e]}}class W{constructor(e){this.stems=e}get positiveStemSearcherStrings(){return this.stemSearcherStringsByState("yes")}get negativeStemSearcherStrings(){return this.stemSearcherStringsByState("no")}clearAll(){this.stems.forEach(e=>e.clearState())}setOption(e,r){this.stems[e]&&this.stems[e].setOption(r)}stemsByState(e){return this.stems.filter(r=>r.state===e)}stemSearcherStringsByState(e){return this.stemsByState(e).map(r=>r.searcherString)}}function X(t){return`^${t} `}const Y={name:"MaalulaRootsAndStems",components:{GrepMultiline:O,InfiniteScroll:B},data(){return{tab:0,searcherInternal:"",searcher:"",stems:Q.map(v.instantiate),buttonOptions:J,tables:H,Color:d}},computed:{...F(["maalulaVerbalRoots","maalulaPerfects"]),stemCollection(){return new W(this.stems)},tabData(){return[this.maalulaVerbalRoots,this.maalulaPerfects][this.tab]},positiveStemRegexes(){return this.stemCollection.positiveStemSearcherStrings.map(t=>RegExp(t,"iums"))},negativeStemRegexes(){return this.stemCollection.negativeStemSearcherStrings.map(t=>RegExp(t,"iums"))},hasSearch(){return this.stemCollection.positiveStemSearcherStrings.length||this.stemCollection.negativeStemSearcherStrings.length||this.searcher},matchingStrings(){if(!this.hasSearch)return[];const t=this.searcher?[RegExp(this.searcher,"imsu")]:[],e=[...this.positiveStemRegexes,...t],r=this.negativeStemRegexes;return this.tabData.filter(G(e,r))},colorSearcherString(){return[...this.stemCollection.positiveStemSearcherStrings,this.searcher].map(e=>`(?:${e})`).join("|")}},methods:{getButtonStyle(t,e){return{backgroundColor:t.buttonColor(e)||d.lightGrey,color:t.buttonColor(e)?d.white:""}},onOptionClick(t,e){this.stemCollection.setOption(t,e)},searchByString(){this.searcher=this.searcherInternal},async onClickClear(){await P(20),this.searcherInternal="",this.searchByString()},resetAll(){this.searcher=this.searcherInternal="",this.stemCollection.clearAll()},triggerTable(){this.tableTriggerKey++}},created(){this.$store.dispatch("initMaalulaVerbalRoots"),this.$store.dispatch("initMaalulaPerfects")}},Z={class:"external-wrapper"},$={class:"searcher"},ee={class:"searcher__internal"},te={class:"external"},se={class:"table"},re=["onClick"],ae={class:"option-text"},ne={class:"results"},ie={class:"results__internal"},le={key:0,class:"stats"};function oe(t,e,r,k,l,s){const I=O,y=B;return n(),i("div",Z,[o("div",$,[o("div",ee,[p(j,{modelValue:l.searcherInternal,"onUpdate:modelValue":e[0]||(e[0]=a=>l.searcherInternal=a),label:"Search string",dense:"",clearable:"",variant:"outlined",density:"compact",class:"searcher__text-field","onClick:clear":s.onClickClear,onKeyup:D(s.searchByString,["native","enter"])},null,8,["modelValue","onClick:clear","onKeyup"]),p(x,{depressed:"",variant:"outlined",class:"searcher__search-button top-button",onClick:s.searchByString},{default:m(()=>e[2]||(e[2]=[_(" Search ")])),_:1},8,["onClick"]),p(x,{depressed:"",variant:"outlined",class:"top-button",onClick:s.resetAll},{default:m(()=>e[3]||(e[3]=[_(" Clear all ")])),_:1},8,["onClick"])])]),o("div",te,[o("table",se,[(n(!0),i(g,null,S(l.stems,(a,u)=>(n(),i("tr",{key:a.number},[o("td",{class:"stem",style:V([{"font-weight":"bold"},a.style])},h(a.number),5),(n(!0),i(g,null,S(l.buttonOptions,c=>(n(),i("td",{key:c,style:V(s.getButtonStyle(a,c)),class:"option",onClick:ce=>s.onOptionClick(u,c)},[o("div",ae,h(c),1)],12,re))),128))]))),128))])]),p(L,{modelValue:l.tab,"onUpdate:modelValue":e[1]||(e[1]=a=>l.tab=a),"align-tabs":"center",class:"tabs",onChange:s.searchByString},{default:m(()=>[(n(!0),i(g,null,S(l.tables,a=>(n(),R(z,{key:a.key,color:"blue"},{default:m(()=>[_(h(a.name),1)]),_:2},1024))),128))]),_:1},8,["modelValue","onChange"]),o("div",ne,[o("div",ie,[s.hasSearch?(n(),i("div",le,h(s.matchingStrings.length)+" verbal roots of "+h(s.tabData.length)+". ",1)):K("",!0),p(y,{items:s.matchingStrings},{default:m(({items:a})=>[(n(!0),i(g,null,S(a,(u,c)=>(n(),R(I,{key:c,multiline:u,"color-searcher-string":s.colorSearcherString},{default:m(()=>[_(h(u)+" ",1),e[4]||(e[4]=o("hr",null,null,-1))]),_:2},1032,["multiline","color-searcher-string"]))),128))]),_:1},8,["items"])])])])}const fe=w(Y,[["render",oe],["__scopeId","data-v-639c0651"]]);export{fe as default};
