import{_ as de,r as B,aQ as Ee,n as Be,v as w,aR as ht,T as G,o as L,f as q,i as $,F as j,x as Le,s as ce,J as N,l as ne,aS as ee,p as Z,aT as pt,m as ke,ay as yt,L as Qe,M as Ye,aU as Ze,g as ue,N as Je,Q as bt,ab as gt,a9 as ie,u as ve,c as i,ao as he,aV as qe,aW as kt,a6 as Vt,au as xt,$ as St,av as Ct,aX as wt,aY as _t,aq as It,P as et,aZ as Pt,a_ as At,a7 as Tt,aw as Et,ax as Bt,a$ as Lt,Z as ye,a0 as Dt,b0 as Rt,W as Fe,X as Mt,b1 as Nt,b2 as qt,at as le,as as ae,a2 as Ft,b3 as Ie,G as tt,aa as Ot,O as Ut,am as Ht,Y as $t,S as X,U as Kt,b4 as zt,ag as lt,b5 as Gt,a5 as Ve,b6 as Oe,b7 as jt,b8 as Ce,b9 as at,ba as Wt,ae as Ue,bb as nt,ak as we,bc as Xt,aB as Pe,ap as Qt,bd as Yt,ar as Zt,be as Jt,af as De,a4 as fe,bf as el,bg as tl,bh as ll,bi as al,bj as nl,bk as He,bl as sl,k as be,bm as $e,bn as Ke,w as oe,t as ge,aP as st,j as ol,aH as ul,V as ot,A as se,d as rl,bo as il,h as re,al as cl}from"./index-eAgdvAXd.js";import{s as ut}from"./sleep-mAKpSMLY.js";import{_ as dl,V as rt,K as vl,a as ml,b as fl,S as ze}from"./VDialog-Bzj42sgH.js";import{m as hl,V as Ae}from"./VTextField-Ctxt874-.js";import{h as pl}from"./VInput-r8P_vTMa.js";import{f as it}from"./forwardRefs-DWGaNmQL.js";import{m as yl,a as Ge,b as je,g as bl}from"./VTooltip-DiHxM8iB.js";import{V as gl}from"./VCheckboxBtn-CZsEUAFz.js";import{m as kl,V as We}from"./VSlideGroup-CnI8Q-6m.js";import{_ as ct}from"./InfiniteScroll-DpI3EA79.js";import{V as Vl,c as xl}from"./VSnackbar-C7SBR-ad.js";const dt=300;function pe({hash:e,keepLocation:o=!1,className:n="chosen"}){return new Promise(u=>{setTimeout(()=>{o||(location.hash=e,setTimeout(()=>scrollBy(0,-200),0));const s=document.querySelector(e);s&&(s.classList.add(n),setTimeout(u,1))},dt)})}function Sl(e){const o=document.querySelector(e);o&&Te(o)}function Te(e,o="chosen"){e&&setTimeout(()=>{e.classList.remove(o)},dt)}const Cl=["id"],wl={class:"controls-wrapper"},_l={class:"lines"},Il={__name:"LineCard",props:{line:{required:!0},searchers:{default:()=>({})}},setup(e){const o=e,n=B(null),u=Ee(),s=Be(),m=w(()=>ht.map(v=>({lineName:v,str:o.line[v],searcher:o.searchers.data[v]}))),c=w(()=>!o.searchers.areAllEmpty),d=w(()=>u.hash),l=w(()=>"#"+o.line.hash);function r(){Te(n.value,"chosen")}G(d,(v,b)=>{!v&&b&&r()});async function V(){if(!c.value)return;const{volumeName:v,textNumber:b}=o.line;await s.push({query:{mode:ee.browse,volume:v,text:b}}),await pe({hash:l.value})}function P(){if(!u.hash){pe({hash:l.value});return}Sl(u.hash),u.hash===l.value?s.replace({hash:""}):(pe({hash:l.value,keepLocation:!0}),s.replace({hash:l.value}));const v=Array.from(document.querySelectorAll('div.line-card[id^="h"]'));for(const b of v)b.style.background&&b.id!==o.line.hash&&Te(b)}return(v,b)=>e.line?(L(),q("div",{key:0,class:"line-card",id:e.line.hash,ref_key:"lineCardRef",ref:n},[$("div",wl,[c.value?(L(),q("div",{key:1,class:"control-sign",onClick:V},"â–¤")):(L(),q("div",{key:0,class:"control-sign",onClick:P},"#"))]),$("div",_l,[(L(!0),q(j,null,Le(m.value,(I,C)=>(L(),ce(dl,N({ref_for:!0},I,{key:C,class:"mb-1"}),null,16))),128)),b[0]||(b[0]=$("div",null,[$("br")],-1))])],8,Cl)):ne("",!0)}},Re=de(Il,[["__scopeId","data-v-80996821"]]),vt=Symbol.for("vuetify:v-chip-group"),Pl=Z({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:pt},...kl(),...ke(),...yt({selectedClass:"v-chip--selected"}),...Qe(),...Ye(),...Ze({variant:"tonal"})},"VChipGroup");ue()({name:"VChipGroup",props:Pl(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:n}=o;const{themeClasses:u}=Je(e),{isSelected:s,select:m,next:c,prev:d,selected:l}=bt(e,vt);return gt({VChip:{color:ie(e,"color"),disabled:ie(e,"disabled"),filter:ie(e,"filter"),variant:ie(e,"variant")}}),ve(()=>{const r=We.filterProps(e);return i(We,N(r,{class:["v-chip-group",{"v-chip-group--column":e.column},u.value,e.class],style:e.style}),{default:()=>{var V;return[(V=n.default)==null?void 0:V.call(n,{isSelected:s,select:m,next:c,prev:d,selected:l.value})]}})}),{}}});const Al=Z({activeClass:String,appendAvatar:String,appendIcon:he,closable:Boolean,closeIcon:{type:he,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:he,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:qe(),onClickOnce:qe(),...kt(),...ke(),...Vt(),...xt(),...St(),...Ct(),...wt(),..._t(),...Qe({tag:"span"}),...Ye(),...Ze({variant:"tonal"})},"VChip"),Tl=ue()({name:"VChip",directives:{Ripple:It},props:Al(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,o){let{attrs:n,emit:u,slots:s}=o;const{t:m}=et(),{borderClasses:c}=Pt(e),{colorClasses:d,colorStyles:l,variantClasses:r}=At(e),{densityClasses:V}=Tt(e),{elevationClasses:P}=Et(e),{roundedClasses:v}=Bt(e),{sizeClasses:b}=Lt(e),{themeClasses:I}=Je(e),C=ye(e,"modelValue"),t=Dt(e,vt,!1),h=Rt(e,n),y=w(()=>e.link!==!1&&h.isLink.value),p=w(()=>!e.disabled&&e.link!==!1&&(!!t||e.link||h.isClickable.value)),g=w(()=>({"aria-label":m(e.closeLabel),onClick(k){k.preventDefault(),k.stopPropagation(),C.value=!1,u("click:close",k)}}));function A(k){var O;u("click",k),p.value&&((O=h.navigate)==null||O.call(h,k),t==null||t.toggle())}function F(k){(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),A(k))}return()=>{const k=h.isLink.value?"a":e.tag,O=!!(e.appendIcon||e.appendAvatar),x=!!(O||s.append),T=!!(s.close||e.closable),U=!!(s.filter||e.filter)&&t,W=!!(e.prependIcon||e.prependAvatar),Q=!!(W||s.prepend),J=!t||t.isSelected.value;return C.value&&Fe(i(k,N({class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":p.value,"v-chip--filter":U,"v-chip--pill":e.pill},I.value,c.value,J?d.value:void 0,V.value,P.value,v.value,b.value,r.value,t==null?void 0:t.selectedClass.value,e.class],style:[J?l.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,tabindex:p.value?0:void 0,onClick:A,onKeydown:p.value&&!y.value&&F},h.linkProps),{default:()=>{var H;return[Nt(p.value,"v-chip"),U&&i(qt,{key:"filter"},{default:()=>[Fe(i("div",{class:"v-chip__filter"},[s.filter?i(ae,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},s.filter):i(le,{key:"filter-icon",icon:e.filterIcon},null)]),[[Ft,t.isSelected.value]])]}),Q&&i("div",{key:"prepend",class:"v-chip__prepend"},[s.prepend?i(ae,{key:"prepend-defaults",disabled:!W,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},s.prepend):i(j,null,[e.prependIcon&&i(le,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&i(Ie,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),i("div",{class:"v-chip__content","data-no-activator":""},[((H=s.default)==null?void 0:H.call(s,{isSelected:t==null?void 0:t.isSelected.value,selectedClass:t==null?void 0:t.selectedClass.value,select:t==null?void 0:t.select,toggle:t==null?void 0:t.toggle,value:t==null?void 0:t.value.value,disabled:e.disabled}))??e.text]),x&&i("div",{key:"append",class:"v-chip__append"},[s.append?i(ae,{key:"append-defaults",disabled:!O,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},s.append):i(j,null,[e.appendIcon&&i(le,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&i(Ie,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),T&&i("button",N({key:"close",class:"v-chip__close",type:"button"},g.value),[s.close?i(ae,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},s.close):i(le,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[Mt("ripple"),p.value&&e.ripple,null]])}}}),El=Z({id:String,submenu:Boolean,...tt(yl({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:rt}}),["absolute"])},"VMenu"),Bl=ue()({name:"VMenu",props:El(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:n}=o;const u=ye(e,"modelValue"),{scopeId:s}=Ot(),{isRtl:m}=Ut(),c=Ht(),d=w(()=>e.id||`v-menu-${c}`),l=B(),r=$t(Ge,null),V=X(new Set);Kt(Ge,{register(){V.value.add(c)},unregister(){V.value.delete(c)},closeParents(t){setTimeout(()=>{var h;!V.value.size&&!e.persistent&&(t==null||(h=l.value)!=null&&h.contentEl&&!zt(t,l.value.contentEl))&&(u.value=!1,r==null||r.closeParents())},40)}}),lt(()=>r==null?void 0:r.unregister()),Gt(()=>u.value=!1);async function P(t){var p,g,A;const h=t.relatedTarget,y=t.target;await Ve(),u.value&&h!==y&&((p=l.value)!=null&&p.contentEl)&&((g=l.value)!=null&&g.globalTop)&&![document,l.value.contentEl].includes(y)&&!l.value.contentEl.contains(y)&&((A=Oe(l.value.contentEl)[0])==null||A.focus())}G(u,t=>{t?(r==null||r.register(),document.addEventListener("focusin",P,{once:!0})):(r==null||r.unregister(),document.removeEventListener("focusin",P))});function v(t){r==null||r.closeParents(t)}function b(t){var h,y,p,g,A;if(!e.disabled)if(t.key==="Tab"||t.key==="Enter"&&!e.closeOnContentClick){if(t.key==="Enter"&&(t.target instanceof HTMLTextAreaElement||t.target instanceof HTMLInputElement&&t.target.closest("form")))return;t.key==="Enter"&&t.preventDefault(),jt(Oe((h=l.value)==null?void 0:h.contentEl,!1),t.shiftKey?"prev":"next",k=>k.tabIndex>=0)||(u.value=!1,(p=(y=l.value)==null?void 0:y.activatorEl)==null||p.focus())}else e.submenu&&t.key===(m.value?"ArrowRight":"ArrowLeft")&&(u.value=!1,(A=(g=l.value)==null?void 0:g.activatorEl)==null||A.focus())}function I(t){var y;if(e.disabled)return;const h=(y=l.value)==null?void 0:y.contentEl;h&&u.value?t.key==="ArrowDown"?(t.preventDefault(),t.stopImmediatePropagation(),Ce(h,"next")):t.key==="ArrowUp"?(t.preventDefault(),t.stopImmediatePropagation(),Ce(h,"prev")):e.submenu&&(t.key===(m.value?"ArrowRight":"ArrowLeft")?u.value=!1:t.key===(m.value?"ArrowLeft":"ArrowRight")&&(t.preventDefault(),Ce(h,"first"))):(e.submenu?t.key===(m.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(t.key))&&(u.value=!0,t.preventDefault(),setTimeout(()=>setTimeout(()=>I(t))))}const C=w(()=>N({"aria-haspopup":"menu","aria-expanded":String(u.value),"aria-owns":d.value,onKeydown:I},e.activatorProps));return ve(()=>{const t=je.filterProps(e);return i(je,N({ref:l,id:d.value,class:["v-menu",e.class],style:e.style},t,{modelValue:u.value,"onUpdate:modelValue":h=>u.value=h,absolute:!0,activatorProps:C.value,location:e.location??(e.submenu?"end":"bottom"),"onClick:outside":v,onKeydown:b},s),{activator:n.activator,default:function(){for(var h=arguments.length,y=new Array(h),p=0;p<h;p++)y[p]=arguments[p];return i(ae,{root:"VMenu"},{default:()=>{var g;return[(g=n.default)==null?void 0:g.call(n,...y)]}})}})}),it({id:d,Î¨openChildren:V},l)}}),Ll=Z({renderless:Boolean,...ke()},"VVirtualScrollItem"),Dl=ue()({name:"VVirtualScrollItem",inheritAttrs:!1,props:Ll(),emits:{"update:height":e=>!0},setup(e,o){let{attrs:n,emit:u,slots:s}=o;const{resizeRef:m,contentRect:c}=at(void 0,"border");G(()=>{var d;return(d=c.value)==null?void 0:d.height},d=>{d!=null&&u("update:height",d)}),ve(()=>{var d,l;return e.renderless?i(j,null,[(d=s.default)==null?void 0:d.call(s,{itemRef:m})]):i("div",N({ref:m,class:["v-virtual-scroll__item",e.class],style:e.style},n),[(l=s.default)==null?void 0:l.call(s)])})}}),Rl=-1,Ml=1,_e=100,Nl=Z({itemHeight:{type:[Number,String],default:null},height:[Number,String]},"virtual");function ql(e,o){const n=Wt(),u=X(0);Ue(()=>{u.value=parseFloat(e.itemHeight||0)});const s=X(0),m=X(Math.ceil((parseInt(e.height)||n.height.value)/(u.value||16))||1),c=X(0),d=X(0),l=B(),r=B();let V=0;const{resizeRef:P,contentRect:v}=at();Ue(()=>{P.value=l.value});const b=w(()=>{var a;return l.value===document.documentElement?n.height.value:((a=v.value)==null?void 0:a.height)||parseInt(e.height)||0}),I=w(()=>!!(l.value&&r.value&&b.value&&u.value));let C=Array.from({length:o.value.length}),t=Array.from({length:o.value.length});const h=X(0);let y=-1;function p(a){return C[a]||u.value}const g=Xt(()=>{const a=performance.now();t[0]=0;const f=o.value.length;for(let _=1;_<=f-1;_++)t[_]=(t[_-1]||0)+p(_-1);h.value=Math.max(h.value,performance.now()-a)},h),A=G(I,a=>{a&&(A(),V=r.value.offsetTop,g.immediate(),H(),~y&&Ve(()=>{Pe&&window.requestAnimationFrame(()=>{me(y),y=-1})}))});nt(()=>{g.clear()});function F(a,f){const _=C[a],E=u.value;u.value=E?Math.min(u.value,f):f,(_!==f||E!==u.value)&&(C[a]=f,g())}function k(a){return a=we(a,0,o.value.length-1),t[a]||0}function O(a){return Fl(t,a)}let x=0,T=0,U=0;G(b,(a,f)=>{f&&(H(),a<f&&requestAnimationFrame(()=>{T=0,H()}))});function W(){if(!l.value||!r.value)return;const a=l.value.scrollTop,f=performance.now();f-U>500?(T=Math.sign(a-x),V=r.value.offsetTop):T=a-x,x=a,U=f,H()}function Q(){!l.value||!r.value||(T=0,U=0,H())}let J=-1;function H(){cancelAnimationFrame(J),J=requestAnimationFrame(xe)}function xe(){if(!l.value||!b.value)return;const a=x-V,f=Math.sign(T),_=Math.max(0,a-_e),E=we(O(_),0,o.value.length),K=a+b.value+_e,S=we(O(K)+1,E+1,o.value.length);if((f!==Rl||E<s.value)&&(f!==Ml||S>m.value)){const D=k(s.value)-k(E),R=k(S)-k(m.value);Math.max(D,R)>_e?(s.value=E,m.value=S):(E<=0&&(s.value=E),S>=o.value.length&&(m.value=S))}c.value=k(s.value),d.value=k(o.value.length)-k(m.value)}function me(a){const f=k(a);!l.value||a&&!f?y=a:l.value.scrollTop=f}const Se=w(()=>o.value.slice(s.value,m.value).map((a,f)=>({raw:a,index:f+s.value})));return G(o,()=>{C=Array.from({length:o.value.length}),t=Array.from({length:o.value.length}),g.immediate(),H()},{deep:!0}),{calculateVisibleItems:H,containerRef:l,markerRef:r,computedItems:Se,paddingTop:c,paddingBottom:d,scrollToIndex:me,handleScroll:W,handleScrollend:Q,handleItemResize:F}}function Fl(e,o){let n=e.length-1,u=0,s=0,m=null,c=-1;if(e[n]<o)return n;for(;u<=n;)if(s=u+n>>1,m=e[s],m>o)n=s-1;else if(m<o)c=s,u=s+1;else return m===o?s:u;return c}const Ol=Z({items:{type:Array,default:()=>[]},renderless:Boolean,...Nl(),...ke(),...Qt()},"VVirtualScroll"),Ul=ue()({name:"VVirtualScroll",props:Ol(),setup(e,o){let{slots:n}=o;const u=Yt("VVirtualScroll"),{dimensionStyles:s}=Zt(e),{calculateVisibleItems:m,containerRef:c,markerRef:d,handleScroll:l,handleScrollend:r,handleItemResize:V,scrollToIndex:P,paddingTop:v,paddingBottom:b,computedItems:I}=ql(e,ie(e,"items"));return Jt(()=>e.renderless,()=>{function C(){var y,p;const h=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?"addEventListener":"removeEventListener";c.value===document.documentElement?(document[h]("scroll",l,{passive:!0}),document[h]("scrollend",r)):((y=c.value)==null||y[h]("scroll",l,{passive:!0}),(p=c.value)==null||p[h]("scrollend",r))}De(()=>{c.value=bl(u.vnode.el,!0),C(!0)}),nt(C)}),ve(()=>{const C=I.value.map(t=>i(Dl,{key:t.index,renderless:e.renderless,"onUpdate:height":h=>V(t.index,h)},{default:h=>{var y;return(y=n.default)==null?void 0:y.call(n,{item:t.raw,index:t.index,...h})}}));return e.renderless?i(j,null,[i("div",{ref:d,class:"v-virtual-scroll__spacer",style:{paddingTop:fe(v.value)}},null),C,i("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:fe(b.value)}},null)]):i("div",{ref:c,class:["v-virtual-scroll",e.class],onScrollPassive:l,onScrollend:r,style:[s.value,e.style]},[i("div",{ref:d,class:"v-virtual-scroll__container",style:{paddingTop:fe(v.value),paddingBottom:fe(b.value)}},[C])])}),{calculateVisibleItems:m,scrollToIndex:P}}});function Hl(e,o){const n=X(!1);let u;function s(d){cancelAnimationFrame(u),n.value=!0,u=requestAnimationFrame(()=>{u=requestAnimationFrame(()=>{n.value=!1})})}async function m(){await new Promise(d=>requestAnimationFrame(d)),await new Promise(d=>requestAnimationFrame(d)),await new Promise(d=>requestAnimationFrame(d)),await new Promise(d=>{if(n.value){const l=G(n,()=>{l(),d()})}else d()})}async function c(d){var V,P;if(d.key==="Tab"&&((V=o.value)==null||V.focus()),!["PageDown","PageUp","Home","End"].includes(d.key))return;const l=(P=e.value)==null?void 0:P.$el;if(!l)return;(d.key==="Home"||d.key==="End")&&l.scrollTo({top:d.key==="Home"?0:l.scrollHeight,behavior:"smooth"}),await m();const r=l.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(d.key==="PageDown"||d.key==="Home"){const v=l.getBoundingClientRect().top;for(const b of r)if(b.getBoundingClientRect().top>=v){b.focus();break}}else{const v=l.getBoundingClientRect().bottom;for(const b of[...r].reverse())if(b.getBoundingClientRect().bottom<=v){b.focus();break}}}return{onScrollPassive:s,onKeydown:c}}const $l=Z({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:he,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...el({itemChildren:!1})},"Select"),Kl=Z({...$l(),...tt(hl({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...tl({transition:{component:rt}})},"VSelect"),Xe=ue()({name:"VSelect",props:Kl(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,o){let{slots:n}=o;const{t:u}=et(),s=B(),m=B(),c=B(),d=ye(e,"menu"),l=w({get:()=>d.value,set:a=>{var f;d.value&&!a&&((f=m.value)!=null&&f.Î¨openChildren.size)||(d.value=a)}}),{items:r,transformIn:V,transformOut:P}=ll(e),v=ye(e,"modelValue",[],a=>V(a===null?[null]:al(a)),a=>{const f=P(a);return e.multiple?f:f[0]??null}),b=w(()=>typeof e.counterValue=="function"?e.counterValue(v.value):typeof e.counterValue=="number"?e.counterValue:v.value.length),I=pl(),C=w(()=>v.value.map(a=>a.value)),t=X(!1),h=w(()=>l.value?e.closeText:e.openText);let y="",p;const g=w(()=>e.hideSelected?r.value.filter(a=>!v.value.some(f=>e.valueComparator(f,a))):r.value),A=w(()=>e.hideNoData&&!g.value.length||e.readonly||(I==null?void 0:I.isReadonly.value)),F=w(()=>{var a;return{...e.menuProps,activatorProps:{...((a=e.menuProps)==null?void 0:a.activatorProps)||{},"aria-haspopup":"listbox"}}}),k=B(),O=Hl(k,s);function x(a){e.openOnClear&&(l.value=!0)}function T(){A.value||(l.value=!l.value)}function U(a){$e(a)&&W(a)}function W(a){var K,S;if(!a.key||e.readonly||I!=null&&I.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(a.key)&&a.preventDefault(),["Enter","ArrowDown"," "].includes(a.key)&&(l.value=!0),["Escape","Tab"].includes(a.key)&&(l.value=!1),a.key==="Home"?(K=k.value)==null||K.focus("first"):a.key==="End"&&((S=k.value)==null||S.focus("last"));const f=1e3;if(e.multiple||!$e(a))return;const _=performance.now();_-p>f&&(y=""),y+=a.key.toLowerCase(),p=_;const E=r.value.find(D=>D.title.toLowerCase().startsWith(y));if(E!==void 0){v.value=[E];const D=g.value.indexOf(E);Pe&&window.requestAnimationFrame(()=>{var R;D>=0&&((R=c.value)==null||R.scrollToIndex(D))})}}function Q(a){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!a.props.disabled)if(e.multiple){const _=v.value.findIndex(K=>e.valueComparator(K.value,a.value)),E=f??!~_;if(~_){const K=E?[...v.value,a]:[...v.value];K.splice(_,1),v.value=K}else E&&(v.value=[...v.value,a])}else{const _=f!==!1;v.value=_?[a]:[],Ve(()=>{l.value=!1})}}function J(a){var f;(f=k.value)!=null&&f.$el.contains(a.relatedTarget)||(l.value=!1)}function H(){var a;e.eager&&((a=c.value)==null||a.calculateVisibleItems())}function xe(){var a;t.value&&((a=s.value)==null||a.focus())}function me(a){t.value=!0}function Se(a){if(a==null)v.value=[];else if(Ke(s.value,":autofill")||Ke(s.value,":-webkit-autofill")){const f=r.value.find(_=>_.title===a);f&&Q(f)}else s.value&&(s.value.value="")}return G(l,()=>{if(!e.hideSelected&&l.value&&v.value.length){const a=g.value.findIndex(f=>v.value.some(_=>e.valueComparator(_.value,f.value)));Pe&&window.requestAnimationFrame(()=>{var f;a>=0&&((f=c.value)==null||f.scrollToIndex(a))})}}),G(()=>e.items,(a,f)=>{l.value||t.value&&!f.length&&a.length&&(l.value=!0)}),ve(()=>{const a=!!(e.chips||n.chip),f=!!(!e.hideNoData||g.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),_=v.value.length>0,E=Ae.filterProps(e),K=_||!t.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return i(Ae,N({ref:s},E,{modelValue:v.value.map(S=>S.props.value).join(", "),"onUpdate:modelValue":Se,focused:t.value,"onUpdate:focused":S=>t.value=S,validationValue:v.externalValue,counterValue:b.value,dirty:_,class:["v-select",{"v-select--active-menu":l.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":v.value.length,"v-select--selection-slot":!!n.selection},e.class],style:e.style,inputmode:"none",placeholder:K,"onClick:clear":x,"onMousedown:control":T,onBlur:J,onKeydown:W,"aria-label":u(h.value),title:u(h.value)}),{...n,default:()=>i(j,null,[i(Bl,N({ref:m,modelValue:l.value,"onUpdate:modelValue":S=>l.value=S,activator:"parent",contentClass:"v-select__content",disabled:A.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:H,onAfterLeave:xe},F.value),{default:()=>[f&&i(nl,N({ref:k,selected:C.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:S=>S.preventDefault(),onKeydown:U,onFocusin:me,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},O,e.listProps),{default:()=>{var S,D,R;return[(S=n["prepend-item"])==null?void 0:S.call(n),!g.value.length&&!e.hideNoData&&(((D=n["no-data"])==null?void 0:D.call(n))??i(He,{title:u(e.noDataText)},null)),i(Ul,{ref:c,renderless:!0,items:g.value},{default:Y=>{var Ne;let{item:z,index:te,itemRef:M}=Y;const Me=N(z.props,{ref:M,key:te,onClick:()=>Q(z,null)});return((Ne=n.item)==null?void 0:Ne.call(n,{item:z,index:te,props:Me}))??i(He,N(Me,{role:"option"}),{prepend:mt=>{let{isSelected:ft}=mt;return i(j,null,[e.multiple&&!e.hideSelected?i(gl,{key:z.value,modelValue:ft,ripple:!1,tabindex:"-1"},null):void 0,z.props.prependAvatar&&i(Ie,{image:z.props.prependAvatar},null),z.props.prependIcon&&i(le,{icon:z.props.prependIcon},null)])}})}}),(R=n["append-item"])==null?void 0:R.call(n)]}})]}),v.value.map((S,D)=>{function R(M){M.stopPropagation(),M.preventDefault(),Q(S,!1)}const Y={"onClick:close":R,onKeydown(M){M.key!=="Enter"&&M.key!==" "||(M.preventDefault(),M.stopPropagation(),R(M))},onMousedown(M){M.preventDefault(),M.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},z=a?!!n.chip:!!n.selection,te=z?sl(a?n.chip({item:S,index:D,props:Y}):n.selection({item:S,index:D})):void 0;if(!(z&&!te))return i("div",{key:S.value,class:"v-select__selection"},[a?n.chip?i(ae,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:S.title}}},{default:()=>[te]}):i(Tl,N({key:"chip",closable:e.closableChips,size:"small",text:S.title,disabled:S.props.disabled},Y),null):te??i("span",{class:"v-select__selection-text"},[S.title,e.multiple&&D<v.value.length-1&&i("span",{class:"v-select__selection-comma"},[be(",")])])])})]),"append-inner":function(){var Y;for(var S=arguments.length,D=new Array(S),R=0;R<S;R++)D[R]=arguments[R];return i(j,null,[(Y=n["append-inner"])==null?void 0:Y.call(n,...D),e.menuIcon?i(le,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),it({isFocused:t,menu:l,select:Q},s)}}),zl={name:"Browse",props:{corpusArr:{default:()=>[]},volumeLabel:{default:"Volume"},textLabel:{default:"Text"},volumeName:"",textNumber:""},components:{LineCard:Re},data(){return{chosen:{volume:"",text:""}}},created(){const e=this.$route.query;this.chosen.volume=e.volume,e.volume&&this.emitEmpty(),this.chosen.text=e.text,e.text&&this.emitChosen()},mounted(){this.$route.query.volume},computed:{chosenVolume(){if(this.chosen.volume)return this.corpusArr.find(({volumeName:e})=>e===this.chosen.volume)},chosenVolumeTexts(){return this.chosenVolume?this.chosenVolume.texts:[]}},methods:{setQuery(){const e=this.chosen.volume?{volume:this.chosen.volume}:{},o=this.chosen.text?{text:this.chosen.text}:{},n={mode:ee.browse,...e,...o};this.$router.push({query:n})},onChangeChosen(e,o){this.chosen[o]=e,o==="volume"?(this.chosen.text="",this.emitEmpty()):this.emitChosen(),this.setQuery()},emitChosen(){this.$emit("chosen",this.chosen)},emitEmpty(){this.$emit("chosen",{})}}},Gl={class:"browse-selects"},jl={class:"selects mt-5 mb-8"},Wl={class:"no-data-placeholder"};function Xl(e,o,n,u,s,m){return L(),q("div",Gl,[$("div",jl,[i(Xe,{modelValue:s.chosen.volume,"onUpdate:modelValue":[o[0]||(o[0]=c=>s.chosen.volume=c),o[1]||(o[1]=c=>m.onChangeChosen(c,"volume"))],items:n.corpusArr,label:n.volumeLabel,"item-title":"volumeName","item-value":"volumeName",variant:"outlined",density:"compact"},null,8,["modelValue","items","label"]),i(Xe,{modelValue:s.chosen.text,"onUpdate:modelValue":[o[2]||(o[2]=c=>s.chosen.text=c),o[3]||(o[3]=c=>m.onChangeChosen(c,"text"))],items:m.chosenVolumeTexts,label:n.textLabel,"item-title":"textName","item-value":"textNumber",variant:"outlined",density:"compact"},{"no-data":oe(()=>[o[4]||(o[4]=$("span",{class:"no-data-arrow"},"â¬…",-1)),$("span",Wl,ge(`A ${n.volumeLabel} should be chosen`),1)]),_:1},8,["modelValue","items","label"])])])}const Ql=de(zl,[["render",Xl],["__scopeId","data-v-fc3561d1"]]),Yl={class:"d-flex align-center flex-column"},Zl={class:"searchers d-flex mt-5"},Jl={__name:"Search",props:{textusLabel:{default:"Search corpus"},versioLabel:{default:"Search translation"},corpusName:{type:String}},emits:["searchers","copy-to-clipboard"],setup(e,{emit:o}){const n=st(),u=Be(),s=Ee(),m=e,c={get searchers(){return{textus:"",versio:""}}},d=o,l=B(c.searchers),r=B(c.searchers),V=B(!1),P=w(()=>!l.value.textus&&!l.value.versio),v=w(()=>m.corpusName?n.getters.buttonsArrayByName(m.corpusName):[]),b=w(()=>[{name:"textus",value:l.value.textus,label:m.textusLabel},{name:"versio",value:l.value.versio,label:m.versioLabel}]),I=(y,p)=>{l.value[p]=y,y||t()},C=y=>{l.value.textus=y,t()},t=()=>{r.value=se.cloneDeep(l.value),d("searchers",se.cloneDeep(r.value)),h()},h=()=>{const y=r.value.textus?{textus:r.value.textus}:{},p=r.value.versio?{versio:r.value.versio}:{},g={mode:ee.search,...y,...p};se.isEqual(g,s.query)||u.push({query:g,hash:""})};return De(()=>{s.query.textus&&(l.value.textus=s.query.textus),s.query.versio&&(l.value.versio=s.query.versio),(l.value.textus||l.value.versio)&&t()}),(y,p)=>(L(),q("div",Yl,[$("div",Zl,[i(vl,{onClick:p[0]||(p[0]=g=>V.value=!0)}),(L(!0),q(j,null,Le(b.value,({value:g,label:A,name:F})=>(L(),ce(Ae,{key:F,"model-value":g,label:A,variant:"outlined",density:"compact",clearable:"","onUpdate:modelValue":k=>I(k,F),onKeydown:ol(ul(t,["prevent"]),["enter"])},null,8,["model-value","label","onUpdate:modelValue","onKeydown"]))),128)),i(ot,{disabled:P.value,variant:"outlined",onClick:t},{default:oe(()=>p[3]||(p[3]=[be(" Search ")])),_:1},8,["disabled"])]),i(fl,{modelValue:V.value,"onUpdate:modelValue":p[2]||(p[2]=g=>V.value=g),"hide-overlay":"",fullscreen:""},{default:oe(()=>[i(ml,{visible:V.value,buttons:v.value,value:l.value.textus,"input-name":e.textusLabel,"onUpdate:visible":p[1]||(p[1]=g=>V.value=g),onSubmit:C},null,8,["visible","buttons","value","input-name"])]),_:1},8,["modelValue"])]))}},ea=de(Jl,[["__scopeId","data-v-b50f1a69"]]),ta={name:"Results",components:{LineCard:Re,InfiniteScroll:ct},props:["results","searchers","disableInfiniteScroll"],computed:{hasStats(){return!this.searchers.areAllEmpty},isInfiniteScrollDisabled(){return this.disableInfiniteScroll||this.results.length<500}},async mounted(){var o;const e=this.$route.hash;e&&(await ut(1e3),(o=document.querySelector(e))==null||o.scrollIntoView({behavior:"smooth",block:"center"}))}},la={class:"results"},aa={key:0,class:"results-stats"};function na(e,o,n,u,s,m){const c=Re,d=ct;return L(),q("div",la,[m.hasStats?(L(),q("div",aa,[$("div",null,"Found "+ge(n.results.length)+" contexts",1),o[0]||(o[0]=$("div",null,[$("br")],-1))])):ne("",!0),$("div",null,[n.results?(L(),ce(d,{key:0,items:n.results,disable:m.isInfiniteScrollDisabled},{default:oe(({items:l})=>[(L(!0),q(j,null,Le(l,r=>(L(),q(j,null,[r?(L(),ce(c,{line:r,searchers:n.searchers,key:r.hash},null,8,["line","searchers"])):ne("",!0)],64))),256))]),_:1},8,["items","disable"])):ne("",!0)])])}const sa=de(ta,[["render",na],["__scopeId","data-v-09108e21"]]),oa={key:0,class:"searcher-wrapper"},ua=rl({__name:"BrowseAndSearch",props:{corpusName:{required:!0}},setup(e){const o=Ee(),n=Be(),u=e,s={get chosen(){return{volume:null,text:null}},get searchers(){return new ze({textus:"",versio:""})}},m=B({text:"Copy to Clipboard",loading:!1}),c=B({isVisible:!1,text:"",color:"success"}),d=B(!1),l=B(s.searchers),r=B({volume:null,text:null}),V=B(null),P=B(!1),v=st(),b=il(),I=w(()=>v.getters.corpusArrayByName(u.corpusName)),C=w(()=>b.mode),t=w(()=>{if(!r.value.text||!I.value.length)return[];const x=se.find(I.value,{volumeName:r.value.volume});return se.find(x.texts,{textNumber:r.value.text}).contents}),h=w(()=>v.getters.corpusLinesByName(u.corpusName)),y=w(()=>l.value.areAllEmpty?[]:h.value.filter(l.value.test)),p=w(()=>C.value===ee.browse?t.value:y.value),g=async()=>{if(p.value.length>3e3){A("Too many results to copy!","error"),m.value.loading=!1;return}m.value.loading=!0,await ut(100),P.value=!0,await Ve();const T=document.querySelector(".results .results-stats"),U=Array.from(document.querySelectorAll(".results .lines"));try{O([T,...U]),A("Search results successfully copied to clipboard!","success")}catch(W){A(W.message||"Something went wrong â€” nothing copied!","error")}m.value.loading=!1},A=(x,T)=>{c.value.text=x,c.value.color=T,c.value.isVisible=!0,setTimeout(()=>c.value.isVisible=!1,3e3)};G(o,x=>{x.query.mode||n.replace({query:{mode:C.value}}),x.query.mode!==C.value&&b.setMode(x.query.mode)},{deep:!0,immediate:!0}),G(C,x=>{o.query.mode!==x&&(n.replace({query:{mode:x}}),r.value=s.chosen,l.value=s.searchers)}),De(()=>{v.dispatch("initializeCorpus",{corpusName:u.corpusName}),V.value=setInterval(()=>{d.value=!!getSelection().toString()},100);const x=o.hash;x&&pe({hash:x,doAddHash:!0})}),lt(()=>{b.setMode(ee.search),clearInterval(V.value)});const F=x=>{l.value=new ze(x)},k=x=>{r.value.volume=x.volume,r.value.text=x.text},O=x=>{const T=se.map(x,"outerHTML").join("");xl(T)};return(x,T)=>e.corpusName?(L(),q("div",{key:0,class:cl({"no-hashes":d.value})},[C.value===re(ee).search?(L(),q("div",oa,[i(ot,{disabled:!p.value.length,loading:m.value.loading,ref:"search_btn",class:"mr-10 mb-2","min-width":"220px",variant:"outlined",onClick:g},{default:oe(()=>[be(ge(m.value.text),1)]),_:1},8,["disabled","loading"]),i(re(ea),{"corpus-arr-prop":I.value,"corpus-name":e.corpusName,"textus-label":"Aramaic text","versio-label":"Translation text",onSearchers:F},null,8,["corpus-arr-prop","corpus-name"])])):C.value===re(ee).browse?(L(),ce(re(Ql),{key:1,"corpus-arr":I.value,onChosen:k},null,8,["corpus-arr"])):ne("",!0),i(re(sa),{results:p.value,searchers:l.value,"disable-infinite-scroll":P.value},null,8,["results","searchers","disable-infinite-scroll"]),i(Vl,{modelValue:c.value.isVisible,"onUpdate:modelValue":T[0]||(T[0]=U=>c.value.isVisible=U),color:c.value.color,top:"",left:"",outlined:""},{default:oe(()=>[be(ge(c.value.text),1)]),_:1},8,["modelValue","color"])],2)):ne("",!0)}}),ga=de(ua,[["__scopeId","data-v-8a52f698"]]);export{ga as _};
