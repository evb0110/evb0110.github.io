var E=Object.defineProperty;var M=(t,e,a)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var C=(t,e,a)=>M(t,typeof e!="symbol"?e+"":e,a);import{_ as V}from"./InfiniteScroll-BJTUXz-O.js";import{_ as R,o as n,b as i,F as g,n as d,q as b,t as h,C as S,m as A,s as T,v as F,d as l,c as p,f as G,w as m,V as I,e as N,h as y,l as x}from"./index-Fr9ewaVw.js";import{s as D}from"./sleep-mAKpSMLY.js";import{V as K}from"./VTextField-k5OBdz_c.js";import{V as P,a as z}from"./VTabs-r_gfmG0x.js";import"./VInput-DDceB77k.js";import"./forwardRefs-DWGaNmQL.js";import"./lazy-CWukGfJL.js";import"./VSlideGroup-lM5UaRz1.js";const L={name:"GrepMultiline",props:{multiline:{default:()=>[]},colorSearcherString:{default:""}},computed:{lines(){return this.multiline.split(/\n+/).map(t=>this.colorSearcherString?t.split(this.colorRegex):[t])},colorRegex(){return new RegExp(`(${this.colorSearcherString})`,"iu")},style(){return t=>t%2?"color: red; font-weight: bold":""}}},U={class:"grep-multiline"};function j(t,e,a,O,o,s){return n(),i("div",U,[(n(!0),i(g,null,d(s.lines,(f,_)=>(n(),i("div",{key:_,style:b({fontWeight:_?"":"bold"})},[(n(!0),i(g,null,d(f,(r,c)=>(n(),i("span",{key:c,style:b(s.style(c))},h(r),5))),128))],4))),128))])}const B=R(L,[["render",j],["__scopeId","data-v-6c5764fb"]]),q=Object.freeze([{key:"roots",name:"Roots and Stems"},{key:"perfect",name:"Perfects"}]);var w=(t=>(t.any="any",t.yes="yes",t.no="no",t))(w||{});const W=["any","yes","no"],v={any:"",yes:S.green,no:S.tomato},H=["I","II","III","IV","I(2)","II(2)","III(2)","IV(2)","I(7)","I(8)","I(10)"];class k{constructor(e){C(this,"number");C(this,"state");this.number=e,this.state="any"}static instantiate(e){return new k(e)}get searcherString(){return Q(F.escapeRegExp(this.number))}get style(){return{backgroundColor:v[this.state],color:v[this.state]?S.white:""}}buttonColor(e){return this.state===e?v[this.state]:""}clearState(){this.state="any"}setOption(e){if(e===this.state){this.clearState();return}this.state=w[e]}}class J{constructor(e){this.stems=e}get positiveStemSearcherStrings(){return this.stemSearcherStringsByState("yes")}get negativeStemSearcherStrings(){return this.stemSearcherStringsByState("no")}clearAll(){this.stems.forEach(e=>e.clearState())}setOption(e,a){this.stems[e]&&this.stems[e].setOption(a)}stemsByState(e){return this.stems.filter(a=>a.state===e)}stemSearcherStringsByState(e){return this.stemsByState(e).map(a=>a.searcherString)}}function Q(t){return`^${t} `}const X={name:"MaalulaRootsAndStems",components:{GrepMultiline:B,InfiniteScroll:V},data(){return{tab:0,searcherInternal:"",searcher:"",stems:H.map(k.instantiate),buttonOptions:W,tables:q,Color:S}},computed:{...A(["maalulaVerbalRoots","maalulaPerfects"]),stemCollection(){return new J(this.stems)},tabData(){return[this.maalulaVerbalRoots,this.maalulaPerfects][this.tab]},positiveStemRegexes(){return this.stemCollection.positiveStemSearcherStrings.map(t=>RegExp(t,"iums"))},negativeStemRegexes(){return this.stemCollection.negativeStemSearcherStrings.map(t=>RegExp(t,"iums"))},hasSearch(){return this.stemCollection.positiveStemSearcherStrings.length||this.stemCollection.negativeStemSearcherStrings.length||this.searcher},matchingStrings(){if(!this.hasSearch)return[];const t=this.searcher?[RegExp(this.searcher,"imsu")]:[],e=[...this.positiveStemRegexes,...t],a=this.negativeStemRegexes;return this.tabData.filter(T(e,a))},colorSearcherString(){return[...this.stemCollection.positiveStemSearcherStrings,this.searcher].map(e=>`(?:${e})`).join("|")}},methods:{getButtonStyle(t,e){return{backgroundColor:t.buttonColor(e)||S.lightGrey,color:t.buttonColor(e)?S.white:""}},onOptionClick(t,e){this.stemCollection.setOption(t,e)},searchByString(){this.searcher=this.searcherInternal},async onClickClear(){await D(20),this.searcherInternal="",this.searchByString()},resetAll(){this.searcher=this.searcherInternal="",this.stemCollection.clearAll()},triggerTable(){this.tableTriggerKey++}},created(){this.$store.dispatch("initMaalulaVerbalRoots"),this.$store.dispatch("initMaalulaPerfects")}},Y={class:"external-wrapper"},Z={class:"searcher"},$={class:"searcher__internal"},ee={class:"external"},te={class:"table"},se=["onClick"],re={class:"option-text"},ne={class:"results"},ae={class:"results__internal"},ie={key:0,class:"stats"};function le(t,e,a,O,o,s){const f=B,_=V;return n(),i("div",Y,[l("div",Z,[l("div",$,[p(K,{modelValue:o.searcherInternal,"onUpdate:modelValue":e[0]||(e[0]=r=>o.searcherInternal=r),label:"Search string",dense:"",clearable:"",variant:"outlined",density:"compact",class:"searcher__text-field","onClick:clear":s.onClickClear,onKeyup:G(s.searchByString,["native","enter"])},null,8,["modelValue","onClick:clear","onKeyup"]),p(I,{depressed:"",variant:"outlined",class:"searcher__search-button top-button",onClick:s.searchByString},{default:m(()=>e[2]||(e[2]=[y(" Search ")])),_:1},8,["onClick"]),p(I,{depressed:"",variant:"outlined",class:"top-button",onClick:s.resetAll},{default:m(()=>e[3]||(e[3]=[y(" Clear all ")])),_:1},8,["onClick"])])]),l("div",ee,[l("table",te,[(n(!0),i(g,null,d(o.stems,(r,c)=>(n(),i("tr",{key:r.number},[l("td",{class:"stem",style:b([{"font-weight":"bold"},r.style])},h(r.number),5),(n(!0),i(g,null,d(o.buttonOptions,u=>(n(),i("td",{key:u,style:b(s.getButtonStyle(r,u)),class:"option",onClick:oe=>s.onOptionClick(c,u)},[l("div",re,h(u),1)],12,se))),128))]))),128))])]),p(P,{modelValue:o.tab,"onUpdate:modelValue":e[1]||(e[1]=r=>o.tab=r),"align-tabs":"center",class:"tabs",onChange:s.searchByString},{default:m(()=>[(n(!0),i(g,null,d(o.tables,r=>(n(),x(z,{key:r.key,color:"blue"},{default:m(()=>[y(h(r.name),1)]),_:2},1024))),128))]),_:1},8,["modelValue","onChange"]),l("div",ne,[l("div",ae,[s.hasSearch?(n(),i("div",ie,h(s.matchingStrings.length)+" verbal roots of "+h(s.tabData.length)+". ",1)):N("",!0),p(_,{items:s.matchingStrings},{default:m(({items:r})=>[(n(!0),i(g,null,d(r,(c,u)=>(n(),x(f,{key:u,multiline:c,"color-searcher-string":s.colorSearcherString},{default:m(()=>[y(h(c)+" ",1),e[4]||(e[4]=l("hr",null,null,-1))]),_:2},1032,["multiline","color-searcher-string"]))),128))]),_:1},8,["items"])])])])}const be=R(X,[["render",le],["__scopeId","data-v-639c0651"]]);export{be as default};
