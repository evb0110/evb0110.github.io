import{x as y,aG as L,z as m,y as $,b as x,r as V,d as M,W as N,o as u,f as c,h as v,c as p,n as I,w as k,q as F,V as J,F as C,_ as B,i as K,j as S,v as R,A as U}from"./index-CcY6XDHE.js";import{c as j,L as b,u as O,K as T,b as W,a as q,_ as z}from"./GrepLine.vue_vue_type_style_index_0_lang-zfOtP7XE.js";import{a as A}from"./axios-CCb-kr4I.js";import{a as _}from"./assets-DC2lQO5e.js";import{V as E}from"./VTextField-CUqZIeAM.js";import{_ as G}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-DWWjN5dW.js";function P(i){return i.split(`======
`).map(s=>s.split(`
`)).map(s=>({title:y.head(s),lines:y.tail(s)}))}const Q=()=>{const i=L("search",""),t=m(()=>new j(i.value));return{searcherString:i,searcher:t}},H={[b.turoyo]:_.turoyoCorpusJson.link,[b.urmi]:_.urmiCorpusJson.link,[b.maalula]:_.maalulaDictsJson.link},X=$("simpleCorpusStore",()=>{const i=x({}),t=x({}),e=V(),{language:s}=O(),d=m(()=>H[s.value]),{searcherString:r,searcher:l}=Q(),f=m(()=>{const a=[];if(!e.value)return a;for(const h of e.value){const{title:w,lines:g}=h;for(const D of g)a.push({title:w,line:D})}return a}),o=m(()=>r.value?f.value.reduce((a,h)=>{const g=l.value.regex.test(h.line)?[h]:[];return[...a,...g]},[]):[]);async function n(){const a=await A.get(d.value);e.value=P(a.data)}return{corporaObj:i,searcherStringsObj:t,searcher:l,searcherString:r,matchingLines:o,initCorpusData:n}}),Y={class:"searcher align-center flex-column"},Z={class:"searchers d-flex"},ee={class:"input-wrapper"},se=M({__name:"Searcher",setup(i){const t=X(),e=V(""),s=V(!1),d=[o=>!!o||"Search string should not be empty"],r=m({get:()=>e.value,set:o=>{e.value=y.isString(o)?o:"",e.value||l()}}),l=()=>{t.searcherString=r.value},f=o=>{r.value=o,l()};return N(()=>t.searcherString,o=>{e.value=o},{immediate:!0}),(o,n)=>(u(),c(C,null,[v("div",Y,[v("div",Z,[p(T,{onClick:n[0]||(n[0]=a=>s.value=!0)}),v("div",ee,[p(E,{modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=a=>r.value=a),rules:d,autocomplete:"off",label:"Search string",color:"primary",variant:"outlined",density:"compact",clearable:"",onKeyup:I(l,["enter"])},null,8,["modelValue"])]),p(J,{ref:"search_btn",disabled:!r.value,variant:"outlined",onClick:l},{default:k(()=>n[4]||(n[4]=[F(" Search ")])),_:1},8,["disabled"])])]),p(q,{modelValue:s.value,"onUpdate:modelValue":n[3]||(n[3]=a=>s.value=a),"hide-overlay":"",fullscreen:""},{default:k(()=>[p(W,{visible:s.value,value:r.value,"input-name":"Search string",onSubmit:f,"onUpdate:visible":n[2]||(n[2]=a=>s.value=a)},null,8,["visible","value"])]),_:1},8,["modelValue"])],64))}}),pe=B(se,[["__scopeId","data-v-3b109e14"]]),ae={key:0,class:"results-stats"},te={key:0,style:{color:"blueviolet"}},re=M({__name:"SearchResults",props:{linesMatching:{},searcher:{}},setup(i){return(t,e)=>(u(),c(C,null,[t.searcher.value?(u(),c("div",ae," Number of lines in output: "+K(t.linesMatching.length),1)):S("",!0),e[1]||(e[1]=v("br",null,null,-1)),t.linesMatching?(u(),R(G,{key:1,items:t.linesMatching,class:"search-results-box results"},{default:k(({items:s})=>[(u(!0),c(C,null,U(s,({line:d,title:r},l)=>(u(),c("div",{key:l,class:"lines"},[r?(u(),c("div",te,K(r),1)):S("",!0),p(z,{str:d,searcher:t.searcher},null,8,["str","searcher"]),e[0]||(e[0]=v("br",null,null,-1))]))),128))]),_:1},8,["items"])):S("",!0)],64))}}),de=B(re,[["__scopeId","data-v-a23d703e"]]);export{pe as S,de as a,X as b,Q as u};
