import{_ as de,r as T,aI as Ee,aJ as Be,j as w,aK as ht,P as z,o as E,b as F,d as $,F as G,q as Le,n as ce,G as q,e as ne,aL as ee,p as Y,aM as pt,a as ke,ay as yt,I as Qe,J as Ye,aN as Je,g as ue,K as Ze,N as bt,a8 as gt,a6 as ie,u as ve,c as i,ao as he,aO as qe,aP as kt,a3 as Vt,au as xt,X as St,av as wt,aQ as Ct,aR as _t,aq as It,M as et,aS as Pt,aT as At,a4 as Tt,aw as Et,ax as Bt,aU as Lt,W as ye,Y as Dt,aV as Rt,S as Fe,T as Mt,aW as Nt,aX as qt,at as le,as as ae,$ as Ft,aY as Ie,B as tt,a7 as Ot,L as Ut,aj as $t,U as Ht,O as W,Q as Kt,aZ as zt,ad as lt,a_ as Gt,a2 as Ve,a$ as Oe,b0 as jt,b1 as we,b2 as at,b3 as Wt,ab as Ue,b4 as nt,ah as Ce,b5 as Xt,aB as Pe,ap as Qt,b6 as Yt,ar as Jt,b7 as Zt,ac as De,a1 as fe,b8 as el,b9 as tl,ba as ll,bb as al,bc as nl,bd as $e,be as sl,h as be,bf as He,bg as Ke,w as oe,t as ge,k as st,f as ol,aF as ul,V as ot,v as se,i as rl,A as re,ai as il}from"./index-BrQ7iQyq.js";import{s as ut}from"./sleep-mAKpSMLY.js";import{_ as cl,V as rt,K as dl,a as vl,b as ml,S as ze}from"./VDialog-BmYwAD9K.js";import{m as fl,V as Ae}from"./VTextField-fEm9CFHR.js";import{h as hl}from"./VInput-DxqsqG-9.js";import{f as it}from"./forwardRefs-DWGaNmQL.js";import{m as pl,a as Ge,b as je,g as yl}from"./VTooltip-pUmwuyHU.js";import{V as bl}from"./VCheckboxBtn-6m6E4SgA.js";import{m as gl,V as We}from"./VSlideGroup-np5ggxqr.js";import{_ as ct}from"./InfiniteScroll-z7n4a8H_.js";import{V as kl,c as Vl}from"./VSnackbar-FKCgRvDQ.js";const dt=300;function pe({hash:e,keepLocation:o=!1,className:n="chosen"}){return new Promise(u=>{setTimeout(()=>{o||(location.hash=e,setTimeout(()=>scrollBy(0,-200),0));const s=document.querySelector(e);s&&(s.classList.add(n),setTimeout(u,1))},dt)})}function xl(e){const o=document.querySelector(e);o&&Te(o)}function Te(e,o="chosen"){e&&setTimeout(()=>{e.classList.remove(o)},dt)}const Sl=["id"],wl={class:"controls-wrapper"},Cl={class:"lines"},_l={__name:"LineCard",props:{line:{required:!0},searchers:{default:()=>({})}},setup(e){const o=e,n=T(null),u=Ee(),s=Be(),m=w(()=>ht.map(c=>({lineName:c,str:o.line[c],searcher:o.searchers.data[c]}))),d=w(()=>!o.searchers.areAllEmpty),v=w(()=>u.hash),l=w(()=>"#"+o.line.hash);function r(){Te(n.value,"chosen")}z(v,(c,b)=>{!c&&b&&r()});async function x(){if(!d.value)return;const{volumeName:c,textNumber:b}=o.line;await s.push({query:{mode:ee.browse,volume:c,text:b}}),await pe({hash:l.value})}function P(){if(!u.hash){pe({hash:l.value});return}xl(u.hash),u.hash===l.value?s.replace({hash:""}):(pe({hash:l.value,keepLocation:!0}),s.replace({hash:l.value}));const c=Array.from(document.querySelectorAll('div.line-card[id^="h"]'));for(const b of c)b.style.background&&b.id!==o.line.hash&&Te(b)}return(c,b)=>e.line?(E(),F("div",{key:0,class:"line-card",id:e.line.hash,ref_key:"lineCardRef",ref:n},[$("div",wl,[d.value?(E(),F("div",{key:1,class:"control-sign",onClick:x},"▤")):(E(),F("div",{key:0,class:"control-sign",onClick:P},"#"))]),$("div",Cl,[(E(!0),F(G,null,Le(m.value,(C,I)=>(E(),ce(cl,q({ref_for:!0},C,{key:I,class:"mb-1"}),null,16))),128)),b[0]||(b[0]=$("div",null,[$("br")],-1))])],8,Sl)):ne("",!0)}},Re=de(_l,[["__scopeId","data-v-80996821"]]),vt=Symbol.for("vuetify:v-chip-group"),Il=Y({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:pt},...gl(),...ke(),...yt({selectedClass:"v-chip--selected"}),...Qe(),...Ye(),...Je({variant:"tonal"})},"VChipGroup");ue()({name:"VChipGroup",props:Il(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:n}=o;const{themeClasses:u}=Ze(e),{isSelected:s,select:m,next:d,prev:v,selected:l}=bt(e,vt);return gt({VChip:{color:ie(e,"color"),disabled:ie(e,"disabled"),filter:ie(e,"filter"),variant:ie(e,"variant")}}),ve(()=>{const r=We.filterProps(e);return i(We,q(r,{class:["v-chip-group",{"v-chip-group--column":e.column},u.value,e.class],style:e.style}),{default:()=>{var x;return[(x=n.default)==null?void 0:x.call(n,{isSelected:s,select:m,next:d,prev:v,selected:l.value})]}})}),{}}});const Pl=Y({activeClass:String,appendAvatar:String,appendIcon:he,closable:Boolean,closeIcon:{type:he,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:he,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:qe(),onClickOnce:qe(),...kt(),...ke(),...Vt(),...xt(),...St(),...wt(),...Ct(),..._t(),...Qe({tag:"span"}),...Ye(),...Je({variant:"tonal"})},"VChip"),Al=ue()({name:"VChip",directives:{Ripple:It},props:Pl(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,o){let{attrs:n,emit:u,slots:s}=o;const{t:m}=et(),{borderClasses:d}=Pt(e),{colorClasses:v,colorStyles:l,variantClasses:r}=At(e),{densityClasses:x}=Tt(e),{elevationClasses:P}=Et(e),{roundedClasses:c}=Bt(e),{sizeClasses:b}=Lt(e),{themeClasses:C}=Ze(e),I=ye(e,"modelValue"),t=Dt(e,vt,!1),h=Rt(e,n),p=w(()=>e.link!==!1&&h.isLink.value),y=w(()=>!e.disabled&&e.link!==!1&&(!!t||e.link||h.isClickable.value)),g=w(()=>({"aria-label":m(e.closeLabel),onClick(k){k.preventDefault(),k.stopPropagation(),I.value=!1,u("click:close",k)}}));function B(k){var V;u("click",k),y.value&&((V=h.navigate)==null||V.call(h,k),t==null||t.toggle())}function O(k){(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),B(k))}return()=>{const k=h.isLink.value?"a":e.tag,V=!!(e.appendIcon||e.appendAvatar),L=!!(V||s.append),M=!!(s.close||e.closable),j=!!(s.filter||e.filter)&&t,J=!!(e.prependIcon||e.prependAvatar),X=!!(J||s.prepend),Z=!t||t.isSelected.value;return I.value&&Fe(i(k,q({class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":y.value,"v-chip--filter":j,"v-chip--pill":e.pill},C.value,d.value,Z?v.value:void 0,x.value,P.value,c.value,b.value,r.value,t==null?void 0:t.selectedClass.value,e.class],style:[Z?l.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,tabindex:y.value?0:void 0,onClick:B,onKeydown:y.value&&!p.value&&O},h.linkProps),{default:()=>{var U;return[Nt(y.value,"v-chip"),j&&i(qt,{key:"filter"},{default:()=>[Fe(i("div",{class:"v-chip__filter"},[s.filter?i(ae,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},s.filter):i(le,{key:"filter-icon",icon:e.filterIcon},null)]),[[Ft,t.isSelected.value]])]}),X&&i("div",{key:"prepend",class:"v-chip__prepend"},[s.prepend?i(ae,{key:"prepend-defaults",disabled:!J,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},s.prepend):i(G,null,[e.prependIcon&&i(le,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&i(Ie,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),i("div",{class:"v-chip__content","data-no-activator":""},[((U=s.default)==null?void 0:U.call(s,{isSelected:t==null?void 0:t.isSelected.value,selectedClass:t==null?void 0:t.selectedClass.value,select:t==null?void 0:t.select,toggle:t==null?void 0:t.toggle,value:t==null?void 0:t.value.value,disabled:e.disabled}))??e.text]),L&&i("div",{key:"append",class:"v-chip__append"},[s.append?i(ae,{key:"append-defaults",disabled:!V,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},s.append):i(G,null,[e.appendIcon&&i(le,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&i(Ie,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),M&&i("button",q({key:"close",class:"v-chip__close",type:"button"},g.value),[s.close?i(ae,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},s.close):i(le,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[Mt("ripple"),y.value&&e.ripple,null]])}}}),Tl=Y({id:String,submenu:Boolean,...tt(pl({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:rt}}),["absolute"])},"VMenu"),El=ue()({name:"VMenu",props:Tl(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:n}=o;const u=ye(e,"modelValue"),{scopeId:s}=Ot(),{isRtl:m}=Ut(),d=$t(),v=w(()=>e.id||`v-menu-${d}`),l=T(),r=Ht(Ge,null),x=W(new Set);Kt(Ge,{register(){x.value.add(d)},unregister(){x.value.delete(d)},closeParents(t){setTimeout(()=>{var h;!x.value.size&&!e.persistent&&(t==null||(h=l.value)!=null&&h.contentEl&&!zt(t,l.value.contentEl))&&(u.value=!1,r==null||r.closeParents())},40)}}),lt(()=>r==null?void 0:r.unregister()),Gt(()=>u.value=!1);async function P(t){var y,g,B;const h=t.relatedTarget,p=t.target;await Ve(),u.value&&h!==p&&((y=l.value)!=null&&y.contentEl)&&((g=l.value)!=null&&g.globalTop)&&![document,l.value.contentEl].includes(p)&&!l.value.contentEl.contains(p)&&((B=Oe(l.value.contentEl)[0])==null||B.focus())}z(u,t=>{t?(r==null||r.register(),document.addEventListener("focusin",P,{once:!0})):(r==null||r.unregister(),document.removeEventListener("focusin",P))});function c(t){r==null||r.closeParents(t)}function b(t){var h,p,y,g,B;if(!e.disabled)if(t.key==="Tab"||t.key==="Enter"&&!e.closeOnContentClick){if(t.key==="Enter"&&(t.target instanceof HTMLTextAreaElement||t.target instanceof HTMLInputElement&&t.target.closest("form")))return;t.key==="Enter"&&t.preventDefault(),jt(Oe((h=l.value)==null?void 0:h.contentEl,!1),t.shiftKey?"prev":"next",k=>k.tabIndex>=0)||(u.value=!1,(y=(p=l.value)==null?void 0:p.activatorEl)==null||y.focus())}else e.submenu&&t.key===(m.value?"ArrowRight":"ArrowLeft")&&(u.value=!1,(B=(g=l.value)==null?void 0:g.activatorEl)==null||B.focus())}function C(t){var p;if(e.disabled)return;const h=(p=l.value)==null?void 0:p.contentEl;h&&u.value?t.key==="ArrowDown"?(t.preventDefault(),t.stopImmediatePropagation(),we(h,"next")):t.key==="ArrowUp"?(t.preventDefault(),t.stopImmediatePropagation(),we(h,"prev")):e.submenu&&(t.key===(m.value?"ArrowRight":"ArrowLeft")?u.value=!1:t.key===(m.value?"ArrowLeft":"ArrowRight")&&(t.preventDefault(),we(h,"first"))):(e.submenu?t.key===(m.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(t.key))&&(u.value=!0,t.preventDefault(),setTimeout(()=>setTimeout(()=>C(t))))}const I=w(()=>q({"aria-haspopup":"menu","aria-expanded":String(u.value),"aria-owns":v.value,onKeydown:C},e.activatorProps));return ve(()=>{const t=je.filterProps(e);return i(je,q({ref:l,id:v.value,class:["v-menu",e.class],style:e.style},t,{modelValue:u.value,"onUpdate:modelValue":h=>u.value=h,absolute:!0,activatorProps:I.value,location:e.location??(e.submenu?"end":"bottom"),"onClick:outside":c,onKeydown:b},s),{activator:n.activator,default:function(){for(var h=arguments.length,p=new Array(h),y=0;y<h;y++)p[y]=arguments[y];return i(ae,{root:"VMenu"},{default:()=>{var g;return[(g=n.default)==null?void 0:g.call(n,...p)]}})}})}),it({id:v,ΨopenChildren:x},l)}}),Bl=Y({renderless:Boolean,...ke()},"VVirtualScrollItem"),Ll=ue()({name:"VVirtualScrollItem",inheritAttrs:!1,props:Bl(),emits:{"update:height":e=>!0},setup(e,o){let{attrs:n,emit:u,slots:s}=o;const{resizeRef:m,contentRect:d}=at(void 0,"border");z(()=>{var v;return(v=d.value)==null?void 0:v.height},v=>{v!=null&&u("update:height",v)}),ve(()=>{var v,l;return e.renderless?i(G,null,[(v=s.default)==null?void 0:v.call(s,{itemRef:m})]):i("div",q({ref:m,class:["v-virtual-scroll__item",e.class],style:e.style},n),[(l=s.default)==null?void 0:l.call(s)])})}}),Dl=-1,Rl=1,_e=100,Ml=Y({itemHeight:{type:[Number,String],default:null},height:[Number,String]},"virtual");function Nl(e,o){const n=Wt(),u=W(0);Ue(()=>{u.value=parseFloat(e.itemHeight||0)});const s=W(0),m=W(Math.ceil((parseInt(e.height)||n.height.value)/(u.value||16))||1),d=W(0),v=W(0),l=T(),r=T();let x=0;const{resizeRef:P,contentRect:c}=at();Ue(()=>{P.value=l.value});const b=w(()=>{var a;return l.value===document.documentElement?n.height.value:((a=c.value)==null?void 0:a.height)||parseInt(e.height)||0}),C=w(()=>!!(l.value&&r.value&&b.value&&u.value));let I=Array.from({length:o.value.length}),t=Array.from({length:o.value.length});const h=W(0);let p=-1;function y(a){return I[a]||u.value}const g=Xt(()=>{const a=performance.now();t[0]=0;const f=o.value.length;for(let _=1;_<=f-1;_++)t[_]=(t[_-1]||0)+y(_-1);h.value=Math.max(h.value,performance.now()-a)},h),B=z(C,a=>{a&&(B(),x=r.value.offsetTop,g.immediate(),U(),~p&&Ve(()=>{Pe&&window.requestAnimationFrame(()=>{me(p),p=-1})}))});nt(()=>{g.clear()});function O(a,f){const _=I[a],A=u.value;u.value=A?Math.min(u.value,f):f,(_!==f||A!==u.value)&&(I[a]=f,g())}function k(a){return a=Ce(a,0,o.value.length-1),t[a]||0}function V(a){return ql(t,a)}let L=0,M=0,j=0;z(b,(a,f)=>{f&&(U(),a<f&&requestAnimationFrame(()=>{M=0,U()}))});function J(){if(!l.value||!r.value)return;const a=l.value.scrollTop,f=performance.now();f-j>500?(M=Math.sign(a-L),x=r.value.offsetTop):M=a-L,L=a,j=f,U()}function X(){!l.value||!r.value||(M=0,j=0,U())}let Z=-1;function U(){cancelAnimationFrame(Z),Z=requestAnimationFrame(xe)}function xe(){if(!l.value||!b.value)return;const a=L-x,f=Math.sign(M),_=Math.max(0,a-_e),A=Ce(V(_),0,o.value.length),H=a+b.value+_e,S=Ce(V(H)+1,A+1,o.value.length);if((f!==Dl||A<s.value)&&(f!==Rl||S>m.value)){const D=k(s.value)-k(A),R=k(S)-k(m.value);Math.max(D,R)>_e?(s.value=A,m.value=S):(A<=0&&(s.value=A),S>=o.value.length&&(m.value=S))}d.value=k(s.value),v.value=k(o.value.length)-k(m.value)}function me(a){const f=k(a);!l.value||a&&!f?p=a:l.value.scrollTop=f}const Se=w(()=>o.value.slice(s.value,m.value).map((a,f)=>({raw:a,index:f+s.value})));return z(o,()=>{I=Array.from({length:o.value.length}),t=Array.from({length:o.value.length}),g.immediate(),U()},{deep:!0}),{calculateVisibleItems:U,containerRef:l,markerRef:r,computedItems:Se,paddingTop:d,paddingBottom:v,scrollToIndex:me,handleScroll:J,handleScrollend:X,handleItemResize:O}}function ql(e,o){let n=e.length-1,u=0,s=0,m=null,d=-1;if(e[n]<o)return n;for(;u<=n;)if(s=u+n>>1,m=e[s],m>o)n=s-1;else if(m<o)d=s,u=s+1;else return m===o?s:u;return d}const Fl=Y({items:{type:Array,default:()=>[]},renderless:Boolean,...Ml(),...ke(),...Qt()},"VVirtualScroll"),Ol=ue()({name:"VVirtualScroll",props:Fl(),setup(e,o){let{slots:n}=o;const u=Yt("VVirtualScroll"),{dimensionStyles:s}=Jt(e),{calculateVisibleItems:m,containerRef:d,markerRef:v,handleScroll:l,handleScrollend:r,handleItemResize:x,scrollToIndex:P,paddingTop:c,paddingBottom:b,computedItems:C}=Nl(e,ie(e,"items"));return Zt(()=>e.renderless,()=>{function I(){var p,y;const h=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?"addEventListener":"removeEventListener";d.value===document.documentElement?(document[h]("scroll",l,{passive:!0}),document[h]("scrollend",r)):((p=d.value)==null||p[h]("scroll",l,{passive:!0}),(y=d.value)==null||y[h]("scrollend",r))}De(()=>{d.value=yl(u.vnode.el,!0),I(!0)}),nt(I)}),ve(()=>{const I=C.value.map(t=>i(Ll,{key:t.index,renderless:e.renderless,"onUpdate:height":h=>x(t.index,h)},{default:h=>{var p;return(p=n.default)==null?void 0:p.call(n,{item:t.raw,index:t.index,...h})}}));return e.renderless?i(G,null,[i("div",{ref:v,class:"v-virtual-scroll__spacer",style:{paddingTop:fe(c.value)}},null),I,i("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:fe(b.value)}},null)]):i("div",{ref:d,class:["v-virtual-scroll",e.class],onScrollPassive:l,onScrollend:r,style:[s.value,e.style]},[i("div",{ref:v,class:"v-virtual-scroll__container",style:{paddingTop:fe(c.value),paddingBottom:fe(b.value)}},[I])])}),{calculateVisibleItems:m,scrollToIndex:P}}});function Ul(e,o){const n=W(!1);let u;function s(v){cancelAnimationFrame(u),n.value=!0,u=requestAnimationFrame(()=>{u=requestAnimationFrame(()=>{n.value=!1})})}async function m(){await new Promise(v=>requestAnimationFrame(v)),await new Promise(v=>requestAnimationFrame(v)),await new Promise(v=>requestAnimationFrame(v)),await new Promise(v=>{if(n.value){const l=z(n,()=>{l(),v()})}else v()})}async function d(v){var x,P;if(v.key==="Tab"&&((x=o.value)==null||x.focus()),!["PageDown","PageUp","Home","End"].includes(v.key))return;const l=(P=e.value)==null?void 0:P.$el;if(!l)return;(v.key==="Home"||v.key==="End")&&l.scrollTo({top:v.key==="Home"?0:l.scrollHeight,behavior:"smooth"}),await m();const r=l.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(v.key==="PageDown"||v.key==="Home"){const c=l.getBoundingClientRect().top;for(const b of r)if(b.getBoundingClientRect().top>=c){b.focus();break}}else{const c=l.getBoundingClientRect().bottom;for(const b of[...r].reverse())if(b.getBoundingClientRect().bottom<=c){b.focus();break}}}return{onScrollPassive:s,onKeydown:d}}const $l=Y({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:he,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...el({itemChildren:!1})},"Select"),Hl=Y({...$l(),...tt(fl({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...tl({transition:{component:rt}})},"VSelect"),Xe=ue()({name:"VSelect",props:Hl(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,o){let{slots:n}=o;const{t:u}=et(),s=T(),m=T(),d=T(),v=ye(e,"menu"),l=w({get:()=>v.value,set:a=>{var f;v.value&&!a&&((f=m.value)!=null&&f.ΨopenChildren.size)||(v.value=a)}}),{items:r,transformIn:x,transformOut:P}=ll(e),c=ye(e,"modelValue",[],a=>x(a===null?[null]:al(a)),a=>{const f=P(a);return e.multiple?f:f[0]??null}),b=w(()=>typeof e.counterValue=="function"?e.counterValue(c.value):typeof e.counterValue=="number"?e.counterValue:c.value.length),C=hl(),I=w(()=>c.value.map(a=>a.value)),t=W(!1),h=w(()=>l.value?e.closeText:e.openText);let p="",y;const g=w(()=>e.hideSelected?r.value.filter(a=>!c.value.some(f=>e.valueComparator(f,a))):r.value),B=w(()=>e.hideNoData&&!g.value.length||e.readonly||(C==null?void 0:C.isReadonly.value)),O=w(()=>{var a;return{...e.menuProps,activatorProps:{...((a=e.menuProps)==null?void 0:a.activatorProps)||{},"aria-haspopup":"listbox"}}}),k=T(),V=Ul(k,s);function L(a){e.openOnClear&&(l.value=!0)}function M(){B.value||(l.value=!l.value)}function j(a){He(a)&&J(a)}function J(a){var H,S;if(!a.key||e.readonly||C!=null&&C.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(a.key)&&a.preventDefault(),["Enter","ArrowDown"," "].includes(a.key)&&(l.value=!0),["Escape","Tab"].includes(a.key)&&(l.value=!1),a.key==="Home"?(H=k.value)==null||H.focus("first"):a.key==="End"&&((S=k.value)==null||S.focus("last"));const f=1e3;if(e.multiple||!He(a))return;const _=performance.now();_-y>f&&(p=""),p+=a.key.toLowerCase(),y=_;const A=r.value.find(D=>D.title.toLowerCase().startsWith(p));if(A!==void 0){c.value=[A];const D=g.value.indexOf(A);Pe&&window.requestAnimationFrame(()=>{var R;D>=0&&((R=d.value)==null||R.scrollToIndex(D))})}}function X(a){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!a.props.disabled)if(e.multiple){const _=c.value.findIndex(H=>e.valueComparator(H.value,a.value)),A=f??!~_;if(~_){const H=A?[...c.value,a]:[...c.value];H.splice(_,1),c.value=H}else A&&(c.value=[...c.value,a])}else{const _=f!==!1;c.value=_?[a]:[],Ve(()=>{l.value=!1})}}function Z(a){var f;(f=k.value)!=null&&f.$el.contains(a.relatedTarget)||(l.value=!1)}function U(){var a;e.eager&&((a=d.value)==null||a.calculateVisibleItems())}function xe(){var a;t.value&&((a=s.value)==null||a.focus())}function me(a){t.value=!0}function Se(a){if(a==null)c.value=[];else if(Ke(s.value,":autofill")||Ke(s.value,":-webkit-autofill")){const f=r.value.find(_=>_.title===a);f&&X(f)}else s.value&&(s.value.value="")}return z(l,()=>{if(!e.hideSelected&&l.value&&c.value.length){const a=g.value.findIndex(f=>c.value.some(_=>e.valueComparator(_.value,f.value)));Pe&&window.requestAnimationFrame(()=>{var f;a>=0&&((f=d.value)==null||f.scrollToIndex(a))})}}),z(()=>e.items,(a,f)=>{l.value||t.value&&!f.length&&a.length&&(l.value=!0)}),ve(()=>{const a=!!(e.chips||n.chip),f=!!(!e.hideNoData||g.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),_=c.value.length>0,A=Ae.filterProps(e),H=_||!t.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return i(Ae,q({ref:s},A,{modelValue:c.value.map(S=>S.props.value).join(", "),"onUpdate:modelValue":Se,focused:t.value,"onUpdate:focused":S=>t.value=S,validationValue:c.externalValue,counterValue:b.value,dirty:_,class:["v-select",{"v-select--active-menu":l.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":c.value.length,"v-select--selection-slot":!!n.selection},e.class],style:e.style,inputmode:"none",placeholder:H,"onClick:clear":L,"onMousedown:control":M,onBlur:Z,onKeydown:J,"aria-label":u(h.value),title:u(h.value)}),{...n,default:()=>i(G,null,[i(El,q({ref:m,modelValue:l.value,"onUpdate:modelValue":S=>l.value=S,activator:"parent",contentClass:"v-select__content",disabled:B.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:U,onAfterLeave:xe},O.value),{default:()=>[f&&i(nl,q({ref:k,selected:I.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:S=>S.preventDefault(),onKeydown:j,onFocusin:me,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},V,e.listProps),{default:()=>{var S,D,R;return[(S=n["prepend-item"])==null?void 0:S.call(n),!g.value.length&&!e.hideNoData&&(((D=n["no-data"])==null?void 0:D.call(n))??i($e,{title:u(e.noDataText)},null)),i(Ol,{ref:d,renderless:!0,items:g.value},{default:Q=>{var Ne;let{item:K,index:te,itemRef:N}=Q;const Me=q(K.props,{ref:N,key:te,onClick:()=>X(K,null)});return((Ne=n.item)==null?void 0:Ne.call(n,{item:K,index:te,props:Me}))??i($e,q(Me,{role:"option"}),{prepend:mt=>{let{isSelected:ft}=mt;return i(G,null,[e.multiple&&!e.hideSelected?i(bl,{key:K.value,modelValue:ft,ripple:!1,tabindex:"-1"},null):void 0,K.props.prependAvatar&&i(Ie,{image:K.props.prependAvatar},null),K.props.prependIcon&&i(le,{icon:K.props.prependIcon},null)])}})}}),(R=n["append-item"])==null?void 0:R.call(n)]}})]}),c.value.map((S,D)=>{function R(N){N.stopPropagation(),N.preventDefault(),X(S,!1)}const Q={"onClick:close":R,onKeydown(N){N.key!=="Enter"&&N.key!==" "||(N.preventDefault(),N.stopPropagation(),R(N))},onMousedown(N){N.preventDefault(),N.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},K=a?!!n.chip:!!n.selection,te=K?sl(a?n.chip({item:S,index:D,props:Q}):n.selection({item:S,index:D})):void 0;if(!(K&&!te))return i("div",{key:S.value,class:"v-select__selection"},[a?n.chip?i(ae,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:S.title}}},{default:()=>[te]}):i(Al,q({key:"chip",closable:e.closableChips,size:"small",text:S.title,disabled:S.props.disabled},Q),null):te??i("span",{class:"v-select__selection-text"},[S.title,e.multiple&&D<c.value.length-1&&i("span",{class:"v-select__selection-comma"},[be(",")])])])})]),"append-inner":function(){var Q;for(var S=arguments.length,D=new Array(S),R=0;R<S;R++)D[R]=arguments[R];return i(G,null,[(Q=n["append-inner"])==null?void 0:Q.call(n,...D),e.menuIcon?i(le,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),it({isFocused:t,menu:l,select:X},s)}}),Kl={name:"Browse",props:{corpusArr:{default:()=>[]},volumeLabel:{default:"Volume"},textLabel:{default:"Text"},volumeName:"",textNumber:""},components:{LineCard:Re},data(){return{chosen:{volume:"",text:""}}},created(){const e=this.$route.query;this.chosen.volume=e.volume,e.volume&&this.emitEmpty(),this.chosen.text=e.text,e.text&&this.emitChosen()},mounted(){this.$route.query.volume},computed:{chosenVolume(){if(this.chosen.volume)return this.corpusArr.find(({volumeName:e})=>e===this.chosen.volume)},chosenVolumeTexts(){return this.chosenVolume?this.chosenVolume.texts:[]}},methods:{setQuery(){const e=this.chosen.volume?{volume:this.chosen.volume}:{},o=this.chosen.text?{text:this.chosen.text}:{},n={mode:ee.browse,...e,...o};this.$router.push({query:n})},onChangeChosen(e,o){this.chosen[o]=e,o==="volume"?(this.chosen.text="",this.emitEmpty()):this.emitChosen(),this.setQuery()},emitChosen(){this.$emit("chosen",this.chosen)},emitEmpty(){this.$emit("chosen",{})}}},zl={class:"browse-selects"},Gl={class:"selects mt-5 mb-8"},jl={class:"no-data-placeholder"};function Wl(e,o,n,u,s,m){return E(),F("div",zl,[$("div",Gl,[i(Xe,{modelValue:s.chosen.volume,"onUpdate:modelValue":[o[0]||(o[0]=d=>s.chosen.volume=d),o[1]||(o[1]=d=>m.onChangeChosen(d,"volume"))],items:n.corpusArr,label:n.volumeLabel,"item-title":"volumeName","item-value":"volumeName",variant:"outlined",density:"compact"},null,8,["modelValue","items","label"]),i(Xe,{modelValue:s.chosen.text,"onUpdate:modelValue":[o[2]||(o[2]=d=>s.chosen.text=d),o[3]||(o[3]=d=>m.onChangeChosen(d,"text"))],items:m.chosenVolumeTexts,label:n.textLabel,"item-title":"textName","item-value":"textNumber",variant:"outlined",density:"compact"},{"no-data":oe(()=>[o[4]||(o[4]=$("span",{class:"no-data-arrow"},"⬅",-1)),$("span",jl,ge(`A ${n.volumeLabel} should be chosen`),1)]),_:1},8,["modelValue","items","label"])])])}const Xl=de(Kl,[["render",Wl],["__scopeId","data-v-fc3561d1"]]),Ql={class:"d-flex align-center flex-column"},Yl={class:"searchers d-flex mt-5"},Jl={__name:"Search",props:{textusLabel:{default:"Search corpus"},versioLabel:{default:"Search translation"},corpusName:{type:String}},emits:["searchers","copy-to-clipboard"],setup(e,{emit:o}){const n=st(),u=Be(),s=Ee(),m=e,d={get searchers(){return{textus:"",versio:""}}},v=o,l=T(d.searchers),r=T(d.searchers),x=T(!1),P=w(()=>!l.value.textus&&!l.value.versio),c=w(()=>m.corpusName?n.getters.buttonsArrayByName(m.corpusName):[]),b=w(()=>[{name:"textus",value:l.value.textus,label:m.textusLabel},{name:"versio",value:l.value.versio,label:m.versioLabel}]),C=(p,y)=>{l.value[y]=p,p||t()},I=p=>{l.value.textus=p,t()},t=()=>{r.value=se.cloneDeep(l.value),v("searchers",se.cloneDeep(r.value)),h()},h=()=>{const p=r.value.textus?{textus:r.value.textus}:{},y=r.value.versio?{versio:r.value.versio}:{},g={mode:ee.search,...p,...y};se.isEqual(g,s.query)||u.push({query:g,hash:""})};return De(()=>{s.query.textus&&(l.value.textus=s.query.textus),s.query.versio&&(l.value.versio=s.query.versio),(l.value.textus||l.value.versio)&&t()}),(p,y)=>(E(),F("div",Ql,[$("div",Yl,[i(dl,{onClick:y[0]||(y[0]=g=>x.value=!0)}),(E(!0),F(G,null,Le(b.value,({value:g,label:B,name:O})=>(E(),ce(Ae,{key:O,"model-value":g,label:B,variant:"outlined",density:"compact",clearable:"","onUpdate:modelValue":k=>C(k,O),onKeydown:ol(ul(t,["prevent"]),["enter"])},null,8,["model-value","label","onUpdate:modelValue","onKeydown"]))),128)),i(ot,{disabled:P.value,variant:"outlined",onClick:t},{default:oe(()=>y[3]||(y[3]=[be(" Search ")])),_:1},8,["disabled"])]),i(ml,{modelValue:x.value,"onUpdate:modelValue":y[2]||(y[2]=g=>x.value=g),"hide-overlay":"",fullscreen:""},{default:oe(()=>[i(vl,{visible:x.value,buttons:c.value,value:l.value.textus,"input-name":e.textusLabel,"onUpdate:visible":y[1]||(y[1]=g=>x.value=g),onSubmit:I},null,8,["visible","buttons","value","input-name"])]),_:1},8,["modelValue"])]))}},Zl=de(Jl,[["__scopeId","data-v-b50f1a69"]]),ea={name:"Results",components:{LineCard:Re,InfiniteScroll:ct},props:["results","searchers","disableInfiniteScroll"],computed:{hasStats(){return!this.searchers.areAllEmpty},isInfiniteScrollDisabled(){return this.disableInfiniteScroll||this.results.length<500}},async mounted(){var o;const e=this.$route.hash;e&&(await ut(1e3),(o=document.querySelector(e))==null||o.scrollIntoView({behavior:"smooth",block:"center"}))}},ta={class:"results"},la={key:0,class:"results-stats"};function aa(e,o,n,u,s,m){const d=Re,v=ct;return E(),F("div",ta,[m.hasStats?(E(),F("div",la,[$("div",null,"Found "+ge(n.results.length)+" contexts",1),o[0]||(o[0]=$("div",null,[$("br")],-1))])):ne("",!0),$("div",null,[n.results?(E(),ce(v,{key:0,items:n.results,disable:m.isInfiniteScrollDisabled},{default:oe(({items:l})=>[(E(!0),F(G,null,Le(l,r=>(E(),F(G,null,[r?(E(),ce(d,{line:r,searchers:n.searchers,key:r.hash},null,8,["line","searchers"])):ne("",!0)],64))),256))]),_:1},8,["items","disable"])):ne("",!0)])])}const na=de(ea,[["render",aa],["__scopeId","data-v-09108e21"]]),sa={key:0,class:"searcher-wrapper"},oa=rl({__name:"BrowseAndSearch",props:{corpusName:{required:!0}},setup(e){const o=Ee(),n=Be(),u=e,s={get chosen(){return{volume:null,text:null}},get searchers(){return new ze({textus:"",versio:""})}},m=T({text:"Copy to Clipboard",loading:!1}),d=T({isVisible:!1,text:"",color:"success"}),v=T(!1),l=T(s.searchers),r=T({volume:null,text:null}),x=T(null),P=T(!1),c=st(),b=w(()=>c.getters.corpusArrayByName(u.corpusName)),C=w(()=>c.getters.mode),I=w(()=>{if(!r.value.text||!b.value.length)return[];const V=se.find(b.value,{volumeName:r.value.volume});return se.find(V.texts,{textNumber:r.value.text}).contents}),t=w(()=>c.getters.corpusLinesByName(u.corpusName)),h=w(()=>l.value.areAllEmpty?[]:t.value.filter(l.value.test)),p=w(()=>C.value===ee.browse?I.value:h.value),y=async()=>{if(p.value.length>3e3){g("Too many results to copy!","error"),m.value.loading=!1;return}m.value.loading=!0,await ut(100),P.value=!0,await Ve();const L=document.querySelector(".results .results-stats"),M=Array.from(document.querySelectorAll(".results .lines"));try{k([L,...M]),g("Search results successfully copied to clipboard!","success")}catch(j){g(j.message||"Something went wrong — nothing copied!","error")}m.value.loading=!1},g=(V,L)=>{d.value.text=V,d.value.color=L,d.value.isVisible=!0,setTimeout(()=>d.value.isVisible=!1,3e3)};z(o,V=>{V.query.mode||n.replace({query:{mode:C.value}}),V.query.mode!==C.value&&c.commit("setMode",V.query.mode)},{deep:!0,immediate:!0}),z(C,V=>{o.query.mode!==V&&(n.replace({query:{mode:V}}),r.value=s.chosen,l.value=s.searchers)}),De(()=>{c.dispatch("initializeCorpus",{corpusName:u.corpusName}),x.value=setInterval(()=>{v.value=!!getSelection().toString()},100);const V=o.hash;V&&pe({hash:V,doAddHash:!0})}),lt(()=>{c.commit("setMode",ee.search),clearInterval(x.value)});const B=V=>{l.value=new ze(V)},O=V=>{r.value.volume=V.volume,r.value.text=V.text},k=V=>{const L=se.map(V,"outerHTML").join("");Vl(L)};return(V,L)=>e.corpusName?(E(),F("div",{key:0,class:il({"no-hashes":v.value})},[C.value===re(ee).search?(E(),F("div",sa,[i(ot,{disabled:!p.value.length,loading:m.value.loading,ref:"search_btn",class:"mr-10 mb-2","min-width":"220px",variant:"outlined",onClick:y},{default:oe(()=>[be(ge(m.value.text),1)]),_:1},8,["disabled","loading"]),i(re(Zl),{"corpus-arr-prop":b.value,"corpus-name":e.corpusName,"textus-label":"Aramaic text","versio-label":"Translation text",onSearchers:B},null,8,["corpus-arr-prop","corpus-name"])])):C.value===re(ee).browse?(E(),ce(re(Xl),{key:1,"corpus-arr":b.value,onChosen:O},null,8,["corpus-arr"])):ne("",!0),i(re(na),{results:p.value,searchers:l.value,"disable-infinite-scroll":P.value},null,8,["results","searchers","disable-infinite-scroll"]),i(kl,{modelValue:d.value.isVisible,"onUpdate:modelValue":L[0]||(L[0]=M=>d.value.isVisible=M),color:d.value.color,top:"",left:"",outlined:""},{default:oe(()=>[be(ge(d.value.text),1)]),_:1},8,["modelValue","color"])],2)):ne("",!0)}}),ba=de(oa,[["__scopeId","data-v-e430bf96"]]);export{ba as _};
