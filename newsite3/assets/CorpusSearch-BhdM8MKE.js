import{_ as h,a as m}from"./Searcher-BKwMTrEv.js";import{s as i}from"./sleep-mAKpSMLY.js";import{v as y,_ as d,o as S,b as C,c as o,w as c,V as k,h as l,t as p,bk as u,n as x,l as V}from"./index-BrQ7iQyq.js";import{c as N,V as T}from"./VSnackbar-FKCgRvDQ.js";import{c as B}from"./VDialog-BmYwAD9K.js";import"./InfiniteScroll-z7n4a8H_.js";import"./VTextField-fEm9CFHR.js";import"./VInput-DxqsqG-9.js";import"./forwardRefs-DWGaNmQL.js";import"./VTooltip-pUmwuyHU.js";import"./lazy-Bk5Iyf1g.js";const v={methods:{copyToClipboardMany(e){const t=y.map(e,"outerHTML").join("");N(t)}}},w={name:"CorpusSearch",props:["corpusName"],mixins:[v],components:{Searcher:h,SearchResults:m},data(){return{searcherString:"",disableInfiniteScroll:!1,copyToClipboardBtn:{text:"Copy to Clipboard",loading:!1},snackbar:{isVisible:!1,text:"",color:"success"}}},computed:{matchingLines(){return this.$store.getters.matchingLinesByCorpus(this.corpusName)},searcherStringWrapper(){return new B(this.searcherString)}},created(){this.$store.dispatch("initializeCorpusData",{corpusName:this.corpusName}),this.$store.commit("setSearcherString",{corpusName:this.corpusName,searcherString:this.searcherStringWrapper})},mounted(){this.$route.query.search&&this.onSearcherString(this.$route.query.search)},methods:{onSearcherString(e){this.searcherString=e,this.setQuery(),this.$store.commit("setSearcherString",{corpusName:this.corpusName,searcherString:this.searcherStringWrapper})},setQuery(){const e=this.searcherStringWrapper.value?{search:this.searcherStringWrapper.value}:{};_.isEqual(e,this.$route.query)||this.$router.push({query:e})},async copyToClipboardProxy(){try{this.copyToClipboardBtn.loading=!0,await i(100),this.disableInfiniteScroll=!0,await i(200);const t=document.querySelector(".search-results");getSelection().removeAllRanges();const a=getSelection();a.selectAllChildren(t),document.execCommand("copy"),this.copyToClipboardBtn.loading=!1,a.removeAllRanges(),this.disableInfiniteScroll=!1,this.snackbar.text="Search results successfully copied to clipboard!",this.snackbar.color="success"}catch{this.snackbar.text="Something went wrong â€” nothing copied!",this.snackbar.color="error"}this.snackbar.isVisible=!0}}};function W(e,t,a,g,r,s){const n=h,b=m;return S(),C("div",null,[o(u,{class:"searcher-wrapper"},{default:c(()=>[o(k,{ref:"search_btn",class:"mr-10 d-none d-md-block",disabled:!s.matchingLines.length,loading:r.copyToClipboardBtn.loading,depressed:"",outlined:"",onClick:s.copyToClipboardProxy},{default:c(()=>[l(p(r.copyToClipboardBtn.text),1)]),_:1},8,["disabled","loading","onClick"]),o(n,{"searcher-string":s.searcherStringWrapper.value,"corpus-name":a.corpusName,onSearcherString:s.onSearcherString},null,8,["searcher-string","corpus-name","onSearcherString"])]),_:1}),o(u,null,{default:c(()=>[o(b,{"lines-matching":s.matchingLines,"searcher-string":s.searcherStringWrapper,"disable-infinite-scroll":r.disableInfiniteScroll,ref:"search_results"},null,8,["lines-matching","searcher-string","disable-infinite-scroll"])]),_:1}),o(T,{modelValue:r.snackbar.isVisible,"onUpdate:modelValue":t[0]||(t[0]=f=>r.snackbar.isVisible=f),color:r.snackbar.color,top:"",left:"",outlined:""},{default:c(()=>[l(p(r.snackbar.text),1)]),_:1},8,["modelValue","color"])])}const q=d(w,[["render",W],["__scopeId","data-v-81d363a5"]]),I={name:"UrmiCorpusSearch",components:{CorpusSearch:q},computed:{corpusName(){return"urmi"}}};function L(e,t,a,g,r,s){const n=V("CorpusSearch",!0);return S(),x(n,{"corpus-name":s.corpusName},null,8,["corpus-name"])}const H=d(I,[["render",L]]);export{H as default};
