import{aT as kt,d as Vt,r as E,c as w,q as J,aU as xt,s as Ve,au as wt,Q as at,S as lt,aV as nt,v as oe,T as st,X as St,ae as Tt,t as ae,x as de,g as d,O as q,ak as he,aW as $e,aX as Ct,aa as _t,aq as At,a3 as It,ar as Pt,aY as Et,aZ as Lt,am as Bt,W as ot,a_ as Dt,a$ as Rt,ab as Nt,as as qt,at as Mt,b0 as Ot,a2 as ye,a4 as $t,b1 as Ft,$ as Fe,a0 as Ht,b2 as Ut,b3 as Kt,ap as le,ao as ne,a6 as zt,F as H,b4 as _e,L as ut,ad as Gt,U as Wt,ah as jt,a1 as Xt,Y as G,Z as Qt,b5 as Yt,aP as rt,b6 as Jt,e as W,a9 as Ee,b7 as He,b8 as Zt,b9 as Se,ba as it,bb as ea,w as Ue,bc as ct,aS as Te,bd as ta,ax as Ae,al as aa,be as la,an as na,bf as sa,a8 as fe,aO as se,bg as oa,bh as ua,bi as ra,bj as ia,bk as Ke,bl as ca,p as dt,bm as da,bn as ze,bo as Ge,b as ve,aB as ge,bp as vt,o as A,f as R,k as D,i as K,j as We,h as be,l as mt,_ as ue,E as ke,V as va,n as Le,D as ce,ag as Be,B as ma,aD as fa,bq as De,A as ha,m as ie,br as pa,bs as re,G as ya,bt as ga}from"./index-xK2BiaTU.js";import{L as je,u as ba,V as ft,K as Xe,a as ka,_ as Va,S as Qe}from"./GrepLine.vue_vue_type_style_index_0_lang-B3d5iCrj.js";import{a as xa}from"./axios-CCb-kr4I.js";import{a as Ye}from"./assets-r5ZlRJsM.js";import{m as wa,V as Ie}from"./VTextField-Bgif8Cct.js";import{h as Sa}from"./VInput-DbyAgfg2.js";import{f as ht}from"./forwardRefs-DWGaNmQL.js";import{m as Ta,V as Je,a as Ze,g as Ca}from"./VOverlay-BHooUI16.js";import{V as _a}from"./VCheckboxBtn-DfxlKX3V.js";import{m as Aa,V as et}from"./VSlideGroup-BG0WIfsU.js";import{s as Ia}from"./sleep-mAKpSMLY.js";import{_ as Pa}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-Cd_xxj8K.js";import{_ as Ea}from"./CopyResults.vue_vue_type_script_setup_true_lang-BGGIFv0Y.js";const pt=300;function pe({hash:e="",keepLocation:o=!1,className:n="chosen"}){return new Promise(u=>{setTimeout(()=>{o||(location.hash=e,setTimeout(()=>scrollBy(0,-200),0));const l=document.querySelector(e);l&&(l.classList.add(n),setTimeout(u,1))},pt)})}function La(e){const o=document.querySelector(e);o&&Pe(o)}function Pe(e,o="chosen"){e&&setTimeout(()=>{e.classList.remove(o)},pt)}class Re{constructor({volume:o,texts:n}){this.texts=n.map(u=>({volumeName:o,...u})).map(Ne.instantiate),this.volumeName=o}static instantiate(o){return new Re(o)}}class Ne{constructor({volumeName:o,textNumber:n,textName:u,contents:l}){this.volumeName=o,this.textNumber=n,this._textName=u,this.rawContents=l}get contents(){return this.rawContents.map(o=>({volumeName:this.volumeName,textNumber:this.textNumber,textName:this.textName,...o})).map(qe.instantiate)}get textName(){return this._textName.replace(/\.txt/,"")}set textName(o){this._textName=o}static instantiate(o){return new Ne(o)}}class qe{constructor({volumeName:o,textNumber:n,textName:u,lineNumber:l,textus:r,versio:v}){this.volumeName=o,this.textNumber=n,this.textName=u,this.lineNumber=l,this.textus=r,this.versio=v}get title(){return this.volumeName+": "+this.textName}get hash(){return"h"+kt(this)}static instantiate(o){return new qe(o)}}const Ba={[je.maalula]:{link:Ye.maalulaCorpusJson.link},[je.turoyo]:{link:Ye.turoyoNewCorpusJson.link}},Da=Vt("corpusWithTranslationStore",()=>{const e=E([]),{language:o}=ba(),n=w(()=>e.value.flatMap(l=>l.texts).flatMap(l=>l.contents));async function u(){const l=(await xa.get(Ba[o.value].link)).data;e.value=l.map(Re.instantiate)}return{corpusArray:e,corpusLines:n,initCorpus:u}}),yt=Symbol.for("vuetify:v-chip-group"),Ra=J({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:xt},...Aa(),...Ve(),...wt({selectedClass:"v-chip--selected"}),...at(),...lt(),...nt({variant:"tonal"})},"VChipGroup");oe()({name:"VChipGroup",props:Ra(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:n}=o;const{themeClasses:u}=st(e),{isSelected:l,select:r,next:v,prev:c,selected:s}=St(e,yt);return Tt({VChip:{color:ae(e,"color"),disabled:ae(e,"disabled"),filter:ae(e,"filter"),variant:ae(e,"variant")}}),de(()=>{const m=et.filterProps(e);return d(et,q(m,{class:["v-chip-group",{"v-chip-group--column":e.column},u.value,e.class],style:e.style}),{default:()=>{var b;return[(b=n.default)==null?void 0:b.call(n,{isSelected:l,select:r,next:v,prev:c,selected:s.value})]}})}),{}}});const Na=J({activeClass:String,appendAvatar:String,appendIcon:he,closable:Boolean,closeIcon:{type:he,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:he,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:$e(),onClickOnce:$e(),...Ct(),...Ve(),..._t(),...At(),...It(),...Pt(),...Et(),...Lt(),...at({tag:"span"}),...lt(),...nt({variant:"tonal"})},"VChip"),qa=oe()({name:"VChip",directives:{Ripple:Bt},props:Na(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,o){let{attrs:n,emit:u,slots:l}=o;const{t:r}=ot(),{borderClasses:v}=Dt(e),{colorClasses:c,colorStyles:s,variantClasses:m}=Rt(e),{densityClasses:b}=Nt(e),{elevationClasses:S}=qt(e),{roundedClasses:i}=Mt(e),{sizeClasses:p}=Ot(e),{themeClasses:_}=st(e),g=ye(e,"modelValue"),t=$t(e,yt,!1),h=Ft(e,n),y=w(()=>e.link!==!1&&h.isLink.value),T=w(()=>!e.disabled&&e.link!==!1&&(!!t||e.link||h.isClickable.value)),x=w(()=>({"aria-label":r(e.closeLabel),onClick(k){k.preventDefault(),k.stopPropagation(),g.value=!1,u("click:close",k)}}));function L(k){var U;u("click",k),T.value&&((U=h.navigate)==null||U.call(h,k),t==null||t.toggle())}function O(k){(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),L(k))}return()=>{const k=h.isLink.value?"a":e.tag,U=!!(e.appendIcon||e.appendAvatar),j=!!(U||l.append),z=!!(l.close||e.closable),X=!!(l.filter||e.filter)&&t,Z=!!(e.prependIcon||e.prependAvatar),Q=!!(Z||l.prepend),ee=!t||t.isSelected.value;return g.value&&Fe(d(k,q({class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":T.value,"v-chip--filter":X,"v-chip--pill":e.pill},_.value,v.value,ee?c.value:void 0,b.value,S.value,i.value,p.value,m.value,t==null?void 0:t.selectedClass.value,e.class],style:[ee?s.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,tabindex:T.value?0:void 0,onClick:L,onKeydown:T.value&&!y.value&&O},h.linkProps),{default:()=>{var M;return[Ut(T.value,"v-chip"),X&&d(Kt,{key:"filter"},{default:()=>[Fe(d("div",{class:"v-chip__filter"},[l.filter?d(ne,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},l.filter):d(le,{key:"filter-icon",icon:e.filterIcon},null)]),[[zt,t.isSelected.value]])]}),Q&&d("div",{key:"prepend",class:"v-chip__prepend"},[l.prepend?d(ne,{key:"prepend-defaults",disabled:!Z,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},l.prepend):d(H,null,[e.prependIcon&&d(le,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&d(_e,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),d("div",{class:"v-chip__content","data-no-activator":""},[((M=l.default)==null?void 0:M.call(l,{isSelected:t==null?void 0:t.isSelected.value,selectedClass:t==null?void 0:t.selectedClass.value,select:t==null?void 0:t.select,toggle:t==null?void 0:t.toggle,value:t==null?void 0:t.value.value,disabled:e.disabled}))??e.text]),j&&d("div",{key:"append",class:"v-chip__append"},[l.append?d(ne,{key:"append-defaults",disabled:!U,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},l.append):d(H,null,[e.appendIcon&&d(le,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&d(_e,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),z&&d("button",q({key:"close",class:"v-chip__close",type:"button","data-testid":"close-chip"},x.value),[l.close?d(ne,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},l.close):d(le,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[Ht("ripple"),T.value&&e.ripple,null]])}}}),Ma=J({id:String,submenu:Boolean,...ut(Ta({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:ft}}),["absolute"])},"VMenu"),Oa=oe()({name:"VMenu",props:Ma(),emits:{"update:modelValue":e=>!0},setup(e,o){let{slots:n}=o;const u=ye(e,"modelValue"),{scopeId:l}=Gt(),{isRtl:r}=Wt(),v=jt(),c=w(()=>e.id||`v-menu-${v}`),s=E(),m=Xt(Je,null),b=G(new Set);Qt(Je,{register(){b.value.add(v)},unregister(){b.value.delete(v)},closeParents(t){setTimeout(()=>{var h;!b.value.size&&!e.persistent&&(t==null||(h=s.value)!=null&&h.contentEl&&!Yt(t,s.value.contentEl))&&(u.value=!1,m==null||m.closeParents())},40)}}),rt(()=>m==null?void 0:m.unregister()),Jt(()=>u.value=!1);async function S(t){var T,x,L;const h=t.relatedTarget,y=t.target;await Ee(),u.value&&h!==y&&((T=s.value)!=null&&T.contentEl)&&((x=s.value)!=null&&x.globalTop)&&![document,s.value.contentEl].includes(y)&&!s.value.contentEl.contains(y)&&((L=He(s.value.contentEl)[0])==null||L.focus())}W(u,t=>{t?(m==null||m.register(),document.addEventListener("focusin",S,{once:!0})):(m==null||m.unregister(),document.removeEventListener("focusin",S))});function i(t){m==null||m.closeParents(t)}function p(t){var h,y,T,x,L;if(!e.disabled)if(t.key==="Tab"||t.key==="Enter"&&!e.closeOnContentClick){if(t.key==="Enter"&&(t.target instanceof HTMLTextAreaElement||t.target instanceof HTMLInputElement&&t.target.closest("form")))return;t.key==="Enter"&&t.preventDefault(),Zt(He((h=s.value)==null?void 0:h.contentEl,!1),t.shiftKey?"prev":"next",k=>k.tabIndex>=0)||(u.value=!1,(T=(y=s.value)==null?void 0:y.activatorEl)==null||T.focus())}else e.submenu&&t.key===(r.value?"ArrowRight":"ArrowLeft")&&(u.value=!1,(L=(x=s.value)==null?void 0:x.activatorEl)==null||L.focus())}function _(t){var y;if(e.disabled)return;const h=(y=s.value)==null?void 0:y.contentEl;h&&u.value?t.key==="ArrowDown"?(t.preventDefault(),t.stopImmediatePropagation(),Se(h,"next")):t.key==="ArrowUp"?(t.preventDefault(),t.stopImmediatePropagation(),Se(h,"prev")):e.submenu&&(t.key===(r.value?"ArrowRight":"ArrowLeft")?u.value=!1:t.key===(r.value?"ArrowLeft":"ArrowRight")&&(t.preventDefault(),Se(h,"first"))):(e.submenu?t.key===(r.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(t.key))&&(u.value=!0,t.preventDefault(),setTimeout(()=>setTimeout(()=>_(t))))}const g=w(()=>q({"aria-haspopup":"menu","aria-expanded":String(u.value),"aria-owns":c.value,onKeydown:_},e.activatorProps));return de(()=>{const t=Ze.filterProps(e);return d(Ze,q({ref:s,id:c.value,class:["v-menu",e.class],style:e.style},t,{modelValue:u.value,"onUpdate:modelValue":h=>u.value=h,absolute:!0,activatorProps:g.value,location:e.location??(e.submenu?"end":"bottom"),"onClick:outside":i,onKeydown:p},l),{activator:n.activator,default:function(){for(var h=arguments.length,y=new Array(h),T=0;T<h;T++)y[T]=arguments[T];return d(ne,{root:"VMenu"},{default:()=>{var x;return[(x=n.default)==null?void 0:x.call(n,...y)]}})}})}),ht({id:c,ΨopenChildren:b},s)}}),$a=J({renderless:Boolean,...Ve()},"VVirtualScrollItem"),Fa=oe()({name:"VVirtualScrollItem",inheritAttrs:!1,props:$a(),emits:{"update:height":e=>!0},setup(e,o){let{attrs:n,emit:u,slots:l}=o;const{resizeRef:r,contentRect:v}=it(void 0,"border");W(()=>{var c;return(c=v.value)==null?void 0:c.height},c=>{c!=null&&u("update:height",c)}),de(()=>{var c,s;return e.renderless?d(H,null,[(c=l.default)==null?void 0:c.call(l,{itemRef:r})]):d("div",q({ref:r,class:["v-virtual-scroll__item",e.class],style:e.style},n),[(s=l.default)==null?void 0:s.call(l)])})}}),Ha=-1,Ua=1,Ce=100,Ka=J({itemHeight:{type:[Number,String],default:null},height:[Number,String]},"virtual");function za(e,o){const n=ea(),u=G(0);Ue(()=>{u.value=parseFloat(e.itemHeight||0)});const l=G(0),r=G(Math.ceil((parseInt(e.height)||n.height.value)/(u.value||16))||1),v=G(0),c=G(0),s=E(),m=E();let b=0;const{resizeRef:S,contentRect:i}=it();Ue(()=>{S.value=s.value});const p=w(()=>{var a;return s.value===document.documentElement?n.height.value:((a=i.value)==null?void 0:a.height)||parseInt(e.height)||0}),_=w(()=>!!(s.value&&m.value&&p.value&&u.value));let g=Array.from({length:o.value.length}),t=Array.from({length:o.value.length});const h=G(0);let y=-1;function T(a){return g[a]||u.value}const x=ta(()=>{const a=performance.now();t[0]=0;const f=o.value.length;for(let C=1;C<=f-1;C++)t[C]=(t[C-1]||0)+T(C-1);h.value=Math.max(h.value,performance.now()-a)},h),L=W(_,a=>{a&&(L(),b=m.value.offsetTop,x.immediate(),M(),~y&&Ee(()=>{Ae&&window.requestAnimationFrame(()=>{me(y),y=-1})}))});ct(()=>{x.clear()});function O(a,f){const C=g[a],I=u.value;u.value=I?Math.min(u.value,f):f,(C!==f||I!==u.value)&&(g[a]=f,x())}function k(a){return a=Te(a,0,o.value.length-1),t[a]||0}function U(a){return Ga(t,a)}let j=0,z=0,X=0;W(p,(a,f)=>{f&&(M(),a<f&&requestAnimationFrame(()=>{z=0,M()}))});function Z(){if(!s.value||!m.value)return;const a=s.value.scrollTop,f=performance.now();f-X>500?(z=Math.sign(a-j),b=m.value.offsetTop):z=a-j,j=a,X=f,M()}function Q(){!s.value||!m.value||(z=0,X=0,M())}let ee=-1;function M(){cancelAnimationFrame(ee),ee=requestAnimationFrame(xe)}function xe(){if(!s.value||!p.value)return;const a=j-b,f=Math.sign(z),C=Math.max(0,a-Ce),I=Te(U(C),0,o.value.length),$=a+p.value+Ce,V=Te(U($)+1,I+1,o.value.length);if((f!==Ha||I<l.value)&&(f!==Ua||V>r.value)){const P=k(l.value)-k(I),B=k(V)-k(r.value);Math.max(P,B)>Ce?(l.value=I,r.value=V):(I<=0&&(l.value=I),V>=o.value.length&&(r.value=V))}v.value=k(l.value),c.value=k(o.value.length)-k(r.value)}function me(a){const f=k(a);!s.value||a&&!f?y=a:s.value.scrollTop=f}const we=w(()=>o.value.slice(l.value,r.value).map((a,f)=>({raw:a,index:f+l.value})));return W(o,()=>{g=Array.from({length:o.value.length}),t=Array.from({length:o.value.length}),x.immediate(),M()},{deep:!0}),{calculateVisibleItems:M,containerRef:s,markerRef:m,computedItems:we,paddingTop:v,paddingBottom:c,scrollToIndex:me,handleScroll:Z,handleScrollend:Q,handleItemResize:O}}function Ga(e,o){let n=e.length-1,u=0,l=0,r=null,v=-1;if(e[n]<o)return n;for(;u<=n;)if(l=u+n>>1,r=e[l],r>o)n=l-1;else if(r<o)v=l,u=l+1;else return r===o?l:u;return v}const Wa=J({items:{type:Array,default:()=>[]},renderless:Boolean,...Ka(),...Ve(),...aa()},"VVirtualScroll"),ja=oe()({name:"VVirtualScroll",props:Wa(),setup(e,o){let{slots:n}=o;const u=la("VVirtualScroll"),{dimensionStyles:l}=na(e),{calculateVisibleItems:r,containerRef:v,markerRef:c,handleScroll:s,handleScrollend:m,handleItemResize:b,scrollToIndex:S,paddingTop:i,paddingBottom:p,computedItems:_}=za(e,ae(e,"items"));return sa(()=>e.renderless,()=>{function g(){var y,T;const h=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?"addEventListener":"removeEventListener";v.value===document.documentElement?(document[h]("scroll",s,{passive:!0}),document[h]("scrollend",m)):((y=v.value)==null||y[h]("scroll",s,{passive:!0}),(T=v.value)==null||T[h]("scrollend",m))}se(()=>{v.value=Ca(u.vnode.el,!0),g(!0)}),ct(g)}),de(()=>{const g=_.value.map(t=>d(Fa,{key:t.index,renderless:e.renderless,"onUpdate:height":h=>b(t.index,h)},{default:h=>{var y;return(y=n.default)==null?void 0:y.call(n,{item:t.raw,index:t.index,...h})}}));return e.renderless?d(H,null,[d("div",{ref:c,class:"v-virtual-scroll__spacer",style:{paddingTop:fe(i.value)}},null),g,d("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:fe(p.value)}},null)]):d("div",{ref:v,class:["v-virtual-scroll",e.class],onScrollPassive:s,onScrollend:m,style:[l.value,e.style]},[d("div",{ref:c,class:"v-virtual-scroll__container",style:{paddingTop:fe(i.value),paddingBottom:fe(p.value)}},[g])])}),{calculateVisibleItems:r,scrollToIndex:S}}});function Xa(e,o){const n=G(!1);let u;function l(c){cancelAnimationFrame(u),n.value=!0,u=requestAnimationFrame(()=>{u=requestAnimationFrame(()=>{n.value=!1})})}async function r(){await new Promise(c=>requestAnimationFrame(c)),await new Promise(c=>requestAnimationFrame(c)),await new Promise(c=>requestAnimationFrame(c)),await new Promise(c=>{if(n.value){const s=W(n,()=>{s(),c()})}else c()})}async function v(c){var b,S;if(c.key==="Tab"&&((b=o.value)==null||b.focus()),!["PageDown","PageUp","Home","End"].includes(c.key))return;const s=(S=e.value)==null?void 0:S.$el;if(!s)return;(c.key==="Home"||c.key==="End")&&s.scrollTo({top:c.key==="Home"?0:s.scrollHeight,behavior:"smooth"}),await r();const m=s.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(c.key==="PageDown"||c.key==="Home"){const i=s.getBoundingClientRect().top;for(const p of m)if(p.getBoundingClientRect().top>=i){p.focus();break}}else{const i=s.getBoundingClientRect().bottom;for(const p of[...m].reverse())if(p.getBoundingClientRect().bottom<=i){p.focus();break}}}return{onScrollPassive:l,onKeydown:v}}const Qa=J({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:he,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...oa({itemChildren:!1})},"Select"),Ya=J({...Qa(),...ut(wa({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...ua({transition:{component:ft}})},"VSelect"),tt=oe()({name:"VSelect",props:Ya(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,o){let{slots:n}=o;const{t:u}=ot(),l=E(),r=E(),v=E(),c=ye(e,"menu"),s=w({get:()=>c.value,set:a=>{var f;c.value&&!a&&((f=r.value)!=null&&f.ΨopenChildren.size)||(c.value=a)}}),{items:m,transformIn:b,transformOut:S}=ra(e),i=ye(e,"modelValue",[],a=>b(a===null?[null]:da(a)),a=>{const f=S(a);return e.multiple?f:f[0]??null}),p=w(()=>typeof e.counterValue=="function"?e.counterValue(i.value):typeof e.counterValue=="number"?e.counterValue:i.value.length),_=Sa(),g=w(()=>i.value.map(a=>a.value)),t=G(!1),h=w(()=>s.value?e.closeText:e.openText);let y="",T;const x=w(()=>e.hideSelected?m.value.filter(a=>!i.value.some(f=>e.valueComparator(f,a))):m.value),L=w(()=>e.hideNoData&&!x.value.length||e.readonly||(_==null?void 0:_.isReadonly.value)),O=w(()=>{var a;return{...e.menuProps,activatorProps:{...((a=e.menuProps)==null?void 0:a.activatorProps)||{},"aria-haspopup":"listbox"}}}),k=E(),U=Xa(k,l);function j(a){e.openOnClear&&(s.value=!0)}function z(){L.value||(s.value=!s.value)}function X(a){ze(a)&&Z(a)}function Z(a){var $,V;if(!a.key||e.readonly||_!=null&&_.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(a.key)&&a.preventDefault(),["Enter","ArrowDown"," "].includes(a.key)&&(s.value=!0),["Escape","Tab"].includes(a.key)&&(s.value=!1),a.key==="Home"?($=k.value)==null||$.focus("first"):a.key==="End"&&((V=k.value)==null||V.focus("last"));const f=1e3;if(e.multiple||!ze(a))return;const C=performance.now();C-T>f&&(y=""),y+=a.key.toLowerCase(),T=C;const I=m.value.find(P=>P.title.toLowerCase().startsWith(y));if(I!==void 0){i.value=[I];const P=x.value.indexOf(I);Ae&&window.requestAnimationFrame(()=>{var B;P>=0&&((B=v.value)==null||B.scrollToIndex(P))})}}function Q(a){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!a.props.disabled)if(e.multiple){const C=i.value.findIndex($=>e.valueComparator($.value,a.value)),I=f??!~C;if(~C){const $=I?[...i.value,a]:[...i.value];$.splice(C,1),i.value=$}else I&&(i.value=[...i.value,a])}else{const C=f!==!1;i.value=C?[a]:[],Ee(()=>{s.value=!1})}}function ee(a){var f;(f=k.value)!=null&&f.$el.contains(a.relatedTarget)||(s.value=!1)}function M(){var a;e.eager&&((a=v.value)==null||a.calculateVisibleItems())}function xe(){var a;t.value&&((a=l.value)==null||a.focus())}function me(a){t.value=!0}function we(a){if(a==null)i.value=[];else if(Ge(l.value,":autofill")||Ge(l.value,":-webkit-autofill")){const f=m.value.find(C=>C.title===a);f&&Q(f)}else l.value&&(l.value.value="")}return W(s,()=>{if(!e.hideSelected&&s.value&&i.value.length){const a=x.value.findIndex(f=>i.value.some(C=>e.valueComparator(C.value,f.value)));Ae&&window.requestAnimationFrame(()=>{var f;a>=0&&((f=v.value)==null||f.scrollToIndex(a))})}}),W(()=>e.items,(a,f)=>{s.value||t.value&&!f.length&&a.length&&(s.value=!0)}),de(()=>{const a=!!(e.chips||n.chip),f=!!(!e.hideNoData||x.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),C=i.value.length>0,I=Ie.filterProps(e),$=C||!t.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return d(Ie,q({ref:l},I,{modelValue:i.value.map(V=>V.props.value).join(", "),"onUpdate:modelValue":we,focused:t.value,"onUpdate:focused":V=>t.value=V,validationValue:i.externalValue,counterValue:p.value,dirty:C,class:["v-select",{"v-select--active-menu":s.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":i.value.length,"v-select--selection-slot":!!n.selection},e.class],style:e.style,inputmode:"none",placeholder:$,"onClick:clear":j,"onMousedown:control":z,onBlur:ee,onKeydown:Z,"aria-label":u(h.value),title:u(h.value)}),{...n,default:()=>d(H,null,[d(Oa,q({ref:r,modelValue:s.value,"onUpdate:modelValue":V=>s.value=V,activator:"parent",contentClass:"v-select__content",disabled:L.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:M,onAfterLeave:xe},O.value),{default:()=>[f&&d(ia,q({ref:k,selected:g.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:V=>V.preventDefault(),onKeydown:X,onFocusin:me,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},U,e.listProps),{default:()=>{var V,P,B;return[(V=n["prepend-item"])==null?void 0:V.call(n),!x.value.length&&!e.hideNoData&&(((P=n["no-data"])==null?void 0:P.call(n))??d(Ke,{title:u(e.noDataText)},null)),d(ja,{ref:v,renderless:!0,items:x.value},{default:Y=>{var Oe;let{item:F,index:te,itemRef:N}=Y;const Me=q(F.props,{ref:N,key:te,onClick:()=>Q(F,null)});return((Oe=n.item)==null?void 0:Oe.call(n,{item:F,index:te,props:Me}))??d(Ke,q(Me,{role:"option"}),{prepend:gt=>{let{isSelected:bt}=gt;return d(H,null,[e.multiple&&!e.hideSelected?d(_a,{key:F.value,modelValue:bt,ripple:!1,tabindex:"-1"},null):void 0,F.props.prependAvatar&&d(_e,{image:F.props.prependAvatar},null),F.props.prependIcon&&d(le,{icon:F.props.prependIcon},null)])}})}}),(B=n["append-item"])==null?void 0:B.call(n)]}})]}),i.value.map((V,P)=>{function B(N){N.stopPropagation(),N.preventDefault(),Q(V,!1)}const Y={"onClick:close":B,onKeydown(N){N.key!=="Enter"&&N.key!==" "||(N.preventDefault(),N.stopPropagation(),B(N))},onMousedown(N){N.preventDefault(),N.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},F=a?!!n.chip:!!n.selection,te=F?ca(a?n.chip({item:V,index:P,props:Y}):n.selection({item:V,index:P})):void 0;if(!(F&&!te))return d("div",{key:V.value,class:"v-select__selection"},[a?n.chip?d(ne,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:V.title}}},{default:()=>[te]}):d(qa,q({key:"chip",closable:e.closableChips,size:"small",text:V.title,disabled:V.props.disabled},Y),null):te??d("span",{class:"v-select__selection-text"},[V.title,e.multiple&&P<i.value.length-1&&d("span",{class:"v-select__selection-comma"},[dt(",")])])])})]),"append-inner":function(){var Y;for(var V=arguments.length,P=new Array(V),B=0;B<V;B++)P[B]=arguments[B];return d(H,null,[(Y=n["append-inner"])==null?void 0:Y.call(n,...P),e.menuIcon?d(le,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),ht({isFocused:t,menu:s,select:Q},l)}}),Ja={class:"browse-selects"},Za={class:"selects mt-5 mb-8"},el={class:"no-data-placeholder"},tl=ve({__name:"Browse",props:{corpusArr:{default:()=>[]},volumeLabel:{default:"Volume"},textLabel:{default:"Text"}},emits:["chosen"],setup(e,{emit:o}){const n={get chosen(){return{volume:"",text:""}}},u=o,l=ge("volume"),r=ge("text");l.value&&b(),r.value&&m(),se(m),vt(()=>{l.value=null,r.value=null});const v=w(()=>{if(l.value)return e.corpusArr.find(({volumeName:S})=>S===l.value)}),c=w(()=>v.value?v.value.texts:[]);function s(S,i){i==="volume"?(r.value=null,b()):m()}function m(){u("chosen",{volume:l.value,text:r.value})}function b(){u("chosen",n.chosen)}return(S,i)=>(A(),R("div",Ja,[D("div",Za,[d(tt,{modelValue:K(l),"onUpdate:modelValue":[i[0]||(i[0]=p=>We(l)?l.value=p:null),i[1]||(i[1]=p=>s(p,"volume"))],items:S.corpusArr,label:S.volumeLabel,"item-title":"volumeName","item-value":"volumeName",variant:"outlined",density:"compact"},null,8,["modelValue","items","label"]),d(tt,{modelValue:K(r),"onUpdate:modelValue":[i[2]||(i[2]=p=>We(r)?r.value=p:null),i[3]||(i[3]=p=>s(p,"text"))],items:c.value,label:S.textLabel,"item-title":"textName","item-value":"textNumber",variant:"outlined",density:"compact"},{"no-data":be(()=>[i[4]||(i[4]=D("span",{class:"no-data-arrow"},"⬅",-1)),D("span",el,mt(`A ${S.volumeLabel} should be chosen`),1)]),_:1},8,["modelValue","items","label"])])]))}}),al=ue(tl,[["__scopeId","data-v-69ac25b0"]]),ll={},nl={height:"3em",viewBox:"0 0 24 24",width:"3em",xmlns:"http://www.w3.org/2000/svg"};function sl(e,o){return A(),R("svg",nl,o[0]||(o[0]=[D("path",{d:"M3 20q-.825 0-1.412-.587T1 18V6q0-.825.588-1.412T3 4h18q.825 0 1.413.588T23 6v12q0 .825-.587 1.413T21 20zm0-2h18V6H3zm6-1h6q.425 0 .713-.288T16 16t-.288-.712T15 15H9q-.425 0-.712.288T8 16t.288.713T9 17m-6 1V6zm3-8q.425 0 .713-.288T7 9t-.288-.712T6 8t-.712.288T5 9t.288.713T6 10m4 0q.425 0 .713-.288T11 9t-.288-.712T10 8t-.712.288T9 9t.288.713T10 10m4 0q.425 0 .713-.288T15 9t-.288-.712T14 8t-.712.288T13 9t.288.713T14 10m4 0q.425 0 .713-.288T19 9t-.288-.712T18 8t-.712.288T17 9t.288.713T18 10M6 13.5q.425 0 .713-.288T7 12.5t-.288-.712T6 11.5t-.712.288T5 12.5t.288.713T6 13.5m4 0q.425 0 .713-.288T11 12.5t-.288-.712T10 11.5t-.712.288T9 12.5t.288.713t.712.287m4 0q.425 0 .713-.288T15 12.5t-.288-.712T14 11.5t-.712.288T13 12.5t.288.713t.712.287m4 0q.425 0 .713-.288T19 12.5t-.288-.712T18 11.5t-.712.288T17 12.5t.288.713t.712.287",fill:"lightGrey"},null,-1)]))}const ol=ue(ll,[["render",sl],["__scopeId","data-v-c2634224"]]),ul={class:"d-flex align-center flex-column"},rl={class:"searchers"},il={class:"d-flex ga-3"},cl=ve({__name:"Search",props:{textusLabel:{default:"Search corpus"},versioLabel:{default:"Search translation"}},emits:["searchers","copy-to-clipboard"],setup(e,{emit:o}){const n=e,u={get searchers(){return{textus:null,versio:null}}},l=o,r=E(u.searchers),v=E(u.searchers),c=E(!1),s=E(null),m=ge("textus"),b=ge("versio");r.value.textus=m.value,r.value.versio=b.value;const S=w(()=>!r.value.textus&&!r.value.versio),i=w(()=>[{name:"textus",value:r.value.textus,label:n.textusLabel},{name:"versio",value:r.value.versio,label:n.versioLabel}]);se(g);function p(h,y){r.value[y]=h||"",h||g()}function _(h){r.value.textus=h,c.value&&g()}function g(){v.value=ke.cloneDeep(r.value),l("searchers",ke.cloneDeep(v.value)),t()}function t(){m.value=v.value.textus||null,b.value=v.value.versio||null}return se(()=>{r.value.textus=m.value,r.value.versio=b.value,(r.value.textus||r.value.versio)&&g(),s.value=document.querySelector(".searchers .v-text-field.input_textus input")}),vt(()=>{m.value=null,b.value=null}),(h,y)=>{const T=ol;return A(),R("div",ul,[D("div",rl,[D("div",null,[D("div",il,[d(T,{class:"keyboard-icon",onClick:y[0]||(y[0]=x=>c.value=!0)}),d(va,{disabled:S.value,variant:"outlined",class:"search-btn",onClick:g},{default:be(()=>y[3]||(y[3]=[dt(" Search ")])),_:1},8,["disabled"])]),d(Xe,{value:i.value[0].value,"input-el":s.value,type:"regex",visible:"",onSubmit:_},null,8,["value","input-el"])]),(A(!0),R(H,null,Le(i.value,({value:x,label:L,name:O})=>(A(),ce(Ie,{key:O,"model-value":x,label:L,class:Be(`input_${O}`),style:{"min-width":"200px"},variant:"outlined",density:"compact","hide-details":"",clearable:"","onUpdate:modelValue":k=>p(k,O),onKeydown:ma(fa(g,["prevent"]),["enter"])},null,8,["model-value","label","class","onUpdate:modelValue","onKeydown"]))),128))]),d(ka,{modelValue:c.value,"onUpdate:modelValue":y[2]||(y[2]=x=>c.value=x),"hide-overlay":"",fullscreen:""},{default:be(()=>[d(Xe,{visible:c.value,value:r.value.textus,"input-name":e.textusLabel,"onUpdate:visible":y[1]||(y[1]=x=>c.value=x),onSubmit:_},null,8,["visible","value","input-name"])]),_:1},8,["modelValue"])])}}}),dl=ue(cl,[["__scopeId","data-v-1f2e1014"]]),vl=["id"],ml={class:"controls-wrapper"},fl={class:"lines"},hl=ve({__name:"LineCard",props:{line:{},searchers:{}},setup(e){const o=e,n=E(null),u=De(),l=ha(),r=w(()=>pa.map(i=>({lineName:i,str:o.line[i],searcher:o.searchers.data[i]}))),v=w(()=>!o.searchers.areAllEmpty),c=w(()=>u.hash),s=w(()=>"#"+o.line.hash);function m(){Pe(n.value,"chosen")}W(c,(i,p)=>{!i&&p&&m()});async function b(){if(!v.value)return;const{volumeName:i,textNumber:p}=o.line;await l.push({query:{mode:re.browse,volume:i,text:p}}),await pe({hash:s.value})}function S(){if(!u.hash){pe({hash:s.value});return}La(u.hash),u.hash===s.value?l.replace({query:u.query,hash:""}):(pe({hash:s.value,keepLocation:!0}),l.replace({query:u.query,hash:s.value}));const i=Array.from(document.querySelectorAll('div.line-card[id^="h"]'));for(const p of i)p.style.background&&p.id!==o.line.hash&&Pe(p)}return(i,p)=>i.line?(A(),R("div",{key:0,class:"line-card",id:i.line.hash,ref_key:"lineCardRef",ref:n},[D("div",ml,[v.value?(A(),R("div",{key:1,class:"control-sign",onClick:b},"▤")):(A(),R("div",{key:0,class:"control-sign",onClick:S},"#"))]),D("div",fl,[(A(!0),R(H,null,Le(r.value,(_,g)=>(A(),ce(Va,q({ref_for:!0},_,{key:g,class:"mb-1"}),null,16))),128)),p[0]||(p[0]=D("div",null,[D("br")],-1))])],8,vl)):ie("",!0)}}),pl=ue(hl,[["__scopeId","data-v-114feac8"]]),yl={class:"results"},gl=ve({__name:"Results",props:{results:{},searchers:{}},setup(e){const o=De(),n=ya(),u=ae(n,"isDark"),l=w(()=>!e.searchers.areAllEmpty);return se(async()=>{var v;const r=o.hash;r&&(await Ia(1e3),(v=document.querySelector(r))==null||v.scrollIntoView({behavior:"smooth",block:"center"}))}),(r,v)=>(A(),R("div",yl,[l.value?(A(),R("div",{key:0,class:Be(["results-stats",{invert:u.value}])},[D("div",null,"Found "+mt(r.results.length)+" contexts",1),v[0]||(v[0]=D("div",null,[D("br")],-1))],2)):ie("",!0),D("div",null,[r.results?(A(),ce(Pa,{key:0,items:r.results},{default:be(({items:c})=>[(A(!0),R(H,null,Le(c,s=>(A(),R(H,null,[s?(A(),ce(pl,{line:s,searchers:r.searchers,key:s.hash},null,8,["line","searchers"])):ie("",!0)],64))),256))]),_:1},8,["items"])):ie("",!0)])]))}}),bl=ue(gl,[["__scopeId","data-v-caf26020"]]),kl={key:0,class:"searcher-wrapper"},Vl=ve({__name:"BrowseAndSearch",setup(e){const o=De(),n=Da();n.initCorpus();const u={get chosen(){return{volume:null,text:null}},get searchers(){return new Qe({textus:"",versio:""})}},l=E(!1),r=E(u.searchers),v=E({volume:null,text:null});let c=null;const s=ga(),m=w(()=>{if(!v.value.text||!n.corpusArray.length)return[];const g=ke.find(n.corpusArray,{volumeName:v.value.volume});return ke.find(g.texts,{textNumber:v.value.text}).contents}),b=w(()=>n.corpusLines),S=w(()=>r.value.areAllEmpty?[]:b.value.filter(r.value.test)),i=w(()=>s.mode===re.browse?m.value:S.value);se(()=>{c=setInterval(()=>{var t;l.value=!!((t=getSelection())!=null&&t.toString())},100);const g=o.hash;g&&pe({hash:g})}),rt(()=>{clearInterval(c)});function p(g){r.value=new Qe(g)}function _(g){v.value=g}return(g,t)=>(A(),R("div",{class:Be([{"no-hashes":l.value},"browse-and-search"])},[K(s).mode===K(re).search?(A(),R("div",kl,[d(Ea,{count:i.value.length},null,8,["count"]),d(dl,{"corpus-arr-prop":K(n).corpusArray,"textus-label":"Aramaic text","versio-label":"Translation text",onSearchers:p},null,8,["corpus-arr-prop"])])):K(s).mode===K(re).browse?(A(),ce(al,{key:1,"corpus-arr":K(n).corpusArray,onChosen:_},null,8,["corpus-arr"])):ie("",!0),d(bl,{results:i.value,searchers:K(s).mode===K(re).search?r.value:u.searchers},null,8,["results","searchers"])],2))}}),Rl=ue(Vl,[["__scopeId","data-v-91f5e495"]]);export{Rl as B};
