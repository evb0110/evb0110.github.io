var xt=Object.defineProperty;var Vt=(e,n,a)=>n in e?xt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a;var q=(e,n,a)=>Vt(e,typeof n!="symbol"?n+"":n,a);import{E as oe,b8 as wt,d as St,c as V,G as Tt,q as Z,b9 as Ct,s as we,av as _t,S as lt,T as nt,aQ as st,v as re,U as ot,Y as At,af as It,t as le,x as fe,g as d,P as M,al as be,ba as $e,aL as Pt,ab as Et,ar as Lt,a4 as Bt,as as Dt,aP as Rt,bb as Nt,an as qt,X as ut,aR as Mt,aS as Ft,ac as Ot,at as $t,au as Ht,bc as Ut,a3 as ke,a5 as Kt,aV as zt,a0 as He,a1 as Gt,aX as Wt,bd as jt,aq as ne,ap as se,a7 as Xt,F as U,aK as Ie,M as rt,ae as Qt,W as Yt,ai as Jt,r as B,a2 as Zt,Z as W,$ as ea,be as ta,b4 as it,bf as aa,aa as Le,bg as Ue,e as j,ay as ve,bh as la,bi as Ce,bj as ct,bk as na,w as Ke,bl as dt,b7 as _e,bm as sa,am as oa,bn as ua,ao as ra,bo as ia,a9 as ye,aY as ue,bp as ca,bq as da,br as va,bs as ma,bt as ze,bu as fa,p as vt,bv as ha,bw as Ge,bx as We,b as he,aC as xe,by as mt,o as A,f as R,k as D,i as z,j as je,h as Ve,l as ft,_ as ie,V as pa,n as Be,D as me,ah as De,B as ya,aE as ba,bz as Re,A as ga,m as de,bA as ka,bB as ce,H as xa,bC as Va}from"./index-YMC-YLMj.js";import{L as Xe,u as wa,K as Qe,_ as Sa,S as Ye}from"./GrepLine.vue_vue_type_style_index_0_lang-BojQ6RdM.js";import{a as Ta}from"./axios-CCb-kr4I.js";import{a as Je}from"./assets-BKx6_Z8h.js";import{m as Ca,V as Pe}from"./VTextField-CznTxoFD.js";import{h as _a}from"./VInput-GbnNyoEZ.js";import{f as ht}from"./forwardRefs-DWGaNmQL.js";import{a as pt,V as Aa}from"./VDialog-n0ljl_PH.js";import{m as Ia,V as Ze,a as et,g as Pa}from"./VOverlay-BAdtkY9Y.js";import{V as Ea}from"./VCheckboxBtn-fxmQMFp3.js";import{m as La,V as tt}from"./VSlideGroup-Ci-Z-SHl.js";import{s as Ba}from"./sleep-mAKpSMLY.js";import{_ as Da}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-C3yNOmFB.js";import{_ as Ra}from"./CopyResults.vue_vue_type_script_setup_true_lang-Fno6aOn5.js";const yt=300;function ge({hash:e="",keepLocation:n=!1,className:a="chosen"}){return new Promise(u=>{setTimeout(()=>{n||(location.hash=e,setTimeout(()=>scrollBy(0,-200),0));const s=document.querySelector(e);s&&(s.classList.add(a),setTimeout(u,1))},yt)})}function Na(e){const n=document.querySelector(e);n&&Ee(n)}function Ee(e,n="chosen"){e&&setTimeout(()=>{e.classList.remove(n)},yt)}class Ne{constructor({volume:n,texts:a}){q(this,"volumeName");q(this,"texts");this.texts=a.map(u=>({volumeName:n,...u})).map(qe.instantiate),this.volumeName=n}get totalContents(){return oe.flatMap(this.texts,"contents")}static instantiate(n){return new Ne(n)}}class qe{constructor({volumeName:n,textNumber:a,textName:u,contents:s}){q(this,"volumeName");q(this,"textNumber");q(this,"_textName");q(this,"rawContents");this.volumeName=n,this.textNumber=a,this._textName=u,this.rawContents=s}get contents(){return this.rawContents.map(n=>({volumeName:this.volumeName,textNumber:this.textNumber,textName:this.textName,...n})).map(Me.instantiate)}get textName(){return this._textName.replace(/\.txt/,"")}set textName(n){this._textName=n}static instantiate(n){return new qe(n)}}class Me{constructor({volumeName:n,textNumber:a,textName:u,lineNumber:s,textus:r,versio:v}){q(this,"volumeName");q(this,"textNumber");q(this,"textName");q(this,"lineNumber");q(this,"textus");q(this,"versio");this.volumeName=n,this.textNumber=a,this.textName=u,this.lineNumber=s,this.textus=r,this.versio=v}get title(){return this.volumeName+": "+this.textName}get hash(){return"h"+wt(this)}static instantiate(n){return new Me(n)}}const qa={[Xe.maalula]:{link:Je.maalulaCorpusJson.link},[Xe.turoyo]:{link:Je.turoyoNewCorpusJson.link}},Ma=St("corpusWithTranslationStore",()=>{const e=wa(),n=V(()=>qa[e.value].link),a=Tt(async()=>(await Ta.get(n.value)).data.map(Ne.instantiate),[]),u=V(()=>oe.flatMap(a.value,"totalContents"));return{corpusArray:a,corpusLines:u}}),bt=Symbol.for("vuetify:v-chip-group"),Fa=Z({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:Ct},...La(),...we(),..._t({selectedClass:"v-chip--selected"}),...lt(),...nt(),...st({variant:"tonal"})},"VChipGroup");re()({name:"VChipGroup",props:Fa(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:a}=n;const{themeClasses:u}=ot(e),{isSelected:s,select:r,next:v,prev:c,selected:o}=At(e,bt);return It({VChip:{color:le(e,"color"),disabled:le(e,"disabled"),filter:le(e,"filter"),variant:le(e,"variant")}}),fe(()=>{const m=tt.filterProps(e);return d(tt,M(m,{class:["v-chip-group",{"v-chip-group--column":e.column},u.value,e.class],style:e.style}),{default:()=>{var g;return[(g=a.default)==null?void 0:g.call(a,{isSelected:s,select:r,next:v,prev:c,selected:o.value})]}})}),{}}});const Oa=Z({activeClass:String,appendAvatar:String,appendIcon:be,closable:Boolean,closeIcon:{type:be,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:be,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:$e(),onClickOnce:$e(),...Pt(),...we(),...Et(),...Lt(),...Bt(),...Dt(),...Rt(),...Nt(),...lt({tag:"span"}),...nt(),...st({variant:"tonal"})},"VChip"),$a=re()({name:"VChip",directives:{Ripple:qt},props:Oa(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,n){let{attrs:a,emit:u,slots:s}=n;const{t:r}=ut(),{borderClasses:v}=Mt(e),{colorClasses:c,colorStyles:o,variantClasses:m}=Ft(e),{densityClasses:g}=Ot(e),{elevationClasses:S}=$t(e),{roundedClasses:i}=Ht(e),{sizeClasses:p}=Ut(e),{themeClasses:_}=ot(e),b=ke(e,"modelValue"),t=Kt(e,bt,!1),h=zt(e,a),y=V(()=>e.link!==!1&&h.isLink.value),T=V(()=>!e.disabled&&e.link!==!1&&(!!t||e.link||h.isClickable.value)),w=V(()=>({"aria-label":r(e.closeLabel),onClick(k){k.preventDefault(),k.stopPropagation(),b.value=!1,u("click:close",k)}}));function E(k){var K;u("click",k),T.value&&((K=h.navigate)==null||K.call(h,k),t==null||t.toggle())}function O(k){(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),E(k))}return()=>{const k=h.isLink.value?"a":e.tag,K=!!(e.appendIcon||e.appendAvatar),X=!!(K||s.append),G=!!(s.close||e.closable),Q=!!(s.filter||e.filter)&&t,ee=!!(e.prependIcon||e.prependAvatar),Y=!!(ee||s.prepend),te=!t||t.isSelected.value;return b.value&&He(d(k,M({class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":T.value,"v-chip--filter":Q,"v-chip--pill":e.pill},_.value,v.value,te?c.value:void 0,g.value,S.value,i.value,p.value,m.value,t==null?void 0:t.selectedClass.value,e.class],style:[te?o.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,tabindex:T.value?0:void 0,onClick:E,onKeydown:T.value&&!y.value&&O},h.linkProps),{default:()=>{var F;return[Wt(T.value,"v-chip"),Q&&d(jt,{key:"filter"},{default:()=>[He(d("div",{class:"v-chip__filter"},[s.filter?d(se,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},s.filter):d(ne,{key:"filter-icon",icon:e.filterIcon},null)]),[[Xt,t.isSelected.value]])]}),Y&&d("div",{key:"prepend",class:"v-chip__prepend"},[s.prepend?d(se,{key:"prepend-defaults",disabled:!ee,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},s.prepend):d(U,null,[e.prependIcon&&d(ne,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&d(Ie,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),d("div",{class:"v-chip__content","data-no-activator":""},[((F=s.default)==null?void 0:F.call(s,{isSelected:t==null?void 0:t.isSelected.value,selectedClass:t==null?void 0:t.selectedClass.value,select:t==null?void 0:t.select,toggle:t==null?void 0:t.toggle,value:t==null?void 0:t.value.value,disabled:e.disabled}))??e.text]),X&&d("div",{key:"append",class:"v-chip__append"},[s.append?d(se,{key:"append-defaults",disabled:!K,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},s.append):d(U,null,[e.appendIcon&&d(ne,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&d(Ie,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),G&&d("button",M({key:"close",class:"v-chip__close",type:"button","data-testid":"close-chip"},w.value),[s.close?d(se,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},s.close):d(ne,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[Gt("ripple"),T.value&&e.ripple,null]])}}}),Ha=Z({id:String,submenu:Boolean,...rt(Ia({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:pt}}),["absolute"])},"VMenu"),Ua=re()({name:"VMenu",props:Ha(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:a}=n;const u=ke(e,"modelValue"),{scopeId:s}=Qt(),{isRtl:r}=Yt(),v=Jt(),c=V(()=>e.id||`v-menu-${v}`),o=B(),m=Zt(Ze,null),g=W(new Set);ea(Ze,{register(){g.value.add(v)},unregister(){g.value.delete(v)},closeParents(t){setTimeout(()=>{var h;!g.value.size&&!e.persistent&&(t==null||(h=o.value)!=null&&h.contentEl&&!ta(t,o.value.contentEl))&&(u.value=!1,m==null||m.closeParents())},40)}}),it(()=>{m==null||m.unregister(),document.removeEventListener("focusin",S)}),aa(()=>u.value=!1);async function S(t){var T,w,E;const h=t.relatedTarget,y=t.target;await Le(),u.value&&h!==y&&((T=o.value)!=null&&T.contentEl)&&((w=o.value)!=null&&w.globalTop)&&![document,o.value.contentEl].includes(y)&&!o.value.contentEl.contains(y)&&((E=Ue(o.value.contentEl)[0])==null||E.focus())}j(u,t=>{t?(m==null||m.register(),ve&&document.addEventListener("focusin",S,{once:!0})):(m==null||m.unregister(),ve&&document.removeEventListener("focusin",S))},{immediate:!0});function i(t){m==null||m.closeParents(t)}function p(t){var h,y,T,w,E;if(!e.disabled)if(t.key==="Tab"||t.key==="Enter"&&!e.closeOnContentClick){if(t.key==="Enter"&&(t.target instanceof HTMLTextAreaElement||t.target instanceof HTMLInputElement&&t.target.closest("form")))return;t.key==="Enter"&&t.preventDefault(),la(Ue((h=o.value)==null?void 0:h.contentEl,!1),t.shiftKey?"prev":"next",k=>k.tabIndex>=0)||(u.value=!1,(T=(y=o.value)==null?void 0:y.activatorEl)==null||T.focus())}else e.submenu&&t.key===(r.value?"ArrowRight":"ArrowLeft")&&(u.value=!1,(E=(w=o.value)==null?void 0:w.activatorEl)==null||E.focus())}function _(t){var y;if(e.disabled)return;const h=(y=o.value)==null?void 0:y.contentEl;h&&u.value?t.key==="ArrowDown"?(t.preventDefault(),t.stopImmediatePropagation(),Ce(h,"next")):t.key==="ArrowUp"?(t.preventDefault(),t.stopImmediatePropagation(),Ce(h,"prev")):e.submenu&&(t.key===(r.value?"ArrowRight":"ArrowLeft")?u.value=!1:t.key===(r.value?"ArrowLeft":"ArrowRight")&&(t.preventDefault(),Ce(h,"first"))):(e.submenu?t.key===(r.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(t.key))&&(u.value=!0,t.preventDefault(),setTimeout(()=>setTimeout(()=>_(t))))}const b=V(()=>M({"aria-haspopup":"menu","aria-expanded":String(u.value),"aria-owns":c.value,onKeydown:_},e.activatorProps));return fe(()=>{const t=et.filterProps(e);return d(et,M({ref:o,id:c.value,class:["v-menu",e.class],style:e.style},t,{modelValue:u.value,"onUpdate:modelValue":h=>u.value=h,absolute:!0,activatorProps:b.value,location:e.location??(e.submenu?"end":"bottom"),"onClick:outside":i,onKeydown:p},s),{activator:a.activator,default:function(){for(var h=arguments.length,y=new Array(h),T=0;T<h;T++)y[T]=arguments[T];return d(se,{root:"VMenu"},{default:()=>{var w;return[(w=a.default)==null?void 0:w.call(a,...y)]}})}})}),ht({id:c,ΨopenChildren:g},o)}}),Ka=Z({renderless:Boolean,...we()},"VVirtualScrollItem"),za=re()({name:"VVirtualScrollItem",inheritAttrs:!1,props:Ka(),emits:{"update:height":e=>!0},setup(e,n){let{attrs:a,emit:u,slots:s}=n;const{resizeRef:r,contentRect:v}=ct(void 0,"border");j(()=>{var c;return(c=v.value)==null?void 0:c.height},c=>{c!=null&&u("update:height",c)}),fe(()=>{var c,o;return e.renderless?d(U,null,[(c=s.default)==null?void 0:c.call(s,{itemRef:r})]):d("div",M({ref:r,class:["v-virtual-scroll__item",e.class],style:e.style},a),[(o=s.default)==null?void 0:o.call(s)])})}}),Ga=-1,Wa=1,Ae=100,ja=Z({itemHeight:{type:[Number,String],default:null},height:[Number,String]},"virtual");function Xa(e,n){const a=na(),u=W(0);Ke(()=>{u.value=parseFloat(e.itemHeight||0)});const s=W(0),r=W(Math.ceil((parseInt(e.height)||a.height.value)/(u.value||16))||1),v=W(0),c=W(0),o=B(),m=B();let g=0;const{resizeRef:S,contentRect:i}=ct();Ke(()=>{S.value=o.value});const p=V(()=>{var l;return o.value===document.documentElement?a.height.value:((l=i.value)==null?void 0:l.height)||parseInt(e.height)||0}),_=V(()=>!!(o.value&&m.value&&p.value&&u.value));let b=Array.from({length:n.value.length}),t=Array.from({length:n.value.length});const h=W(0);let y=-1;function T(l){return b[l]||u.value}const w=sa(()=>{const l=performance.now();t[0]=0;const f=n.value.length;for(let C=1;C<=f-1;C++)t[C]=(t[C-1]||0)+T(C-1);h.value=Math.max(h.value,performance.now()-l)},h),E=j(_,l=>{l&&(E(),g=m.value.offsetTop,w.immediate(),F(),~y&&Le(()=>{ve&&window.requestAnimationFrame(()=>{pe(y),y=-1})}))});dt(()=>{w.clear()});function O(l,f){const C=b[l],I=u.value;u.value=I?Math.min(u.value,f):f,(C!==f||I!==u.value)&&(b[l]=f,w())}function k(l){return l=_e(l,0,n.value.length-1),t[l]||0}function K(l){return Qa(t,l)}let X=0,G=0,Q=0;j(p,(l,f)=>{f&&(F(),l<f&&requestAnimationFrame(()=>{G=0,F()}))});function ee(){if(!o.value||!m.value)return;const l=o.value.scrollTop,f=performance.now();f-Q>500?(G=Math.sign(l-X),g=m.value.offsetTop):G=l-X,X=l,Q=f,F()}function Y(){!o.value||!m.value||(G=0,Q=0,F())}let te=-1;function F(){cancelAnimationFrame(te),te=requestAnimationFrame(Se)}function Se(){if(!o.value||!p.value)return;const l=X-g,f=Math.sign(G),C=Math.max(0,l-Ae),I=_e(K(C),0,n.value.length),$=l+p.value+Ae,x=_e(K($)+1,I+1,n.value.length);if((f!==Ga||I<s.value)&&(f!==Wa||x>r.value)){const P=k(s.value)-k(I),L=k(x)-k(r.value);Math.max(P,L)>Ae?(s.value=I,r.value=x):(I<=0&&(s.value=I),x>=n.value.length&&(r.value=x))}v.value=k(s.value),c.value=k(n.value.length)-k(r.value)}function pe(l){const f=k(l);!o.value||l&&!f?y=l:o.value.scrollTop=f}const Te=V(()=>n.value.slice(s.value,r.value).map((l,f)=>({raw:l,index:f+s.value})));return j(n,()=>{b=Array.from({length:n.value.length}),t=Array.from({length:n.value.length}),w.immediate(),F()},{deep:!0}),{calculateVisibleItems:F,containerRef:o,markerRef:m,computedItems:Te,paddingTop:v,paddingBottom:c,scrollToIndex:pe,handleScroll:ee,handleScrollend:Y,handleItemResize:O}}function Qa(e,n){let a=e.length-1,u=0,s=0,r=null,v=-1;if(e[a]<n)return a;for(;u<=a;)if(s=u+a>>1,r=e[s],r>n)a=s-1;else if(r<n)v=s,u=s+1;else return r===n?s:u;return v}const Ya=Z({items:{type:Array,default:()=>[]},renderless:Boolean,...ja(),...we(),...oa()},"VVirtualScroll"),Ja=re()({name:"VVirtualScroll",props:Ya(),setup(e,n){let{slots:a}=n;const u=ua("VVirtualScroll"),{dimensionStyles:s}=ra(e),{calculateVisibleItems:r,containerRef:v,markerRef:c,handleScroll:o,handleScrollend:m,handleItemResize:g,scrollToIndex:S,paddingTop:i,paddingBottom:p,computedItems:_}=Xa(e,le(e,"items"));return ia(()=>e.renderless,()=>{function b(){var y,T;const h=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?"addEventListener":"removeEventListener";v.value===document.documentElement?(document[h]("scroll",o,{passive:!0}),document[h]("scrollend",m)):((y=v.value)==null||y[h]("scroll",o,{passive:!0}),(T=v.value)==null||T[h]("scrollend",m))}ue(()=>{v.value=Pa(u.vnode.el,!0),b(!0)}),dt(b)}),fe(()=>{const b=_.value.map(t=>d(za,{key:t.index,renderless:e.renderless,"onUpdate:height":h=>g(t.index,h)},{default:h=>{var y;return(y=a.default)==null?void 0:y.call(a,{item:t.raw,index:t.index,...h})}}));return e.renderless?d(U,null,[d("div",{ref:c,class:"v-virtual-scroll__spacer",style:{paddingTop:ye(i.value)}},null),b,d("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:ye(p.value)}},null)]):d("div",{ref:v,class:["v-virtual-scroll",e.class],onScrollPassive:o,onScrollend:m,style:[s.value,e.style]},[d("div",{ref:c,class:"v-virtual-scroll__container",style:{paddingTop:ye(i.value),paddingBottom:ye(p.value)}},[b])])}),{calculateVisibleItems:r,scrollToIndex:S}}});function Za(e,n){const a=W(!1);let u;function s(c){cancelAnimationFrame(u),a.value=!0,u=requestAnimationFrame(()=>{u=requestAnimationFrame(()=>{a.value=!1})})}async function r(){await new Promise(c=>requestAnimationFrame(c)),await new Promise(c=>requestAnimationFrame(c)),await new Promise(c=>requestAnimationFrame(c)),await new Promise(c=>{if(a.value){const o=j(a,()=>{o(),c()})}else c()})}async function v(c){var g,S;if(c.key==="Tab"&&((g=n.value)==null||g.focus()),!["PageDown","PageUp","Home","End"].includes(c.key))return;const o=(S=e.value)==null?void 0:S.$el;if(!o)return;(c.key==="Home"||c.key==="End")&&o.scrollTo({top:c.key==="Home"?0:o.scrollHeight,behavior:"smooth"}),await r();const m=o.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(c.key==="PageDown"||c.key==="Home"){const i=o.getBoundingClientRect().top;for(const p of m)if(p.getBoundingClientRect().top>=i){p.focus();break}}else{const i=o.getBoundingClientRect().bottom;for(const p of[...m].reverse())if(p.getBoundingClientRect().bottom<=i){p.focus();break}}}return{onScrollPassive:s,onKeydown:v}}const el=Z({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:be,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...ca({itemChildren:!1})},"Select"),tl=Z({...el(),...rt(Ca({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...da({transition:{component:pt}})},"VSelect"),at=re()({name:"VSelect",props:tl(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{slots:a}=n;const{t:u}=ut(),s=B(),r=B(),v=B(),c=ke(e,"menu"),o=V({get:()=>c.value,set:l=>{var f;c.value&&!l&&((f=r.value)!=null&&f.ΨopenChildren.size)||(c.value=l)}}),{items:m,transformIn:g,transformOut:S}=va(e),i=ke(e,"modelValue",[],l=>g(l===null?[null]:ha(l)),l=>{const f=S(l);return e.multiple?f:f[0]??null}),p=V(()=>typeof e.counterValue=="function"?e.counterValue(i.value):typeof e.counterValue=="number"?e.counterValue:i.value.length),_=_a(),b=V(()=>i.value.map(l=>l.value)),t=W(!1),h=V(()=>o.value?e.closeText:e.openText);let y="",T;const w=V(()=>e.hideSelected?m.value.filter(l=>!i.value.some(f=>e.valueComparator(f,l))):m.value),E=V(()=>e.hideNoData&&!w.value.length||e.readonly||(_==null?void 0:_.isReadonly.value)),O=V(()=>{var l;return{...e.menuProps,activatorProps:{...((l=e.menuProps)==null?void 0:l.activatorProps)||{},"aria-haspopup":"listbox"}}}),k=B(),K=Za(k,s);function X(l){e.openOnClear&&(o.value=!0)}function G(){E.value||(o.value=!o.value)}function Q(l){Ge(l)&&ee(l)}function ee(l){var $,x;if(!l.key||e.readonly||_!=null&&_.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(l.key)&&l.preventDefault(),["Enter","ArrowDown"," "].includes(l.key)&&(o.value=!0),["Escape","Tab"].includes(l.key)&&(o.value=!1),l.key==="Home"?($=k.value)==null||$.focus("first"):l.key==="End"&&((x=k.value)==null||x.focus("last"));const f=1e3;if(e.multiple||!Ge(l))return;const C=performance.now();C-T>f&&(y=""),y+=l.key.toLowerCase(),T=C;const I=m.value.find(P=>P.title.toLowerCase().startsWith(y));if(I!==void 0){i.value=[I];const P=w.value.indexOf(I);ve&&window.requestAnimationFrame(()=>{var L;P>=0&&((L=v.value)==null||L.scrollToIndex(P))})}}function Y(l){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!l.props.disabled)if(e.multiple){const C=i.value.findIndex($=>e.valueComparator($.value,l.value)),I=f??!~C;if(~C){const $=I?[...i.value,l]:[...i.value];$.splice(C,1),i.value=$}else I&&(i.value=[...i.value,l])}else{const C=f!==!1;i.value=C?[l]:[],Le(()=>{o.value=!1})}}function te(l){var f;(f=k.value)!=null&&f.$el.contains(l.relatedTarget)||(o.value=!1)}function F(){var l;e.eager&&((l=v.value)==null||l.calculateVisibleItems())}function Se(){var l;t.value&&((l=s.value)==null||l.focus())}function pe(l){t.value=!0}function Te(l){if(l==null)i.value=[];else if(We(s.value,":autofill")||We(s.value,":-webkit-autofill")){const f=m.value.find(C=>C.title===l);f&&Y(f)}else s.value&&(s.value.value="")}return j(o,()=>{if(!e.hideSelected&&o.value&&i.value.length){const l=w.value.findIndex(f=>i.value.some(C=>e.valueComparator(C.value,f.value)));ve&&window.requestAnimationFrame(()=>{var f;l>=0&&((f=v.value)==null||f.scrollToIndex(l))})}}),j(()=>e.items,(l,f)=>{o.value||t.value&&!f.length&&l.length&&(o.value=!0)}),fe(()=>{const l=!!(e.chips||a.chip),f=!!(!e.hideNoData||w.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),C=i.value.length>0,I=Pe.filterProps(e),$=C||!t.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return d(Pe,M({ref:s},I,{modelValue:i.value.map(x=>x.props.value).join(", "),"onUpdate:modelValue":Te,focused:t.value,"onUpdate:focused":x=>t.value=x,validationValue:i.externalValue,counterValue:p.value,dirty:C,class:["v-select",{"v-select--active-menu":o.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":i.value.length,"v-select--selection-slot":!!a.selection},e.class],style:e.style,inputmode:"none",placeholder:$,"onClick:clear":X,"onMousedown:control":G,onBlur:te,onKeydown:ee,"aria-label":u(h.value),title:u(h.value)}),{...a,default:()=>d(U,null,[d(Ua,M({ref:r,modelValue:o.value,"onUpdate:modelValue":x=>o.value=x,activator:"parent",contentClass:"v-select__content",disabled:E.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:F,onAfterLeave:Se},O.value),{default:()=>[f&&d(ma,M({ref:k,selected:b.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:x=>x.preventDefault(),onKeydown:Q,onFocusin:pe,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},K,e.listProps),{default:()=>{var x,P,L;return[(x=a["prepend-item"])==null?void 0:x.call(a),!w.value.length&&!e.hideNoData&&(((P=a["no-data"])==null?void 0:P.call(a))??d(ze,{title:u(e.noDataText)},null)),d(Ja,{ref:v,renderless:!0,items:w.value},{default:J=>{var Oe;let{item:H,index:ae,itemRef:N}=J;const Fe=M(H.props,{ref:N,key:ae,onClick:()=>Y(H,null)});return((Oe=a.item)==null?void 0:Oe.call(a,{item:H,index:ae,props:Fe}))??d(ze,M(Fe,{role:"option"}),{prepend:gt=>{let{isSelected:kt}=gt;return d(U,null,[e.multiple&&!e.hideSelected?d(Ea,{key:H.value,modelValue:kt,ripple:!1,tabindex:"-1"},null):void 0,H.props.prependAvatar&&d(Ie,{image:H.props.prependAvatar},null),H.props.prependIcon&&d(ne,{icon:H.props.prependIcon},null)])}})}}),(L=a["append-item"])==null?void 0:L.call(a)]}})]}),i.value.map((x,P)=>{function L(N){N.stopPropagation(),N.preventDefault(),Y(x,!1)}const J={"onClick:close":L,onKeydown(N){N.key!=="Enter"&&N.key!==" "||(N.preventDefault(),N.stopPropagation(),L(N))},onMousedown(N){N.preventDefault(),N.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},H=l?!!a.chip:!!a.selection,ae=H?fa(l?a.chip({item:x,index:P,props:J}):a.selection({item:x,index:P})):void 0;if(!(H&&!ae))return d("div",{key:x.value,class:"v-select__selection"},[l?a.chip?d(se,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:x.title}}},{default:()=>[ae]}):d($a,M({key:"chip",closable:e.closableChips,size:"small",text:x.title,disabled:x.props.disabled},J),null):ae??d("span",{class:"v-select__selection-text"},[x.title,e.multiple&&P<i.value.length-1&&d("span",{class:"v-select__selection-comma"},[vt(",")])])])})]),"append-inner":function(){var J;for(var x=arguments.length,P=new Array(x),L=0;L<x;L++)P[L]=arguments[L];return d(U,null,[(J=a["append-inner"])==null?void 0:J.call(a,...P),e.menuIcon?d(ne,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),ht({isFocused:t,menu:o,select:Y},s)}}),al={class:"browse-selects"},ll={class:"selects mt-5 mb-8"},nl={class:"no-data-placeholder"},sl=he({__name:"Browse",props:{corpusArr:{default:()=>[]},volumeLabel:{default:"Volume"},textLabel:{default:"Text"}},emits:["chosen"],setup(e,{emit:n}){const a={get chosen(){return{volume:"",text:""}}},u=n,s=xe("volume"),r=xe("text");s.value&&g(),r.value&&m(),ue(m),mt(()=>{s.value=null,r.value=null});const v=V(()=>{if(s.value)return e.corpusArr.find(({volumeName:S})=>S===s.value)}),c=V(()=>v.value?v.value.texts:[]);function o(S,i){i==="volume"?(r.value=null,g()):m()}function m(){u("chosen",{volume:s.value,text:r.value})}function g(){u("chosen",a.chosen)}return(S,i)=>(A(),R("div",al,[D("div",ll,[d(at,{modelValue:z(s),"onUpdate:modelValue":[i[0]||(i[0]=p=>je(s)?s.value=p:null),i[1]||(i[1]=p=>o(p,"volume"))],items:S.corpusArr,label:S.volumeLabel,"item-title":"volumeName","item-value":"volumeName",variant:"outlined",density:"compact"},null,8,["modelValue","items","label"]),d(at,{modelValue:z(r),"onUpdate:modelValue":[i[2]||(i[2]=p=>je(r)?r.value=p:null),i[3]||(i[3]=p=>o(p,"text"))],items:c.value,label:S.textLabel,"item-title":"textName","item-value":"textNumber",variant:"outlined",density:"compact"},{"no-data":Ve(()=>[i[4]||(i[4]=D("span",{class:"no-data-arrow"},"⬅",-1)),D("span",nl,ft(`A ${S.volumeLabel} should be chosen`),1)]),_:1},8,["modelValue","items","label"])])]))}}),ol=ie(sl,[["__scopeId","data-v-69ac25b0"]]),ul={},rl={height:"3em",viewBox:"0 0 24 24",width:"3em",xmlns:"http://www.w3.org/2000/svg"};function il(e,n){return A(),R("svg",rl,n[0]||(n[0]=[D("path",{d:"M3 20q-.825 0-1.412-.587T1 18V6q0-.825.588-1.412T3 4h18q.825 0 1.413.588T23 6v12q0 .825-.587 1.413T21 20zm0-2h18V6H3zm6-1h6q.425 0 .713-.288T16 16t-.288-.712T15 15H9q-.425 0-.712.288T8 16t.288.713T9 17m-6 1V6zm3-8q.425 0 .713-.288T7 9t-.288-.712T6 8t-.712.288T5 9t.288.713T6 10m4 0q.425 0 .713-.288T11 9t-.288-.712T10 8t-.712.288T9 9t.288.713T10 10m4 0q.425 0 .713-.288T15 9t-.288-.712T14 8t-.712.288T13 9t.288.713T14 10m4 0q.425 0 .713-.288T19 9t-.288-.712T18 8t-.712.288T17 9t.288.713T18 10M6 13.5q.425 0 .713-.288T7 12.5t-.288-.712T6 11.5t-.712.288T5 12.5t.288.713T6 13.5m4 0q.425 0 .713-.288T11 12.5t-.288-.712T10 11.5t-.712.288T9 12.5t.288.713t.712.287m4 0q.425 0 .713-.288T15 12.5t-.288-.712T14 11.5t-.712.288T13 12.5t.288.713t.712.287m4 0q.425 0 .713-.288T19 12.5t-.288-.712T18 11.5t-.712.288T17 12.5t.288.713t.712.287",fill:"lightGrey"},null,-1)]))}const cl=ie(ul,[["render",il],["__scopeId","data-v-c2634224"]]),dl={class:"d-flex align-center flex-column"},vl={class:"searchers"},ml={class:"d-flex ga-3"},fl=he({__name:"Search",props:{textusLabel:{default:"Search corpus"},versioLabel:{default:"Search translation"}},emits:["searchers","copy-to-clipboard"],setup(e,{emit:n}){const a=e,u={get searchers(){return{textus:null,versio:null}}},s=n,r=B(u.searchers),v=B(u.searchers),c=B(!1),o=B(null),m=xe("textus"),g=xe("versio");r.value.textus=m.value,r.value.versio=g.value;const S=V(()=>!r.value.textus&&!r.value.versio),i=V(()=>[{name:"textus",value:r.value.textus,label:a.textusLabel},{name:"versio",value:r.value.versio,label:a.versioLabel}]);ue(b);function p(h,y){r.value[y]=h||"",h||b()}function _(h){r.value.textus=h,c.value&&b()}function b(){v.value=oe.cloneDeep(r.value),s("searchers",oe.cloneDeep(v.value)),t()}function t(){m.value=v.value.textus||null,g.value=v.value.versio||null}return ue(()=>{r.value.textus=m.value,r.value.versio=g.value,(r.value.textus||r.value.versio)&&b(),o.value=document.querySelector(".searchers .v-text-field.input_textus input")}),mt(()=>{m.value=null,g.value=null}),(h,y)=>{const T=cl;return A(),R("div",dl,[D("div",vl,[D("div",null,[D("div",ml,[d(T,{class:"keyboard-icon",onClick:y[0]||(y[0]=w=>c.value=!0)}),d(pa,{disabled:S.value,variant:"outlined",class:"search-btn",onClick:b},{default:Ve(()=>y[3]||(y[3]=[vt(" Search ")])),_:1},8,["disabled"])]),d(Qe,{value:i.value[0].value,"input-el":o.value,type:"regex",visible:"",onSubmit:_},null,8,["value","input-el"])]),(A(!0),R(U,null,Be(i.value,({value:w,label:E,name:O})=>(A(),me(Pe,{key:O,"model-value":w,label:E,class:De(`input_${O}`),style:{"min-width":"200px"},variant:"outlined",density:"compact","hide-details":"",clearable:"","onUpdate:modelValue":k=>p(k,O),onKeydown:ya(ba(b,["prevent"]),["enter"])},null,8,["model-value","label","class","onUpdate:modelValue","onKeydown"]))),128))]),d(Aa,{modelValue:c.value,"onUpdate:modelValue":y[2]||(y[2]=w=>c.value=w),"hide-overlay":"",fullscreen:""},{default:Ve(()=>[d(Qe,{visible:c.value,value:r.value.textus,"input-name":e.textusLabel,"onUpdate:visible":y[1]||(y[1]=w=>c.value=w),onSubmit:_},null,8,["visible","value","input-name"])]),_:1},8,["modelValue"])])}}}),hl=ie(fl,[["__scopeId","data-v-1f2e1014"]]),pl=["id"],yl={class:"controls-wrapper"},bl={class:"lines"},gl=he({__name:"LineCard",props:{line:{},searchers:{}},setup(e){const n=e,a=B(null),u=Re(),s=ga(),r=V(()=>ka.map(i=>({lineName:i,str:n.line[i],searcher:n.searchers.data[i]}))),v=V(()=>!n.searchers.areAllEmpty),c=V(()=>u.hash),o=V(()=>"#"+n.line.hash);function m(){Ee(a.value,"chosen")}j(c,(i,p)=>{!i&&p&&m()});async function g(){if(!v.value)return;const{volumeName:i,textNumber:p}=n.line;await s.push({query:{mode:ce.browse,volume:i,text:p}}),await ge({hash:o.value})}function S(){if(!u.hash){ge({hash:o.value});return}Na(u.hash),u.hash===o.value?s.replace({query:u.query,hash:""}):(ge({hash:o.value,keepLocation:!0}),s.replace({query:u.query,hash:o.value}));const i=Array.from(document.querySelectorAll('div.line-card[id^="h"]'));for(const p of i)p.style.background&&p.id!==n.line.hash&&Ee(p)}return(i,p)=>i.line?(A(),R("div",{key:0,class:"line-card",id:i.line.hash,ref_key:"lineCardRef",ref:a},[D("div",yl,[v.value?(A(),R("div",{key:1,class:"control-sign",onClick:g},"▤")):(A(),R("div",{key:0,class:"control-sign",onClick:S},"#"))]),D("div",bl,[(A(!0),R(U,null,Be(r.value,(_,b)=>(A(),me(Sa,M({ref_for:!0},_,{key:b,class:"mb-1"}),null,16))),128)),p[0]||(p[0]=D("div",null,[D("br")],-1))])],8,pl)):de("",!0)}}),kl=ie(gl,[["__scopeId","data-v-4e063ed8"]]),xl={class:"results"},Vl=he({__name:"Results",props:{results:{},searchers:{}},setup(e){const n=Re(),a=xa(),u=le(a,"isDark"),s=V(()=>!e.searchers.areAllEmpty);return ue(async()=>{var v;const r=n.hash;r&&(await Ba(1e3),(v=document.querySelector(r))==null||v.scrollIntoView({behavior:"smooth",block:"center"}))}),(r,v)=>(A(),R("div",xl,[s.value?(A(),R("div",{key:0,class:De(["results-stats",{invert:u.value}])},[D("div",null,"Found "+ft(r.results.length)+" contexts",1),v[0]||(v[0]=D("div",null,[D("br")],-1))],2)):de("",!0),D("div",null,[r.results?(A(),me(Da,{key:0,items:r.results},{default:Ve(({items:c})=>[(A(!0),R(U,null,Be(c,o=>(A(),R(U,null,[o?(A(),me(kl,{line:o,searchers:r.searchers,key:o.hash},null,8,["line","searchers"])):de("",!0)],64))),256))]),_:1},8,["items"])):de("",!0)])]))}}),wl=ie(Vl,[["__scopeId","data-v-ad9959c5"]]),Sl={key:0,class:"searcher-wrapper"},Tl=he({__name:"BrowseAndSearch",setup(e){const n=Re(),a=Ma(),u={get chosen(){return{volume:null,text:null}},get searchers(){return new Ye({textus:"",versio:""})}},s=B(!1),r=B(u.searchers),v=B({volume:null,text:null});let c=null;const o=Va(),m=V(()=>{if(!v.value.text||!a.corpusArray.length)return[];const b=oe.find(a.corpusArray,{volumeName:v.value.volume});return oe.find(b.texts,{textNumber:v.value.text}).contents}),g=V(()=>a.corpusLines),S=V(()=>r.value.areAllEmpty?[]:g.value.filter(r.value.test)),i=V(()=>o.mode===ce.browse?m.value:S.value);ue(()=>{c=setInterval(()=>{var t;s.value=!!((t=getSelection())!=null&&t.toString())},100);const b=n.hash;b&&ge({hash:b})}),it(()=>{clearInterval(c)});function p(b){r.value=new Ye(b)}function _(b){v.value=b}return(b,t)=>(A(),R("div",{class:De([{"no-hashes":s.value},"browse-and-search"])},[z(o).mode===z(ce).search?(A(),R("div",Sl,[d(Ra,{count:i.value.length},null,8,["count"]),d(hl,{"corpus-arr-prop":z(a).corpusArray,"textus-label":"Aramaic text","versio-label":"Translation text",onSearchers:p},null,8,["corpus-arr-prop"])])):z(o).mode===z(ce).browse?(A(),me(ol,{key:1,"corpus-arr":z(a).corpusArray,onChosen:_},null,8,["corpus-arr"])):de("",!0),d(wl,{results:i.value,searchers:z(o).mode===z(ce).search?r.value:u.searchers},null,8,["results","searchers"])],2))}}),$l=ie(Tl,[["__scopeId","data-v-6d7b0f41"]]);export{$l as B};
