import{c as f,b as K,Z as T,m as S,r as k,o as c,f as h,g as p,h as _,P as J,n as g,_ as L,bL as P,J as B,d as j,a as M,W as A,e as F,a$ as G,a7 as O,j as N,V as U,F as H,as as q,t as E,s as W,v as $,i as Q,k as C,p as x,bM as Z,at as X}from"./index-BVHvwaXp.js";import{c as Y,u as ee,L as w,K as D,G as te}from"./GrepLine-B49Epsxq.js";import{C as I}from"./Color-l8zxla4Y.js";import{V as se}from"./VTooltip-BElzl_7B.js";import{u as ae}from"./index-Cgj0OcN5.js";import{u as re,A as z}from"./assetsStore-CQJ6xnBv.js";import{V as oe}from"./VTextField-XyHLQRHF.js";import{V as ne}from"./VDialog-DJtaxoxC.js";import{u as le}from"./bookStore-Dqtomnmn.js";import{_ as ie}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-1C4ngQRE.js";const ue=()=>{const o=ae("search",""),n=f(()=>new Y(o.value));return{searcherString:o,searcher:n}},ce=["fill"],de=K({__name:"KeyboardIcon",props:{tooltip:{type:String,default:"Click to open a virtual keyboard"}},emits:["click"],setup(o,{emit:n}){T(m=>({"184ed29d":S(s),"8dc10230":S(u)}));const i=o,a=n,l=k(!0),d=f(()=>!i.tooltip||!l.value),{darkGrey:s,lightBrown:u}=I;return(m,e)=>(c(),h("span",{onClick:e[0]||(e[0]=t=>a("click"))},[p(se,{disabled:d.value,text:o.tooltip,location:"bottom","open-delay":"500"},{activator:_(({props:t})=>[(c(),h("svg",J(t,{fill:S(I).grey,class:"keyboard-icon-svg",viewBox:"6 5 12 14",xmlns:"http://www.w3.org/2000/svg"}),e[1]||(e[1]=[g("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"},null,-1)]),16,ce))]),_:1},8,["disabled","text"])]))}}),me=L(de,[["__scopeId","data-v-3d83a20e"]]),ve=P(function(n){return n?n.split(`======
`).map(l=>l.split(`
`)).map(l=>({title:B.head(l),lines:B.tail(l)})):[]}),pe=j("simpleCorpusStore",()=>{const o=re(),n=M({}),i=M({}),a=ee(),l=f(()=>{switch(a.value){case w.turoyo:return z.turoyoCorpusJson;case w.urmi:return z.urmiCorpusJson;case w.maalula:default:return z.maalulaDictsJson}}),d=f(()=>o[l.value].data),s=ve(d),{searcherString:u,searcher:m}=ue(),e=f(()=>{const r=[];if(!s.value)return r;for(const b of s.value){const{title:v,lines:y}=b;for(const V of y)r.push({title:v,line:V})}return r}),t=f(()=>u.value?e.value.reduce((r,b)=>{const y=m.value.regex.test(b.line)?[b]:[];return[...r,...y]},[]):[]);return{corporaObj:n,searcherStringsObj:i,searcher:m,searcherString:u,matchingLines:t}}),he={class:"searcher"},fe={class:"searchers"},ge={class:"text-field"},be=K({__name:"Searcher",setup(o){const n=pe(),i=k(""),a=k(!1),l=k(null),d=[e=>!!e||"Search string should not be empty"],s=f({get:()=>i.value,set:e=>{i.value=B.isString(e)?e:"",i.value||u()}}),u=()=>{A(()=>{n.searcherString=s.value})},m=e=>{s.value=e,a.value&&u()};return F(()=>n.searcherString,e=>{i.value=e},{immediate:!0}),G(()=>{l.value=document.querySelector(".text-field .v-text-field input")}),(e,t)=>(c(),h(H,null,[g("div",he,[g("div",fe,[g("div",ge,[p(oe,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=r=>s.value=r),rules:d,autocomplete:"off",label:"Search string",color:"primary",variant:"outlined",density:"compact",clearable:"","hide-details":"",onKeyup:O(u,["enter"])},null,8,["modelValue"])]),p(D,{value:s.value,"input-el":l.value,type:"regex",class:"regex",visible:"",onSubmit:m},null,8,["value","input-el"]),p(U,{ref:"search_btn",disabled:!s.value,variant:"outlined",class:"button",onClick:u},{default:_(()=>t[4]||(t[4]=[N(" Search ")])),_:1},8,["disabled"]),p(me,{class:"icon",onClick:t[1]||(t[1]=r=>a.value=!0)})])]),p(ne,{modelValue:a.value,"onUpdate:modelValue":t[3]||(t[3]=r=>a.value=r),"hide-overlay":"",fullscreen:""},{default:_(()=>[p(D,{visible:a.value,value:s.value,"input-name":"Search string",onSubmit:m,"onUpdate:visible":t[2]||(t[2]=r=>a.value=r)},null,8,["visible","value"])]),_:1},8,["modelValue"])],64))}}),Ne=L(be,[["__scopeId","data-v-51e00605"]]),ye={key:0,class:"entry-title"},_e={class:"entry-content"},Se={class:"entry-header"},ke={key:1,class:"page-badge"},Ve={class:"entry-text"},Ce=K({__name:"SearchResults",props:{linesMatching:{},searcher:{},translationLanguage:{},dictKey:{}},setup(o){const n=q(),i=E(n,"isDark"),a=le(),l=window,d=f(()=>!o.dictKey||!a.books?null:a.books.find(e=>e.key===o.dictKey)||null);function s(e){const t=e.match(/^{стр\.\s*(\d+)}/);return t?t[1]:null}function u(e){return e.replace(/^{стр\.\s*\d+}\s*/,"")}function m(e){if(!e||!d.value)return{};const t=d.value;return{name:Z.Book,params:{hash:t.hash},query:{page:e}}}return(e,t)=>{const r=W("router-link");return c(),h("div",{class:X({invert:i.value})},[e.linesMatching?(c(),$(ie,{key:0,items:e.linesMatching,el:S(l),class:"search-results-box results"},{default:_(({items:b})=>[(c(!0),h(H,null,Q(b,({line:v,title:y,translationLanguage:V},R)=>(c(),h("div",{key:R,class:"entry-item"},[y?(c(),h("div",ye,C(y),1)):x("",!0),g("div",_e,[g("div",Se,[s(v)&&d.value?(c(),$(r,{key:0,to:m(s(v)),target:"_blank",class:"page-badge page-badge-link"},{default:_(()=>[N(C(s(v)),1)]),_:2},1032,["to"])):s(v)?(c(),h("div",ke,C(s(v)),1)):x("",!0)]),g("div",Ve,[p(te,{str:u(v),searcher:e.searcher,"translation-language":V||o.translationLanguage},null,8,["str","searcher","translation-language"])])])]))),128))]),_:1},8,["items","el"])):x("",!0)],2)}}}),He=L(Ce,[["__scopeId","data-v-34d16608"]]);export{Ne as S,He as a,pe as b,ue as u};
