import{c as f,b as K,T,m as S,r as k,o as c,f as h,g as p,h as _,I as j,n as g,_ as L,c3 as F,y as B,d as G,a1 as J,a as M,a2 as x,Q as O,e as P,at as U,a4 as q,j as N,V as A,F as H,bn as E,t as Q,s as W,v as $,i as X,k as C,p as w,c4 as Y,ax as Z}from"./index-DZd0l_Ui.js";import{c as ee,u as te,L as z,K as I,G as se}from"./GrepLine-BDHgiBtL.js";import{C as D}from"./Color-l8zxla4Y.js";import{V as ae}from"./VTooltip-tmw4KwoE.js";import{u as re}from"./index-B4tkWkfU.js";import{V as oe}from"./VTextField-sUGCQIyH.js";import{V as ne}from"./VDialog-dnyAfGlT.js";import{u as le}from"./bookStore-c7rDblmA.js";import{_ as ie}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-C3FW6FFF.js";const ue=()=>{const o=re("search",""),n=f(()=>new ee(o.value));return{searcherString:o,searcher:n}},ce=["fill"],de=K({__name:"KeyboardIcon",props:{tooltip:{type:String,default:"Click to open a virtual keyboard"}},emits:["click"],setup(o,{emit:n}){T(m=>({"184ed29d":S(s),"8dc10230":S(u)}));const i=o,a=n,l=k(!0),d=f(()=>!i.tooltip||!l.value),{darkGrey:s,lightBrown:u}=D;return(m,e)=>(c(),h("span",{onClick:e[0]||(e[0]=t=>a("click"))},[p(ae,{disabled:d.value,text:o.tooltip,location:"bottom","open-delay":"500"},{activator:_(({props:t})=>[(c(),h("svg",j(t,{fill:S(D).grey,class:"keyboard-icon-svg",viewBox:"6 5 12 14",xmlns:"http://www.w3.org/2000/svg"}),e[1]||(e[1]=[g("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"},null,-1)]),16,ce))]),_:1},8,["disabled","text"])]))}}),me=L(de,[["__scopeId","data-v-3d83a20e"]]),ve=F(function(n){return n?n.split(`======
`).map(l=>l.split(`
`)).map(l=>({title:B.head(l),lines:B.tail(l)})):[]}),pe=G("simpleCorpusStore",()=>{const o=J(),n=M({}),i=M({}),a=te(),l=f(()=>{switch(a.value){case z.turoyo:return x.turoyoCorpusJson;case z.urmi:return x.urmiCorpusJson;case z.maalula:default:return x.maalulaDictsJson}}),d=f(()=>o[l.value].data),s=ve(d),{searcherString:u,searcher:m}=ue(),e=f(()=>{const r=[];if(!s.value)return r;for(const y of s.value){const{title:v,lines:b}=y;for(const V of b)r.push({title:v,line:V})}return r}),t=f(()=>u.value?e.value.reduce((r,y)=>{const b=m.value.regex.test(y.line)?[y]:[];return[...r,...b]},[]):[]);return{corporaObj:n,searcherStringsObj:i,searcher:m,searcherString:u,matchingLines:t}}),he={class:"searcher"},fe={class:"searchers"},ge={class:"text-field"},ye=K({__name:"Searcher",setup(o){const n=pe(),i=k(""),a=k(!1),l=k(null),d=[e=>!!e||"Search string should not be empty"],s=f({get:()=>i.value,set:e=>{i.value=B.isString(e)?e:"",i.value||u()}}),u=()=>{O(()=>{n.searcherString=s.value})},m=e=>{s.value=e,a.value&&u()};return P(()=>n.searcherString,e=>{i.value=e},{immediate:!0}),U(()=>{l.value=document.querySelector(".text-field .v-text-field input")}),(e,t)=>(c(),h(H,null,[g("div",he,[g("div",fe,[g("div",ge,[p(oe,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=r=>s.value=r),rules:d,autocomplete:"off",label:"Search string",color:"primary",variant:"outlined",density:"compact",clearable:"","hide-details":"",onKeyup:q(u,["enter"])},null,8,["modelValue"])]),p(I,{value:s.value,"input-el":l.value,type:"regex",class:"regex",visible:"",onSubmit:m},null,8,["value","input-el"]),p(A,{ref:"search_btn",disabled:!s.value,variant:"outlined",class:"button",onClick:u},{default:_(()=>t[4]||(t[4]=[N(" Search ")])),_:1},8,["disabled"]),p(me,{class:"icon",onClick:t[1]||(t[1]=r=>a.value=!0)})])]),p(ne,{modelValue:a.value,"onUpdate:modelValue":t[3]||(t[3]=r=>a.value=r),"hide-overlay":"",fullscreen:""},{default:_(()=>[p(I,{visible:a.value,value:s.value,"input-name":"Search string",onSubmit:m,"onUpdate:visible":t[2]||(t[2]=r=>a.value=r)},null,8,["visible","value"])]),_:1},8,["modelValue"])],64))}}),De=L(ye,[["__scopeId","data-v-51e00605"]]),be={key:0,class:"entry-title"},_e={class:"entry-content"},Se={class:"entry-header"},ke={key:1,class:"page-badge"},Ve={class:"entry-text"},xe=K({__name:"SearchResults",props:{linesMatching:{},searcher:{},translationLanguage:{},dictKey:{}},setup(o){const n=E(),i=Q(n,"isDark"),a=le(),l=window,d=f(()=>!o.dictKey||!a.books?null:a.books.find(e=>e.key===o.dictKey)||null);function s(e){const t=e.match(/^{стр\.\s*(\d+)}/);return t?t[1]:null}function u(e){return e.replace(/^{стр\.\s*\d+}\s*/,"")}function m(e){if(!e||!d.value)return{};const t=d.value;return{name:Y.Book,params:{hash:t.hash},query:{page:e}}}return(e,t)=>{const r=W("router-link");return c(),h("div",{class:Z({invert:i.value})},[e.linesMatching?(c(),$(ie,{key:0,items:e.linesMatching,el:S(l),class:"search-results-box results"},{default:_(({items:y})=>[(c(!0),h(H,null,X(y,({line:v,title:b,translationLanguage:V},R)=>(c(),h("div",{key:R,class:"entry-item"},[b?(c(),h("div",be,C(b),1)):w("",!0),g("div",_e,[g("div",Se,[s(v)&&d.value?(c(),$(r,{key:0,to:m(s(v)),target:"_blank",class:"page-badge page-badge-link"},{default:_(()=>[N(C(s(v)),1)]),_:2},1032,["to"])):s(v)?(c(),h("div",ke,C(s(v)),1)):w("",!0)]),g("div",Ve,[p(se,{str:u(v),searcher:e.searcher,"translation-language":V||o.translationLanguage},null,8,["str","searcher","translation-language"])])])]))),128))]),_:1},8,["items","el"])):w("",!0)],2)}}}),Ne=L(xe,[["__scopeId","data-v-34d16608"]]);export{De as S,Ne as a,pe as b,ue as u};
