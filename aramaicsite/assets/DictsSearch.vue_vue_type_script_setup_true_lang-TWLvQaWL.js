var F=Object.defineProperty;var J=(t,e,s)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var u=(t,e,s)=>J(t,typeof e!="symbol"?e+"":e,s);import{d as O,a as E,c as g,w as $,b as M,e as P,o as r,f,F as y,n as b,D as p,h as S,p as _,l as N,V as w,m as v,_ as T,bl as z,g as x,i as h,bF as B,k as G}from"./index-C2jqICQq.js";import{a as L}from"./assets-B5EdzI92.js";import{L as K,u as I}from"./GrepLine.vue_vue_type_style_index_0_lang-DiPn0gdf.js";import{u as Q}from"./index-CGfIlLV6.js";import{u as X,S as q,a as H}from"./SearchResults-BSzzi0gz.js";import{u as U}from"./useGetResource-BhU8jnfu.js";const R=O("componentMountStore",()=>{const t=E(new Set);function e(o){t.add(o)}function s(o){t.delete(o)}return{components:t,mount:e,unmount:s}});var k=(t=>(t.BrowseAndSearch="BrowseAndSearch",t.DictsSearch="DictsSearch",t))(k||{});const V={[K.turoyo]:{link:L.turoyoDictsJson.link,dicts:[{key:"ritter",title:"Ritter",isChosen:!0},{key:"jastrow",title:"Jastrow",isChosen:!1},{key:"jan",title:"XÃ«zne",isChosen:!1}]},[K.maalula]:{link:L.maalulaDictsJson.link,dicts:[{key:"arnold",title:"Arnold",isChosen:!0}]}},W=O("simpleDictStore",()=>{const t=R(),e=I(),s=g(()=>{var i;return(i=V[e.value])==null?void 0:i.link}),o=U(s,{}),c=Q("dict",[]),{searcher:n,searcherString:l}=X(),a=g(()=>{var i;return((i=V[e.value])==null?void 0:i.dicts)||[]});$(()=>{t.components.has(k.DictsSearch)&&!c.value.length&&(c.value=a.value.filter(({isChosen:i})=>i).map(({key:i})=>i))});const m=g(()=>l.value?a.value.map(({key:i,title:d})=>{const j=C(i).filter(D=>n.value.regex.test(D)).map(D=>({title:"",line:D}));return{key:i,title:d,lines:j}}):[]);function C(i){var d;return((d=o.value)==null?void 0:d[i])||[]}return{searcher:n,initialDicts:a,dictData:o,searcherString:l,chosenDictionaries:c,matchingDictLinesArr:m}});class A{constructor({key:e,title:s,isChosen:o}){u(this,"key");u(this,"title");u(this,"isChosen");this.key=e,this.title=s,this.isChosen=o}toggle(){this.isChosen=!this.isChosen}choose(){this.isChosen=!0}unchoose(){this.isChosen=!1}static instantiate(e){return new A(e)}}class Y{constructor(e){u(this,"data");this.data=e.map(A.instantiate)}optionByKey(e){return this.data.find(s=>s.key===e)}toggle(e){var s;(s=this.optionByKey(e))==null||s.toggle()}chooseAll(){this.data.forEach(e=>e.choose())}unchooseAll(){this.data.forEach(e=>e.unchoose())}toggleAll(){this.areAllChosen?this.unchooseAll():this.chooseAll()}chooseKeys(e){this.unchooseAll(),this.data.forEach(s=>e!=null&&e.includes(s.key)?s.choose():s.unchoose())}get chosenKeys(){return this.data.filter(({isChosen:e})=>e).map(({key:e})=>e)}get areAllChosen(){return this.data.every(e=>e.isChosen)}}const Z={class:"container d-flex justify-center"},ee=M({__name:"OptionsChooser",props:{optionsProp:{},hasAll:{type:Boolean},chosenOptions:{}},emits:["chosen-options"],setup(t,{emit:e}){const s=e,o=E(new Y(t.optionsProp));P(()=>t.chosenOptions,n=>o.chooseKeys(n),{immediate:!0});const c=n=>{n?o.toggle(n):o.toggleAll(),s("chosen-options",o.chosenKeys)};return(n,l)=>(r(),f("div",Z,[(r(!0),f(y,null,b(o.data,({title:a,key:m,isChosen:C})=>(r(),p(w,{key:m,variant:C?"outlined":"text",onClick:i=>c(m)},{default:S(()=>[_(N(a),1)]),_:2},1032,["variant","onClick"]))),128)),n.hasAll?(r(),p(w,{key:0,variant:o.areAllChosen?"outlined":"text"+n.foo,onClick:l[0]||(l[0]=a=>c())},{default:S(()=>l[1]||(l[1]=[_(" All ")])),_:1},8,["variant"])):v("",!0)]))}}),te=T(ee,[["__scopeId","data-v-50fe08bd"]]),se=t=>{const e=R();e.mount(t),z(()=>{e.unmount(t)})},he=M({__name:"DictsSearch",setup(t){const e=W();se(k.DictsSearch);const s=g(()=>e.matchingDictLinesArr.filter(({key:n})=>e.chosenDictionaries.includes(n)));function o(n){e.searcherString=n}function c(n){e.chosenDictionaries=n}return(n,l)=>(r(),f(y,null,[x(B,{class:"searcher-wrapper"},{default:S(()=>[x(q,{"searcher-string":h(e).searcherString,"corpus-name":n.corpusName,onSearcherString:o},null,8,["searcher-string","corpus-name"])]),_:1}),h(e).initialDicts.length>1?(r(),p(te,{key:0,"options-prop":h(e).initialDicts,"chosen-options":h(e).chosenDictionaries,"has-all":"",onChosenOptions:c},null,8,["options-prop","chosen-options"])):v("",!0),(r(!0),f(y,null,b(s.value,a=>(r(),p(B,{key:a.key},{default:S(()=>[G("h1",null,N(a.title),1),a.lines.length?(r(),p(H,{key:0,"lines-matching":a.lines,searcher:h(e).searcher},null,8,["lines-matching","searcher"])):v("",!0)]),_:2},1024))),128))],64))}});export{he as _};
