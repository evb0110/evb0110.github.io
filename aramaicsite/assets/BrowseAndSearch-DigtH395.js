var xt=Object.defineProperty;var Vt=(e,s,a)=>s in e?xt(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a;var q=(e,s,a)=>Vt(e,typeof s!="symbol"?s+"":s,a);import{b7 as wt,d as St,c as V,b8 as Tt,q as Z,b9 as Ct,s as we,au as _t,Q as lt,S as nt,aP as st,v as ue,T as ot,X as At,ae as It,t as le,x as me,g as d,O as M,ak as ye,ba as $e,aK as Pt,aa as Et,aq as Lt,a3 as Bt,ar as Dt,aO as Rt,bb as Nt,am as qt,W as ut,aQ as Mt,aR as Ot,ab as Ft,as as $t,at as Ht,bc as Ut,a2 as ge,a4 as Kt,aU as zt,$ as He,a0 as Gt,aW as Wt,bd as jt,ap as ne,ao as se,a6 as Qt,F as U,aJ as Ie,L as rt,ad as Xt,U as Jt,ah as Yt,r as B,a1 as Zt,Y as W,Z as ea,be as ta,b3 as it,bf as aa,a9 as Le,bg as Ue,e as j,ax as de,bh as la,bi as Ce,bj as ct,bk as na,w as Ke,bl as dt,b6 as _e,bm as sa,al as oa,bn as ua,an as ra,bo as ia,a8 as pe,aX as oe,bp as ca,bq as da,br as va,bs as ma,bt as ze,bu as fa,p as vt,bv as ha,bw as Ge,bx as We,b as fe,aB as ke,by as mt,o as A,f as R,k as D,i as z,j as je,h as xe,l as ft,_ as re,E as Ve,V as pa,n as Be,D as ve,ag as De,B as ya,aD as ba,bz as Re,A as ga,m as ce,bA as ka,bB as ie,G as xa,bC as Va}from"./index-Dk0unzr7.js";import{L as Qe,u as wa,K as Xe,_ as Sa,S as Je}from"./GrepLine.vue_vue_type_style_index_0_lang-BahjyBcu.js";import{a as Ta}from"./axios-CCb-kr4I.js";import{a as Ye}from"./assets-MsLU388D.js";import{m as Ca,V as Pe}from"./VTextField-B-GkrlCn.js";import{h as _a}from"./VInput-DxZPmAbk.js";import{f as ht}from"./forwardRefs-DWGaNmQL.js";import{a as pt,V as Aa}from"./VDialog-DNEGB6y1.js";import{m as Ia,V as Ze,a as et,g as Pa}from"./VOverlay-yrfdSyMw.js";import{V as Ea}from"./VCheckboxBtn-DNuih_uM.js";import{m as La,V as tt}from"./VSlideGroup-H0_cM4xC.js";import{s as Ba}from"./sleep-mAKpSMLY.js";import{_ as Da}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-COueMdv1.js";import{_ as Ra}from"./CopyResults.vue_vue_type_script_setup_true_lang-C6uviSDu.js";const yt=300;function be({hash:e="",keepLocation:s=!1,className:a="chosen"}){return new Promise(u=>{setTimeout(()=>{s||(location.hash=e,setTimeout(()=>scrollBy(0,-200),0));const n=document.querySelector(e);n&&(n.classList.add(a),setTimeout(u,1))},yt)})}function Na(e){const s=document.querySelector(e);s&&Ee(s)}function Ee(e,s="chosen"){e&&setTimeout(()=>{e.classList.remove(s)},yt)}class Ne{constructor({volume:s,texts:a}){q(this,"volumeName");q(this,"texts");this.texts=a.map(u=>({volumeName:s,...u})).map(qe.instantiate),this.volumeName=s}static instantiate(s){return new Ne(s)}}class qe{constructor({volumeName:s,textNumber:a,textName:u,contents:n}){q(this,"volumeName");q(this,"textNumber");q(this,"_textName");q(this,"rawContents");this.volumeName=s,this.textNumber=a,this._textName=u,this.rawContents=n}get contents(){return this.rawContents.map(s=>({volumeName:this.volumeName,textNumber:this.textNumber,textName:this.textName,...s})).map(Me.instantiate)}get textName(){return this._textName.replace(/\.txt/,"")}set textName(s){this._textName=s}static instantiate(s){return new qe(s)}}class Me{constructor({volumeName:s,textNumber:a,textName:u,lineNumber:n,textus:r,versio:v}){q(this,"volumeName");q(this,"textNumber");q(this,"textName");q(this,"lineNumber");q(this,"textus");q(this,"versio");this.volumeName=s,this.textNumber=a,this.textName=u,this.lineNumber=n,this.textus=r,this.versio=v}get title(){return this.volumeName+": "+this.textName}get hash(){return"h"+wt(this)}static instantiate(s){return new Me(s)}}const qa={[Qe.maalula]:{link:Ye.maalulaCorpusJson.link},[Qe.turoyo]:{link:Ye.turoyoNewCorpusJson.link}},Ma=St("corpusWithTranslationStore",()=>{const{language:e}=wa(),s=V(()=>qa[e.value].link),a=Tt(async()=>(await Ta.get(s.value)).data.map(Ne.instantiate),[]),u=V(()=>a.value.flatMap(n=>n.texts).flatMap(n=>n.contents));return{corpusArray:a,corpusLines:u}}),bt=Symbol.for("vuetify:v-chip-group"),Oa=Z({column:Boolean,filter:Boolean,valueComparator:{type:Function,default:Ct},...La(),...we(),..._t({selectedClass:"v-chip--selected"}),...lt(),...nt(),...st({variant:"tonal"})},"VChipGroup");ue()({name:"VChipGroup",props:Oa(),emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const{themeClasses:u}=ot(e),{isSelected:n,select:r,next:v,prev:c,selected:o}=At(e,bt);return It({VChip:{color:le(e,"color"),disabled:le(e,"disabled"),filter:le(e,"filter"),variant:le(e,"variant")}}),me(()=>{const m=tt.filterProps(e);return d(tt,M(m,{class:["v-chip-group",{"v-chip-group--column":e.column},u.value,e.class],style:e.style}),{default:()=>{var g;return[(g=a.default)==null?void 0:g.call(a,{isSelected:n,select:r,next:v,prev:c,selected:o.value})]}})}),{}}});const Fa=Z({activeClass:String,appendAvatar:String,appendIcon:ye,closable:Boolean,closeIcon:{type:ye,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:String,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:ye,ripple:{type:[Boolean,Object],default:!0},text:String,modelValue:{type:Boolean,default:!0},onClick:$e(),onClickOnce:$e(),...Pt(),...we(),...Et(),...Lt(),...Bt(),...Dt(),...Rt(),...Nt(),...lt({tag:"span"}),...nt(),...st({variant:"tonal"})},"VChip"),$a=ue()({name:"VChip",directives:{Ripple:qt},props:Fa(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,s){let{attrs:a,emit:u,slots:n}=s;const{t:r}=ut(),{borderClasses:v}=Mt(e),{colorClasses:c,colorStyles:o,variantClasses:m}=Ot(e),{densityClasses:g}=Ft(e),{elevationClasses:S}=$t(e),{roundedClasses:i}=Ht(e),{sizeClasses:p}=Ut(e),{themeClasses:_}=ot(e),b=ge(e,"modelValue"),t=Kt(e,bt,!1),h=zt(e,a),y=V(()=>e.link!==!1&&h.isLink.value),T=V(()=>!e.disabled&&e.link!==!1&&(!!t||e.link||h.isClickable.value)),w=V(()=>({"aria-label":r(e.closeLabel),onClick(k){k.preventDefault(),k.stopPropagation(),b.value=!1,u("click:close",k)}}));function E(k){var K;u("click",k),T.value&&((K=h.navigate)==null||K.call(h,k),t==null||t.toggle())}function F(k){(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),E(k))}return()=>{const k=h.isLink.value?"a":e.tag,K=!!(e.appendIcon||e.appendAvatar),Q=!!(K||n.append),G=!!(n.close||e.closable),X=!!(n.filter||e.filter)&&t,ee=!!(e.prependIcon||e.prependAvatar),J=!!(ee||n.prepend),te=!t||t.isSelected.value;return b.value&&He(d(k,M({class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":T.value,"v-chip--filter":X,"v-chip--pill":e.pill},_.value,v.value,te?c.value:void 0,g.value,S.value,i.value,p.value,m.value,t==null?void 0:t.selectedClass.value,e.class],style:[te?o.value:void 0,e.style],disabled:e.disabled||void 0,draggable:e.draggable,tabindex:T.value?0:void 0,onClick:E,onKeydown:T.value&&!y.value&&F},h.linkProps),{default:()=>{var O;return[Wt(T.value,"v-chip"),X&&d(jt,{key:"filter"},{default:()=>[He(d("div",{class:"v-chip__filter"},[n.filter?d(se,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},n.filter):d(ne,{key:"filter-icon",icon:e.filterIcon},null)]),[[Qt,t.isSelected.value]])]}),J&&d("div",{key:"prepend",class:"v-chip__prepend"},[n.prepend?d(se,{key:"prepend-defaults",disabled:!ee,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},n.prepend):d(U,null,[e.prependIcon&&d(ne,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&d(Ie,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),d("div",{class:"v-chip__content","data-no-activator":""},[((O=n.default)==null?void 0:O.call(n,{isSelected:t==null?void 0:t.isSelected.value,selectedClass:t==null?void 0:t.selectedClass.value,select:t==null?void 0:t.select,toggle:t==null?void 0:t.toggle,value:t==null?void 0:t.value.value,disabled:e.disabled}))??e.text]),Q&&d("div",{key:"append",class:"v-chip__append"},[n.append?d(se,{key:"append-defaults",disabled:!K,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},n.append):d(U,null,[e.appendIcon&&d(ne,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&d(Ie,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),G&&d("button",M({key:"close",class:"v-chip__close",type:"button","data-testid":"close-chip"},w.value),[n.close?d(se,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},n.close):d(ne,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[Gt("ripple"),T.value&&e.ripple,null]])}}}),Ha=Z({id:String,submenu:Boolean,...rt(Ia({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:pt}}),["absolute"])},"VMenu"),Ua=ue()({name:"VMenu",props:Ha(),emits:{"update:modelValue":e=>!0},setup(e,s){let{slots:a}=s;const u=ge(e,"modelValue"),{scopeId:n}=Xt(),{isRtl:r}=Jt(),v=Yt(),c=V(()=>e.id||`v-menu-${v}`),o=B(),m=Zt(Ze,null),g=W(new Set);ea(Ze,{register(){g.value.add(v)},unregister(){g.value.delete(v)},closeParents(t){setTimeout(()=>{var h;!g.value.size&&!e.persistent&&(t==null||(h=o.value)!=null&&h.contentEl&&!ta(t,o.value.contentEl))&&(u.value=!1,m==null||m.closeParents())},40)}}),it(()=>{m==null||m.unregister(),document.removeEventListener("focusin",S)}),aa(()=>u.value=!1);async function S(t){var T,w,E;const h=t.relatedTarget,y=t.target;await Le(),u.value&&h!==y&&((T=o.value)!=null&&T.contentEl)&&((w=o.value)!=null&&w.globalTop)&&![document,o.value.contentEl].includes(y)&&!o.value.contentEl.contains(y)&&((E=Ue(o.value.contentEl)[0])==null||E.focus())}j(u,t=>{t?(m==null||m.register(),de&&document.addEventListener("focusin",S,{once:!0})):(m==null||m.unregister(),de&&document.removeEventListener("focusin",S))},{immediate:!0});function i(t){m==null||m.closeParents(t)}function p(t){var h,y,T,w,E;if(!e.disabled)if(t.key==="Tab"||t.key==="Enter"&&!e.closeOnContentClick){if(t.key==="Enter"&&(t.target instanceof HTMLTextAreaElement||t.target instanceof HTMLInputElement&&t.target.closest("form")))return;t.key==="Enter"&&t.preventDefault(),la(Ue((h=o.value)==null?void 0:h.contentEl,!1),t.shiftKey?"prev":"next",k=>k.tabIndex>=0)||(u.value=!1,(T=(y=o.value)==null?void 0:y.activatorEl)==null||T.focus())}else e.submenu&&t.key===(r.value?"ArrowRight":"ArrowLeft")&&(u.value=!1,(E=(w=o.value)==null?void 0:w.activatorEl)==null||E.focus())}function _(t){var y;if(e.disabled)return;const h=(y=o.value)==null?void 0:y.contentEl;h&&u.value?t.key==="ArrowDown"?(t.preventDefault(),t.stopImmediatePropagation(),Ce(h,"next")):t.key==="ArrowUp"?(t.preventDefault(),t.stopImmediatePropagation(),Ce(h,"prev")):e.submenu&&(t.key===(r.value?"ArrowRight":"ArrowLeft")?u.value=!1:t.key===(r.value?"ArrowLeft":"ArrowRight")&&(t.preventDefault(),Ce(h,"first"))):(e.submenu?t.key===(r.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(t.key))&&(u.value=!0,t.preventDefault(),setTimeout(()=>setTimeout(()=>_(t))))}const b=V(()=>M({"aria-haspopup":"menu","aria-expanded":String(u.value),"aria-owns":c.value,onKeydown:_},e.activatorProps));return me(()=>{const t=et.filterProps(e);return d(et,M({ref:o,id:c.value,class:["v-menu",e.class],style:e.style},t,{modelValue:u.value,"onUpdate:modelValue":h=>u.value=h,absolute:!0,activatorProps:b.value,location:e.location??(e.submenu?"end":"bottom"),"onClick:outside":i,onKeydown:p},n),{activator:a.activator,default:function(){for(var h=arguments.length,y=new Array(h),T=0;T<h;T++)y[T]=arguments[T];return d(se,{root:"VMenu"},{default:()=>{var w;return[(w=a.default)==null?void 0:w.call(a,...y)]}})}})}),ht({id:c,ΨopenChildren:g},o)}}),Ka=Z({renderless:Boolean,...we()},"VVirtualScrollItem"),za=ue()({name:"VVirtualScrollItem",inheritAttrs:!1,props:Ka(),emits:{"update:height":e=>!0},setup(e,s){let{attrs:a,emit:u,slots:n}=s;const{resizeRef:r,contentRect:v}=ct(void 0,"border");j(()=>{var c;return(c=v.value)==null?void 0:c.height},c=>{c!=null&&u("update:height",c)}),me(()=>{var c,o;return e.renderless?d(U,null,[(c=n.default)==null?void 0:c.call(n,{itemRef:r})]):d("div",M({ref:r,class:["v-virtual-scroll__item",e.class],style:e.style},a),[(o=n.default)==null?void 0:o.call(n)])})}}),Ga=-1,Wa=1,Ae=100,ja=Z({itemHeight:{type:[Number,String],default:null},height:[Number,String]},"virtual");function Qa(e,s){const a=na(),u=W(0);Ke(()=>{u.value=parseFloat(e.itemHeight||0)});const n=W(0),r=W(Math.ceil((parseInt(e.height)||a.height.value)/(u.value||16))||1),v=W(0),c=W(0),o=B(),m=B();let g=0;const{resizeRef:S,contentRect:i}=ct();Ke(()=>{S.value=o.value});const p=V(()=>{var l;return o.value===document.documentElement?a.height.value:((l=i.value)==null?void 0:l.height)||parseInt(e.height)||0}),_=V(()=>!!(o.value&&m.value&&p.value&&u.value));let b=Array.from({length:s.value.length}),t=Array.from({length:s.value.length});const h=W(0);let y=-1;function T(l){return b[l]||u.value}const w=sa(()=>{const l=performance.now();t[0]=0;const f=s.value.length;for(let C=1;C<=f-1;C++)t[C]=(t[C-1]||0)+T(C-1);h.value=Math.max(h.value,performance.now()-l)},h),E=j(_,l=>{l&&(E(),g=m.value.offsetTop,w.immediate(),O(),~y&&Le(()=>{de&&window.requestAnimationFrame(()=>{he(y),y=-1})}))});dt(()=>{w.clear()});function F(l,f){const C=b[l],I=u.value;u.value=I?Math.min(u.value,f):f,(C!==f||I!==u.value)&&(b[l]=f,w())}function k(l){return l=_e(l,0,s.value.length-1),t[l]||0}function K(l){return Xa(t,l)}let Q=0,G=0,X=0;j(p,(l,f)=>{f&&(O(),l<f&&requestAnimationFrame(()=>{G=0,O()}))});function ee(){if(!o.value||!m.value)return;const l=o.value.scrollTop,f=performance.now();f-X>500?(G=Math.sign(l-Q),g=m.value.offsetTop):G=l-Q,Q=l,X=f,O()}function J(){!o.value||!m.value||(G=0,X=0,O())}let te=-1;function O(){cancelAnimationFrame(te),te=requestAnimationFrame(Se)}function Se(){if(!o.value||!p.value)return;const l=Q-g,f=Math.sign(G),C=Math.max(0,l-Ae),I=_e(K(C),0,s.value.length),$=l+p.value+Ae,x=_e(K($)+1,I+1,s.value.length);if((f!==Ga||I<n.value)&&(f!==Wa||x>r.value)){const P=k(n.value)-k(I),L=k(x)-k(r.value);Math.max(P,L)>Ae?(n.value=I,r.value=x):(I<=0&&(n.value=I),x>=s.value.length&&(r.value=x))}v.value=k(n.value),c.value=k(s.value.length)-k(r.value)}function he(l){const f=k(l);!o.value||l&&!f?y=l:o.value.scrollTop=f}const Te=V(()=>s.value.slice(n.value,r.value).map((l,f)=>({raw:l,index:f+n.value})));return j(s,()=>{b=Array.from({length:s.value.length}),t=Array.from({length:s.value.length}),w.immediate(),O()},{deep:!0}),{calculateVisibleItems:O,containerRef:o,markerRef:m,computedItems:Te,paddingTop:v,paddingBottom:c,scrollToIndex:he,handleScroll:ee,handleScrollend:J,handleItemResize:F}}function Xa(e,s){let a=e.length-1,u=0,n=0,r=null,v=-1;if(e[a]<s)return a;for(;u<=a;)if(n=u+a>>1,r=e[n],r>s)a=n-1;else if(r<s)v=n,u=n+1;else return r===s?n:u;return v}const Ja=Z({items:{type:Array,default:()=>[]},renderless:Boolean,...ja(),...we(),...oa()},"VVirtualScroll"),Ya=ue()({name:"VVirtualScroll",props:Ja(),setup(e,s){let{slots:a}=s;const u=ua("VVirtualScroll"),{dimensionStyles:n}=ra(e),{calculateVisibleItems:r,containerRef:v,markerRef:c,handleScroll:o,handleScrollend:m,handleItemResize:g,scrollToIndex:S,paddingTop:i,paddingBottom:p,computedItems:_}=Qa(e,le(e,"items"));return ia(()=>e.renderless,()=>{function b(){var y,T;const h=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?"addEventListener":"removeEventListener";v.value===document.documentElement?(document[h]("scroll",o,{passive:!0}),document[h]("scrollend",m)):((y=v.value)==null||y[h]("scroll",o,{passive:!0}),(T=v.value)==null||T[h]("scrollend",m))}oe(()=>{v.value=Pa(u.vnode.el,!0),b(!0)}),dt(b)}),me(()=>{const b=_.value.map(t=>d(za,{key:t.index,renderless:e.renderless,"onUpdate:height":h=>g(t.index,h)},{default:h=>{var y;return(y=a.default)==null?void 0:y.call(a,{item:t.raw,index:t.index,...h})}}));return e.renderless?d(U,null,[d("div",{ref:c,class:"v-virtual-scroll__spacer",style:{paddingTop:pe(i.value)}},null),b,d("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:pe(p.value)}},null)]):d("div",{ref:v,class:["v-virtual-scroll",e.class],onScrollPassive:o,onScrollend:m,style:[n.value,e.style]},[d("div",{ref:c,class:"v-virtual-scroll__container",style:{paddingTop:pe(i.value),paddingBottom:pe(p.value)}},[b])])}),{calculateVisibleItems:r,scrollToIndex:S}}});function Za(e,s){const a=W(!1);let u;function n(c){cancelAnimationFrame(u),a.value=!0,u=requestAnimationFrame(()=>{u=requestAnimationFrame(()=>{a.value=!1})})}async function r(){await new Promise(c=>requestAnimationFrame(c)),await new Promise(c=>requestAnimationFrame(c)),await new Promise(c=>requestAnimationFrame(c)),await new Promise(c=>{if(a.value){const o=j(a,()=>{o(),c()})}else c()})}async function v(c){var g,S;if(c.key==="Tab"&&((g=s.value)==null||g.focus()),!["PageDown","PageUp","Home","End"].includes(c.key))return;const o=(S=e.value)==null?void 0:S.$el;if(!o)return;(c.key==="Home"||c.key==="End")&&o.scrollTo({top:c.key==="Home"?0:o.scrollHeight,behavior:"smooth"}),await r();const m=o.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(c.key==="PageDown"||c.key==="Home"){const i=o.getBoundingClientRect().top;for(const p of m)if(p.getBoundingClientRect().top>=i){p.focus();break}}else{const i=o.getBoundingClientRect().bottom;for(const p of[...m].reverse())if(p.getBoundingClientRect().bottom<=i){p.focus();break}}}return{onScrollPassive:n,onKeydown:v}}const el=Z({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:ye,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...ca({itemChildren:!1})},"Select"),tl=Z({...el(),...rt(Ca({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...da({transition:{component:pt}})},"VSelect"),at=ue()({name:"VSelect",props:tl(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,s){let{slots:a}=s;const{t:u}=ut(),n=B(),r=B(),v=B(),c=ge(e,"menu"),o=V({get:()=>c.value,set:l=>{var f;c.value&&!l&&((f=r.value)!=null&&f.ΨopenChildren.size)||(c.value=l)}}),{items:m,transformIn:g,transformOut:S}=va(e),i=ge(e,"modelValue",[],l=>g(l===null?[null]:ha(l)),l=>{const f=S(l);return e.multiple?f:f[0]??null}),p=V(()=>typeof e.counterValue=="function"?e.counterValue(i.value):typeof e.counterValue=="number"?e.counterValue:i.value.length),_=_a(),b=V(()=>i.value.map(l=>l.value)),t=W(!1),h=V(()=>o.value?e.closeText:e.openText);let y="",T;const w=V(()=>e.hideSelected?m.value.filter(l=>!i.value.some(f=>e.valueComparator(f,l))):m.value),E=V(()=>e.hideNoData&&!w.value.length||e.readonly||(_==null?void 0:_.isReadonly.value)),F=V(()=>{var l;return{...e.menuProps,activatorProps:{...((l=e.menuProps)==null?void 0:l.activatorProps)||{},"aria-haspopup":"listbox"}}}),k=B(),K=Za(k,n);function Q(l){e.openOnClear&&(o.value=!0)}function G(){E.value||(o.value=!o.value)}function X(l){Ge(l)&&ee(l)}function ee(l){var $,x;if(!l.key||e.readonly||_!=null&&_.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(l.key)&&l.preventDefault(),["Enter","ArrowDown"," "].includes(l.key)&&(o.value=!0),["Escape","Tab"].includes(l.key)&&(o.value=!1),l.key==="Home"?($=k.value)==null||$.focus("first"):l.key==="End"&&((x=k.value)==null||x.focus("last"));const f=1e3;if(e.multiple||!Ge(l))return;const C=performance.now();C-T>f&&(y=""),y+=l.key.toLowerCase(),T=C;const I=m.value.find(P=>P.title.toLowerCase().startsWith(y));if(I!==void 0){i.value=[I];const P=w.value.indexOf(I);de&&window.requestAnimationFrame(()=>{var L;P>=0&&((L=v.value)==null||L.scrollToIndex(P))})}}function J(l){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!l.props.disabled)if(e.multiple){const C=i.value.findIndex($=>e.valueComparator($.value,l.value)),I=f??!~C;if(~C){const $=I?[...i.value,l]:[...i.value];$.splice(C,1),i.value=$}else I&&(i.value=[...i.value,l])}else{const C=f!==!1;i.value=C?[l]:[],Le(()=>{o.value=!1})}}function te(l){var f;(f=k.value)!=null&&f.$el.contains(l.relatedTarget)||(o.value=!1)}function O(){var l;e.eager&&((l=v.value)==null||l.calculateVisibleItems())}function Se(){var l;t.value&&((l=n.value)==null||l.focus())}function he(l){t.value=!0}function Te(l){if(l==null)i.value=[];else if(We(n.value,":autofill")||We(n.value,":-webkit-autofill")){const f=m.value.find(C=>C.title===l);f&&J(f)}else n.value&&(n.value.value="")}return j(o,()=>{if(!e.hideSelected&&o.value&&i.value.length){const l=w.value.findIndex(f=>i.value.some(C=>e.valueComparator(C.value,f.value)));de&&window.requestAnimationFrame(()=>{var f;l>=0&&((f=v.value)==null||f.scrollToIndex(l))})}}),j(()=>e.items,(l,f)=>{o.value||t.value&&!f.length&&l.length&&(o.value=!0)}),me(()=>{const l=!!(e.chips||a.chip),f=!!(!e.hideNoData||w.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),C=i.value.length>0,I=Pe.filterProps(e),$=C||!t.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return d(Pe,M({ref:n},I,{modelValue:i.value.map(x=>x.props.value).join(", "),"onUpdate:modelValue":Te,focused:t.value,"onUpdate:focused":x=>t.value=x,validationValue:i.externalValue,counterValue:p.value,dirty:C,class:["v-select",{"v-select--active-menu":o.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":i.value.length,"v-select--selection-slot":!!a.selection},e.class],style:e.style,inputmode:"none",placeholder:$,"onClick:clear":Q,"onMousedown:control":G,onBlur:te,onKeydown:ee,"aria-label":u(h.value),title:u(h.value)}),{...a,default:()=>d(U,null,[d(Ua,M({ref:r,modelValue:o.value,"onUpdate:modelValue":x=>o.value=x,activator:"parent",contentClass:"v-select__content",disabled:E.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:O,onAfterLeave:Se},F.value),{default:()=>[f&&d(ma,M({ref:k,selected:b.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:x=>x.preventDefault(),onKeydown:X,onFocusin:he,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},K,e.listProps),{default:()=>{var x,P,L;return[(x=a["prepend-item"])==null?void 0:x.call(a),!w.value.length&&!e.hideNoData&&(((P=a["no-data"])==null?void 0:P.call(a))??d(ze,{title:u(e.noDataText)},null)),d(Ya,{ref:v,renderless:!0,items:w.value},{default:Y=>{var Fe;let{item:H,index:ae,itemRef:N}=Y;const Oe=M(H.props,{ref:N,key:ae,onClick:()=>J(H,null)});return((Fe=a.item)==null?void 0:Fe.call(a,{item:H,index:ae,props:Oe}))??d(ze,M(Oe,{role:"option"}),{prepend:gt=>{let{isSelected:kt}=gt;return d(U,null,[e.multiple&&!e.hideSelected?d(Ea,{key:H.value,modelValue:kt,ripple:!1,tabindex:"-1"},null):void 0,H.props.prependAvatar&&d(Ie,{image:H.props.prependAvatar},null),H.props.prependIcon&&d(ne,{icon:H.props.prependIcon},null)])}})}}),(L=a["append-item"])==null?void 0:L.call(a)]}})]}),i.value.map((x,P)=>{function L(N){N.stopPropagation(),N.preventDefault(),J(x,!1)}const Y={"onClick:close":L,onKeydown(N){N.key!=="Enter"&&N.key!==" "||(N.preventDefault(),N.stopPropagation(),L(N))},onMousedown(N){N.preventDefault(),N.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},H=l?!!a.chip:!!a.selection,ae=H?fa(l?a.chip({item:x,index:P,props:Y}):a.selection({item:x,index:P})):void 0;if(!(H&&!ae))return d("div",{key:x.value,class:"v-select__selection"},[l?a.chip?d(se,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:x.title}}},{default:()=>[ae]}):d($a,M({key:"chip",closable:e.closableChips,size:"small",text:x.title,disabled:x.props.disabled},Y),null):ae??d("span",{class:"v-select__selection-text"},[x.title,e.multiple&&P<i.value.length-1&&d("span",{class:"v-select__selection-comma"},[vt(",")])])])})]),"append-inner":function(){var Y;for(var x=arguments.length,P=new Array(x),L=0;L<x;L++)P[L]=arguments[L];return d(U,null,[(Y=a["append-inner"])==null?void 0:Y.call(a,...P),e.menuIcon?d(ne,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),ht({isFocused:t,menu:o,select:J},n)}}),al={class:"browse-selects"},ll={class:"selects mt-5 mb-8"},nl={class:"no-data-placeholder"},sl=fe({__name:"Browse",props:{corpusArr:{default:()=>[]},volumeLabel:{default:"Volume"},textLabel:{default:"Text"}},emits:["chosen"],setup(e,{emit:s}){const a={get chosen(){return{volume:"",text:""}}},u=s,n=ke("volume"),r=ke("text");n.value&&g(),r.value&&m(),oe(m),mt(()=>{n.value=null,r.value=null});const v=V(()=>{if(n.value)return e.corpusArr.find(({volumeName:S})=>S===n.value)}),c=V(()=>v.value?v.value.texts:[]);function o(S,i){i==="volume"?(r.value=null,g()):m()}function m(){u("chosen",{volume:n.value,text:r.value})}function g(){u("chosen",a.chosen)}return(S,i)=>(A(),R("div",al,[D("div",ll,[d(at,{modelValue:z(n),"onUpdate:modelValue":[i[0]||(i[0]=p=>je(n)?n.value=p:null),i[1]||(i[1]=p=>o(p,"volume"))],items:S.corpusArr,label:S.volumeLabel,"item-title":"volumeName","item-value":"volumeName",variant:"outlined",density:"compact"},null,8,["modelValue","items","label"]),d(at,{modelValue:z(r),"onUpdate:modelValue":[i[2]||(i[2]=p=>je(r)?r.value=p:null),i[3]||(i[3]=p=>o(p,"text"))],items:c.value,label:S.textLabel,"item-title":"textName","item-value":"textNumber",variant:"outlined",density:"compact"},{"no-data":xe(()=>[i[4]||(i[4]=D("span",{class:"no-data-arrow"},"⬅",-1)),D("span",nl,ft(`A ${S.volumeLabel} should be chosen`),1)]),_:1},8,["modelValue","items","label"])])]))}}),ol=re(sl,[["__scopeId","data-v-69ac25b0"]]),ul={},rl={height:"3em",viewBox:"0 0 24 24",width:"3em",xmlns:"http://www.w3.org/2000/svg"};function il(e,s){return A(),R("svg",rl,s[0]||(s[0]=[D("path",{d:"M3 20q-.825 0-1.412-.587T1 18V6q0-.825.588-1.412T3 4h18q.825 0 1.413.588T23 6v12q0 .825-.587 1.413T21 20zm0-2h18V6H3zm6-1h6q.425 0 .713-.288T16 16t-.288-.712T15 15H9q-.425 0-.712.288T8 16t.288.713T9 17m-6 1V6zm3-8q.425 0 .713-.288T7 9t-.288-.712T6 8t-.712.288T5 9t.288.713T6 10m4 0q.425 0 .713-.288T11 9t-.288-.712T10 8t-.712.288T9 9t.288.713T10 10m4 0q.425 0 .713-.288T15 9t-.288-.712T14 8t-.712.288T13 9t.288.713T14 10m4 0q.425 0 .713-.288T19 9t-.288-.712T18 8t-.712.288T17 9t.288.713T18 10M6 13.5q.425 0 .713-.288T7 12.5t-.288-.712T6 11.5t-.712.288T5 12.5t.288.713T6 13.5m4 0q.425 0 .713-.288T11 12.5t-.288-.712T10 11.5t-.712.288T9 12.5t.288.713t.712.287m4 0q.425 0 .713-.288T15 12.5t-.288-.712T14 11.5t-.712.288T13 12.5t.288.713t.712.287m4 0q.425 0 .713-.288T19 12.5t-.288-.712T18 11.5t-.712.288T17 12.5t.288.713t.712.287",fill:"lightGrey"},null,-1)]))}const cl=re(ul,[["render",il],["__scopeId","data-v-c2634224"]]),dl={class:"d-flex align-center flex-column"},vl={class:"searchers"},ml={class:"d-flex ga-3"},fl=fe({__name:"Search",props:{textusLabel:{default:"Search corpus"},versioLabel:{default:"Search translation"}},emits:["searchers","copy-to-clipboard"],setup(e,{emit:s}){const a=e,u={get searchers(){return{textus:null,versio:null}}},n=s,r=B(u.searchers),v=B(u.searchers),c=B(!1),o=B(null),m=ke("textus"),g=ke("versio");r.value.textus=m.value,r.value.versio=g.value;const S=V(()=>!r.value.textus&&!r.value.versio),i=V(()=>[{name:"textus",value:r.value.textus,label:a.textusLabel},{name:"versio",value:r.value.versio,label:a.versioLabel}]);oe(b);function p(h,y){r.value[y]=h||"",h||b()}function _(h){r.value.textus=h,c.value&&b()}function b(){v.value=Ve.cloneDeep(r.value),n("searchers",Ve.cloneDeep(v.value)),t()}function t(){m.value=v.value.textus||null,g.value=v.value.versio||null}return oe(()=>{r.value.textus=m.value,r.value.versio=g.value,(r.value.textus||r.value.versio)&&b(),o.value=document.querySelector(".searchers .v-text-field.input_textus input")}),mt(()=>{m.value=null,g.value=null}),(h,y)=>{const T=cl;return A(),R("div",dl,[D("div",vl,[D("div",null,[D("div",ml,[d(T,{class:"keyboard-icon",onClick:y[0]||(y[0]=w=>c.value=!0)}),d(pa,{disabled:S.value,variant:"outlined",class:"search-btn",onClick:b},{default:xe(()=>y[3]||(y[3]=[vt(" Search ")])),_:1},8,["disabled"])]),d(Xe,{value:i.value[0].value,"input-el":o.value,type:"regex",visible:"",onSubmit:_},null,8,["value","input-el"])]),(A(!0),R(U,null,Be(i.value,({value:w,label:E,name:F})=>(A(),ve(Pe,{key:F,"model-value":w,label:E,class:De(`input_${F}`),style:{"min-width":"200px"},variant:"outlined",density:"compact","hide-details":"",clearable:"","onUpdate:modelValue":k=>p(k,F),onKeydown:ya(ba(b,["prevent"]),["enter"])},null,8,["model-value","label","class","onUpdate:modelValue","onKeydown"]))),128))]),d(Aa,{modelValue:c.value,"onUpdate:modelValue":y[2]||(y[2]=w=>c.value=w),"hide-overlay":"",fullscreen:""},{default:xe(()=>[d(Xe,{visible:c.value,value:r.value.textus,"input-name":e.textusLabel,"onUpdate:visible":y[1]||(y[1]=w=>c.value=w),onSubmit:_},null,8,["visible","value","input-name"])]),_:1},8,["modelValue"])])}}}),hl=re(fl,[["__scopeId","data-v-1f2e1014"]]),pl=["id"],yl={class:"controls-wrapper"},bl={class:"lines"},gl=fe({__name:"LineCard",props:{line:{},searchers:{}},setup(e){const s=e,a=B(null),u=Re(),n=ga(),r=V(()=>ka.map(i=>({lineName:i,str:s.line[i],searcher:s.searchers.data[i]}))),v=V(()=>!s.searchers.areAllEmpty),c=V(()=>u.hash),o=V(()=>"#"+s.line.hash);function m(){Ee(a.value,"chosen")}j(c,(i,p)=>{!i&&p&&m()});async function g(){if(!v.value)return;const{volumeName:i,textNumber:p}=s.line;await n.push({query:{mode:ie.browse,volume:i,text:p}}),await be({hash:o.value})}function S(){if(!u.hash){be({hash:o.value});return}Na(u.hash),u.hash===o.value?n.replace({query:u.query,hash:""}):(be({hash:o.value,keepLocation:!0}),n.replace({query:u.query,hash:o.value}));const i=Array.from(document.querySelectorAll('div.line-card[id^="h"]'));for(const p of i)p.style.background&&p.id!==s.line.hash&&Ee(p)}return(i,p)=>i.line?(A(),R("div",{key:0,class:"line-card",id:i.line.hash,ref_key:"lineCardRef",ref:a},[D("div",yl,[v.value?(A(),R("div",{key:1,class:"control-sign",onClick:g},"▤")):(A(),R("div",{key:0,class:"control-sign",onClick:S},"#"))]),D("div",bl,[(A(!0),R(U,null,Be(r.value,(_,b)=>(A(),ve(Sa,M({ref_for:!0},_,{key:b,class:"mb-1"}),null,16))),128)),p[0]||(p[0]=D("div",null,[D("br")],-1))])],8,pl)):ce("",!0)}}),kl=re(gl,[["__scopeId","data-v-4e063ed8"]]),xl={class:"results"},Vl=fe({__name:"Results",props:{results:{},searchers:{}},setup(e){const s=Re(),a=xa(),u=le(a,"isDark"),n=V(()=>!e.searchers.areAllEmpty);return oe(async()=>{var v;const r=s.hash;r&&(await Ba(1e3),(v=document.querySelector(r))==null||v.scrollIntoView({behavior:"smooth",block:"center"}))}),(r,v)=>(A(),R("div",xl,[n.value?(A(),R("div",{key:0,class:De(["results-stats",{invert:u.value}])},[D("div",null,"Found "+ft(r.results.length)+" contexts",1),v[0]||(v[0]=D("div",null,[D("br")],-1))],2)):ce("",!0),D("div",null,[r.results?(A(),ve(Da,{key:0,items:r.results},{default:xe(({items:c})=>[(A(!0),R(U,null,Be(c,o=>(A(),R(U,null,[o?(A(),ve(kl,{line:o,searchers:r.searchers,key:o.hash},null,8,["line","searchers"])):ce("",!0)],64))),256))]),_:1},8,["items"])):ce("",!0)])]))}}),wl=re(Vl,[["__scopeId","data-v-ad9959c5"]]),Sl={key:0,class:"searcher-wrapper"},Tl=fe({__name:"BrowseAndSearch",setup(e){const s=Re(),a=Ma(),u={get chosen(){return{volume:null,text:null}},get searchers(){return new Je({textus:"",versio:""})}},n=B(!1),r=B(u.searchers),v=B({volume:null,text:null});let c=null;const o=Va(),m=V(()=>{if(!v.value.text||!a.corpusArray.length)return[];const b=Ve.find(a.corpusArray,{volumeName:v.value.volume});return Ve.find(b.texts,{textNumber:v.value.text}).contents}),g=V(()=>a.corpusLines),S=V(()=>r.value.areAllEmpty?[]:g.value.filter(r.value.test)),i=V(()=>o.mode===ie.browse?m.value:S.value);oe(()=>{c=setInterval(()=>{var t;n.value=!!((t=getSelection())!=null&&t.toString())},100);const b=s.hash;b&&be({hash:b})}),it(()=>{clearInterval(c)});function p(b){r.value=new Je(b)}function _(b){v.value=b}return(b,t)=>(A(),R("div",{class:De([{"no-hashes":n.value},"browse-and-search"])},[z(o).mode===z(ie).search?(A(),R("div",Sl,[d(Ra,{count:i.value.length},null,8,["count"]),d(hl,{"corpus-arr-prop":z(a).corpusArray,"textus-label":"Aramaic text","versio-label":"Translation text",onSearchers:p},null,8,["corpus-arr-prop"])])):z(o).mode===z(ie).browse?(A(),ve(ol,{key:1,"corpus-arr":z(a).corpusArray,onChosen:_},null,8,["corpus-arr"])):ce("",!0),d(wl,{results:i.value,searchers:z(o).mode===z(ie).search?r.value:u.searchers},null,8,["results","searchers"])],2))}}),$l=re(Tl,[["__scopeId","data-v-6d7b0f41"]]);export{$l as B};
