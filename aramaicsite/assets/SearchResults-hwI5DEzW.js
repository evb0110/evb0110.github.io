import{c as f,b as B,Z as H,m as S,r as _,o as d,f as p,g as h,h as k,P as N,n as g,_ as K,bL as P,J as $,d as T,a as L,W as J,e as R,a$ as U,a7 as j,j as A,V as F,F as I,as as G,t as O,v as E,i as W,k as x,p as C,at as q}from"./index-Csr_zljy.js";import{c as Q,u as Z,L as w,K as M,G as X}from"./GrepLine-44qrT1mY.js";import{C as D}from"./Color-l8zxla4Y.js";import{V as Y}from"./VTooltip-CgRZZFev.js";import{u as ee}from"./index-SnO3sOPr.js";import{u as te,A as z}from"./assetsStore-Db5FTgp1.js";import{V as se}from"./VTextField--LXXOYJy.js";import{V as ae}from"./VDialog-CgBASezu.js";import{u as re}from"./bookStore-B5ecpCzN.js";import{_ as oe}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-B-Dgy-Vn.js";const ne=()=>{const o=ee("search",""),n=f(()=>new Q(o.value));return{searcherString:o,searcher:n}},le=["fill"],ie=B({__name:"KeyboardIcon",props:{tooltip:{type:String,default:"Click to open a virtual keyboard"}},emits:["click"],setup(o,{emit:n}){H(v=>({"184ed29d":S(s),"8dc10230":S(c)}));const i=o,a=n,l=_(!0),m=f(()=>!i.tooltip||!l.value),{darkGrey:s,lightBrown:c}=D;return(v,e)=>(d(),p("span",{onClick:e[0]||(e[0]=t=>a("click"))},[h(Y,{disabled:m.value,text:o.tooltip,location:"bottom","open-delay":"500"},{activator:k(({props:t})=>[(d(),p("svg",N(t,{fill:S(D).grey,class:"keyboard-icon-svg",viewBox:"6 5 12 14",xmlns:"http://www.w3.org/2000/svg"}),e[1]||(e[1]=[g("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"},null,-1)]),16,le))]),_:1},8,["disabled","text"])]))}}),ce=K(ie,[["__scopeId","data-v-3d83a20e"]]),ue=P(function(n){return n?n.split(`======
`).map(l=>l.split(`
`)).map(l=>({title:$.head(l),lines:$.tail(l)})):[]}),de=T("simpleCorpusStore",()=>{const o=te(),n=L({}),i=L({}),a=Z(),l=f(()=>{switch(a.value){case w.turoyo:return z.turoyoCorpusJson;case w.urmi:return z.urmiCorpusJson;case w.maalula:default:return z.maalulaDictsJson}}),m=f(()=>o[l.value].data),s=ue(m),{searcherString:c,searcher:v}=ne(),e=f(()=>{const r=[];if(!s.value)return r;for(const u of s.value){const{title:b,lines:y}=u;for(const V of y)r.push({title:b,line:V})}return r}),t=f(()=>c.value?e.value.reduce((r,u)=>{const y=v.value.regex.test(u.line)?[u]:[];return[...r,...y]},[]):[]);return{corporaObj:n,searcherStringsObj:i,searcher:v,searcherString:c,matchingLines:t}}),me={class:"searcher"},ve={class:"searchers"},pe={class:"text-field"},he=B({__name:"Searcher",setup(o){const n=de(),i=_(""),a=_(!1),l=_(null),m=[e=>!!e||"Search string should not be empty"],s=f({get:()=>i.value,set:e=>{i.value=$.isString(e)?e:"",i.value||c()}}),c=()=>{J(()=>{n.searcherString=s.value})},v=e=>{s.value=e,a.value&&c()};return R(()=>n.searcherString,e=>{i.value=e},{immediate:!0}),U(()=>{l.value=document.querySelector(".text-field .v-text-field input")}),(e,t)=>(d(),p(I,null,[g("div",me,[g("div",ve,[g("div",pe,[h(se,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=r=>s.value=r),rules:m,autocomplete:"off",label:"Search string",color:"primary",variant:"outlined",density:"compact",clearable:"","hide-details":"",onKeyup:j(c,["enter"])},null,8,["modelValue"])]),h(M,{value:s.value,"input-el":l.value,type:"regex",class:"regex",visible:"",onSubmit:v},null,8,["value","input-el"]),h(F,{ref:"search_btn",disabled:!s.value,variant:"outlined",class:"button",onClick:c},{default:k(()=>t[4]||(t[4]=[A(" Search ")])),_:1},8,["disabled"]),h(ce,{class:"icon",onClick:t[1]||(t[1]=r=>a.value=!0)})])]),h(ae,{modelValue:a.value,"onUpdate:modelValue":t[3]||(t[3]=r=>a.value=r),"hide-overlay":"",fullscreen:""},{default:k(()=>[h(M,{visible:a.value,value:s.value,"input-name":"Search string",onSubmit:v,"onUpdate:visible":t[2]||(t[2]=r=>a.value=r)},null,8,["visible","value"])]),_:1},8,["modelValue"])],64))}}),De=K(he,[["__scopeId","data-v-51e00605"]]),fe={key:0,class:"entry-title"},ge={class:"entry-content"},be={class:"entry-header"},ye=["href"],Se={key:1,class:"page-badge"},_e={class:"entry-text"},ke=B({__name:"SearchResults",props:{linesMatching:{},searcher:{},translationLanguage:{},dictKey:{}},setup(o){const n=G(),i=O(n,"isDark"),a=re(),l=window,m=f(()=>!o.dictKey||!a.books?null:a.books.find(e=>e.key===o.dictKey)||null);function s(e){const t=e.match(/^{стр\.\s*(\d+)}/);return t?t[1]:null}function c(e){return e.replace(/^{стр\.\s*\d+}\s*/,"")}function v(e){return!e||!m.value?"":`/library/book/${m.value.hash}?page=${e}`}return(e,t)=>(d(),p("div",{class:q({invert:i.value})},[e.linesMatching?(d(),E(oe,{key:0,items:e.linesMatching,el:S(l),class:"search-results-box results"},{default:k(({items:r})=>[(d(!0),p(I,null,W(r,({line:u,title:b,translationLanguage:y},V)=>(d(),p("div",{key:V,class:"entry-item"},[b?(d(),p("div",fe,x(b),1)):C("",!0),g("div",ge,[g("div",be,[s(u)&&m.value?(d(),p("a",{key:0,href:v(s(u)),target:"_blank",class:"page-badge page-badge-link"},x(s(u)),9,ye)):s(u)?(d(),p("div",Se,x(s(u)),1)):C("",!0)]),g("div",_e,[h(X,{str:c(u),searcher:e.searcher,"translation-language":y||o.translationLanguage},null,8,["str","searcher","translation-language"])])])]))),128))]),_:1},8,["items","el"])):C("",!0)],2))}}),Ie=K(ke,[["__scopeId","data-v-1ddc2821"]]);export{De as S,Ie as a,de as b,ne as u};
