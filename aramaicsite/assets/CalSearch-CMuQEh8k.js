import{d as A,c as u,E as m,b as L,a as E,o as _,f as x,n as p,g as h,m as f,h as k,j as F,V as U,_ as M,aH as N,F as $,i as I}from"./index-wqI0NW7N.js";import{u as S}from"./index-Dt2_Lpnx.js";import{g as J}from"./getRegexFilterFn-CU_0py8y.js";import{b as P}from"./betterSplit-CW8NIeFU.js";import{u as D,A as O}from"./assetsStore-Axe9xE9o.js";import{_ as Q}from"./InfiniteScrollOld.vue_vue_type_script_setup_true_lang-DLq3Af6d.js";import{V}from"./VTextField-CuU92ZC_.js";import"./VInput-CyzNd8LV.js";import"./forwardRefs-DWGaNmQL.js";function z(l,a,e="application/octet-stream"){const i=document.createElement("a"),n=new Blob([l],{type:e});i.href=URL.createObjectURL(n),i.download=a,i.click()}function v(l,a,e="",i=!1){const s=(e?`color: ${e};`:"")+(i?"font-weight: bold;":""),t=s?` style='${s}'`:"";return`<${a}${t}>${l}</${a}>`}function G(l){const a=l.map(e=>`(?:${e})`).join("|");return RegExp(a)}const y=v("<br>","div"),q=`=============
`,C=A("calStore",()=>{const l=D(),a=u(()=>{var o;return((o=l[O.calJson].data)==null?void 0:o.split(q).filter(Boolean).map(d=>d.split(`
`)).map(([d,...b])=>({entryName:d.replace(/\.txt$/,""),contents:b,contentsString:b.join(`
`)})))||[]}),e=S("positive",""),i=S("negative",""),n=S("highlight",""),r=u(()=>({positive:e.value,negative:i.value,highlight:n.value})),s=u(()=>m.mapValues(r.value,X)),t=u(()=>!s.value.positive.length&&!s.value.negative.length),c=u(()=>J(s.value.positive.map(o=>RegExp(o)),s.value.negative.map(o=>RegExp(o)))),g=u(()=>t.value?[]:a.value.filter(o=>c.value(o.contentsString))),T=u(()=>{const o=m.mapValues(s.value,d=>d.some(m.identity)&&d.join(", "));return[o.positive&&`Should contain: ${o.positive}`,o.negative&&`Should not contain: ${o.negative}`,o.highlight&&`Highlight: ${o.highlight}`].filter(Boolean).map(d=>v(d,"div","brown",!0))}),j=u(()=>{if(!g.value.length)return"";const o=[`Total: ${g.value.length} entries`].map(b=>v(b,"div","green",!0)),d=v("=".repeat(25),"div");return[...T.value,o,d].join(y)}),B=u(()=>m.values(s.value).flat()),R=u(()=>G(B.value)),w=u(()=>{if(!g.value.length)return[];const o=g.value.map(W(R.value));return[j.value,y,...o]}),H=u(()=>w.value.join(""));return{cal:a,positive:e,negative:i,highlight:n,searchers:r,searchObj:s,isNoSearch:t,calMatchingParts:w,calMatchingHTML:H}});function K(l){return function(a){const e=P(a,l).reduce((i,n,r)=>{const s=r%2?"red":"",t=r%2;return i+v(n,"span",s,t)},"");return v(e,"div")}}function W(l){return function({entryName:a,contents:e}){const i=v("+".repeat(25),"div","blue"),n=v(a,"div","purple",!0),r=e.map(K(l));return[n,...r,i,y].join("")}}function X(l){return m.chain(l).split(",").map(m.trim).compact().value()}const Y={class:"inputs"},Z={class:"input-block"},tt={class:"input-block"},et={class:"input-block"},nt=L({__name:"CalInputs",emits:["download"],setup(l,{emit:a}){const e=C(),i=a,n=E(e.searchers),r=m.debounce(()=>{m.assign(e,n)},1e3);return(s,t)=>(_(),x("div",Y,[p("div",Z,[t[4]||(t[4]=p("div",{class:"input-block__title"},"Should contain:   ",-1)),h(V,{modelValue:n.positive,"onUpdate:modelValue":[t[0]||(t[0]=c=>n.positive=c),f(r)],variant:"outlined",density:"compact",autocomplete:"no","min-width":"200px","max-width":"350px",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),t[5]||(t[5]=p("div",{class:"input-block__hint"},"e.g. Gal, Sam, CPA ",-1))]),p("div",tt,[t[6]||(t[6]=p("div",{class:"input-block__title"},"Should not contain:   ",-1)),h(V,{modelValue:n.negative,"onUpdate:modelValue":[t[1]||(t[1]=c=>n.negative=c),f(r)],variant:"outlined",density:"compact",autocomplete:"no","min-width":"200px","max-width":"350px",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),t[7]||(t[7]=p("div",{class:"input-block__hint"},"e.g. Syr, JBA, Man, Com",-1))]),p("div",et,[t[8]||(t[8]=p("div",{class:"input-block__title"},"Also highlight:   ",-1)),h(V,{modelValue:n.highlight,"onUpdate:modelValue":[t[2]||(t[2]=c=>n.highlight=c),f(r)],variant:"outlined",density:"compact",autocomplete:"no","min-width":"200px","max-width":"350px",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),t[9]||(t[9]=p("div",{class:"input-block__hint"},"e.g. LJLA, Qumran, Jud",-1))]),h(U,{disabled:f(e).isNoSearch,color:"green",variant:"outlined",class:"button",size:"large",onClick:t[3]||(t[3]=c=>i("download"))},{default:k(()=>t[10]||(t[10]=[F(" Download ")])),_:1},8,["disabled"])]))}}),ot=M(nt,[["__scopeId","data-v-1e9e3214"]]),at=["innerHTML"],it=L({__name:"CalSearch",setup(l){const a=C(),{calMatchingParts:e,calMatchingHTML:i}=N(a),n=()=>{z(i.value,"result.html")};return(r,s)=>(_(),x($,null,[h(ot,{onDownload:n}),h(Q,{items:f(e),class:"search-results-box"},{default:k(({items:t})=>[(_(!0),x($,null,I(t,(c,g)=>(_(),x("div",{key:g},[p("div",{innerHTML:c},null,8,at)]))),128))]),_:1},8,["items"])],64))}}),gt=M(it,[["__scopeId","data-v-e1d8d18b"]]);export{gt as default};
