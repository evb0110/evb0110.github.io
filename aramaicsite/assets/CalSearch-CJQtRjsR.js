import{d as A,c as r,M as g,b as w,a2 as F,aV as H,ax as U,a as E,$ as N,o as y,f as C,n as b,g as S,m as f,h as T,j as D,V as I,ay as J,_ as B,L as P,D as z,i as O,F as Q}from"./index-C0UkpNC5.js";import{u as _}from"./index-CpVqi2hU.js";import{g as G}from"./getRegexFilterFn-CU_0py8y.js";import{b as q}from"./betterSplit-CW8NIeFU.js";import{u as K,A as W}from"./assetsStore-BNdHD0CT.js";import{_ as X}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-DQxxV8EH.js";import{V as $}from"./VTextField-pm2eI9c2.js";import"./VInput-CLGBDmHW.js";import"./forwardRefs-DWGaNmQL.js";function Y(l,o,t="application/octet-stream"){const s=document.createElement("a"),i=new Blob([l],{type:t});s.href=URL.createObjectURL(i),s.download=o,s.click()}function h(l,o,t="",s=!1){const a=(t?`color: ${t};`:"")+(s?"font-weight: bold;":""),d=a?` style='${a}'`:"";return`<${o}${d}>${l}</${o}>`}function Z(l){const o=l.map(t=>`(?:${t})`).join("|");return RegExp(o)}const L=h("<br>","div"),ee=`=============
`,j=A("calStore",()=>{const l=K(),o=r(()=>{var e;return((e=l[W.calJson].data)==null?void 0:e.split(ee).filter(Boolean).map(p=>p.split(`
`)).map(([p,...V])=>({entryName:p.replace(/\.txt$/,""),contents:V,contentsString:V.join(`
`)})))||[]}),t=_("positive",""),s=_("negative",""),i=_("highlight",""),c=r(()=>({positive:t.value,negative:s.value,highlight:i.value})),a=r(()=>g.mapValues(c.value,oe)),d=r(()=>!a.value.positive.length&&!a.value.negative.length),u=r(()=>G(a.value.positive.map(e=>RegExp(e)),a.value.negative.map(e=>RegExp(e)))),m=r(()=>d.value?[]:o.value.filter(e=>u.value(e.contentsString))),x=r(()=>{const e=g.mapValues(a.value,p=>p.some(g.identity)&&p.join(", "));return[e.positive&&`Should contain: ${e.positive}`,e.negative&&`Should not contain: ${e.negative}`,e.highlight&&`Highlight: ${e.highlight}`].filter(Boolean).map(p=>h(p,"div","brown",!0))}),n=r(()=>{if(!m.value.length)return"";const e=[`Total: ${m.value.length} entries`].map(V=>h(V,"div","green",!0)),p=h("=".repeat(25),"div");return[...x.value,e,p].join(L)}),v=r(()=>g.values(a.value).flat()),R=r(()=>Z(v.value)),M=r(()=>{if(!m.value.length)return[];const e=m.value.map(ne(R.value));return[n.value,L,...e]}),k=r(()=>M.value.join(""));return{cal:o,positive:t,negative:s,highlight:i,searchers:c,searchObj:a,isNoSearch:d,calMatchingParts:M,calMatchingHTML:k}});function te(l){return function(o){const t=q(o,l).reduce((s,i,c)=>{const a=c%2?"red":"",d=c%2;return s+h(i,"span",a,d)},"");return h(t,"div")}}function ne(l){return function({entryName:o,contents:t}){const s=h("+".repeat(25),"div","blue"),i=h(o,"div","purple",!0),c=t.map(te(l));return[i,...c,s,L].join("")}}function oe(l){return g.chain(l).split(",").map(g.trim).compact().value()}const ae={class:"rows"},se=w({__name:"CalInputs",emits:["download"],setup(l,{emit:o}){F(x=>({a42cee84:c.value,"01ecb7c4":i.value}));const t=H(),{isDark:s}=U(),i=r(()=>t.current.value.colors.background),c=r(()=>t.current.value.colors.header),a=j(),d=o,u=E(a.searchers),m=g.debounce(()=>{N(()=>{g.assign(a,u)})},1e3);return(x,n)=>(y(),C("div",{class:J([{invert:f(s)},"inputs"])},[b("div",ae,[S($,{modelValue:u.positive,"onUpdate:modelValue":[n[0]||(n[0]=v=>u.positive=v),f(m)],variant:"outlined",density:"compact",autocomplete:"no",label:"Should contain",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n[4]||(n[4]=b("div",{class:"hint"},"e.g. Gal, Sam, CPA ",-1)),S($,{modelValue:u.negative,"onUpdate:modelValue":[n[1]||(n[1]=v=>u.negative=v),f(m)],variant:"outlined",density:"compact",autocomplete:"no",label:"Should not contain",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n[5]||(n[5]=b("div",{class:"hint"},"e.g. Syr, JBA, Man, Com",-1)),S($,{modelValue:u.highlight,"onUpdate:modelValue":[n[2]||(n[2]=v=>u.highlight=v),f(m)],variant:"outlined",density:"compact",autocomplete:"no",label:"Also highlight",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n[6]||(n[6]=b("div",{class:"hint"},"e.g. LJLA, Qumran, Jud",-1))]),S(I,{disabled:f(a).isNoSearch,color:"green",variant:"outlined",class:"button",size:"large",onClick:n[3]||(n[3]=v=>d("download"))},{default:T(()=>n[7]||(n[7]=[D(" Download ")])),_:1},8,["disabled"])],2))}}),le=B(se,[["__scopeId","data-v-d009929f"]]),re=["innerHTML"],ie=w({__name:"CalSearch",setup(l){const o=j(),{calMatchingParts:t,calMatchingHTML:s}=P(o),i=()=>{Y(s.value,"result.html")};return(c,a)=>(y(),z(X,{items:f(t),"is-root-scroll":"",class:"search-results-box"},{default:T(({items:d})=>[S(le,{onDownload:i}),(y(!0),C(Q,null,O(d,(u,m)=>(y(),C("div",{key:m},[b("div",{innerHTML:u},null,8,re)]))),128))]),_:1},8,["items"]))}}),be=B(ie,[["__scopeId","data-v-f55c442a"]]);export{be as default};
