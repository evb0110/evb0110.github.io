var M=Object.defineProperty;var x=(r,t,s)=>t in r?M(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var f=(r,t,s)=>x(r,typeof t!="symbol"?t+"":t,s);import{aT as L,c as m,M as A,d as F,al as I,r as S,aU as T}from"./index-Bc65w6Oc.js";import{u as j,A as _}from"./assetsStore-Ccgpth-6.js";import{o as B}from"./index-Dob3nYDb.js";import{u as G}from"./index--7L40bdp.js";const K=/[\p{M}]|[\u0701-\u0709]|[\u0730-\u074c]/gu,P=/[\p{M}]|[\u0701-\u0709]|[\u0730-\u074c]/u,U=/(?![\u0701-\u0709]|[\u0730-\u074c])[^\p{M}]/u;class y{constructor(t){f(this,"id",L());f(this,"str");f(this,"_nfd",null);f(this,"_stripped",null);f(this,"_chunks",null);this.str=t}static addFlagIfAbsent(t,s){return t.includes(s)?t:t+s}get nfd(){return this._nfd||this.cacheNFD(),this._nfd}get stripped(){return this._stripped||this.cacheStripped(),this._stripped}get chunks(){return this._chunks||this.cacheChunks(),this._chunks||[]}cacheNFD(){this._nfd||(this._nfd=this.str.normalize("NFD"))}cacheStripped(){var t;this._stripped||(this._stripped=((t=this.nfd)==null?void 0:t.replace(K,""))||"")}cacheChunks(){this._chunks||(this._chunks=this.str===this.stripped?this.str.split(""):this.makeNFDChunks())}makeNFDChunks(){var a;const t=((a=this.nfd)==null?void 0:a.split(""))||[],s=[];let e=0;s[e]="";for(let n=0;n<t.length;n++)s[e]+=t[n],n+1<t.length&&!P.test(t[n+1])&&U.test(s[e])&&(e++,s[e]="");return s}splitInclusive(t){t=RegExp(t.source,y.addFlagIfAbsent(t.flags,"g"));const s=Array.from(this.stripped.matchAll(t)),e=[];let a=0;for(const n of s){const c=n[0].length,i=n.index;e.push(this.chunks.slice(a,i).join("")),e.push(this.chunks.slice(i,i+c).join("")),a=i+c}return e.push(this.chunks.slice(a).join("")),e}}const q="aramaic-site",p="store",d=B(q,1,{upgrade(r){if(!r.objectStoreNames.contains(p))return r.createObjectStore(p)}});class w{static async get(t){return(await d).get(p,t)}static async set(t,s){return(await d).put(p,s,t)}static async delete(t){return(await d).delete(p,t)}static async clear(){return(await d).clear(p)}static async keys(){return(await d).getAllKeys(p)}}const v=(r,t)=>{const s=G(r),e=m({get:()=>{switch(s.value){case"true":return!0;case"false":return!1}},set:a=>{switch(a){case!0:s.value="true";break;case!1:s.value="false";break}}});return A.isBoolean(t)&&(e.value=t),e},z="ʔbgdhYwzḥṭyklmnsʕpṣqršt",J="AbgdhYwzHTyklmnsCpSqrWt",O="ܐܒܓܕܗܞܘܙܚܛܝܟܠܡܢܣܥܦܨܩܪܫܬ",[C,R,b]=[z,J,O].map(r=>r.split("")),$={translitArr:C,translitAnsiArr:R,originalLettersArr:b},V={pot:{name:"POT with Western vowels"},pnt:{name:"PNT with Western vowels"},syr:{name:"Syriac Corpus"}},tt=F("syriacCorpusStore",()=>{const r=j(),t=I([]),s=S(""),e=S(!1),a=v("simpleSymbols"),n=v("translit"),c=v("ignoreDiacritics"),i=m(()=>a.value?R:C),k=m(()=>{const u=s.value;return c.value?n.value?i.value.reduce((o,g,l)=>{const h=b[l],E=RegExp("(?<!\\\\)"+g,"gu");return o.replace(E,h)},u):new y(u).stripped:u}),N=m(()=>{if(!s.value)return[];const u=RegExp(k.value,"u");return c.value?t.value.filter(o=>u.test(o.line.stripped)):t.value.filter(o=>u.test(o.line.str))});async function D(u){t.value=[],e.value=!0;const o=u.map(l=>{switch(l){case"pot":return _.potJson;case"pnt":return _.pntJson;case"syr":default:return _.syrJson}}).flatMap(l=>{var h;return((h=r[l])==null?void 0:h.data)||[]}),g=await W(o);t.value=g.map(({filename:l,line:h})=>({filename:l,line:new y(h)})),e.value=!1}return{corpus:t,searchString:s,isPreprocessingSyriacCorpus:e,isSimpleSymbols:a,isTranslit:n,doIgnoreDiacritics:c,activeTranslitArr:i,finalSearchString:k,matchingSyriacLines:N,initSyriacCorpus:D}});async function W(r){const t=await T(r),s=await w.get("syriacCorpus")||{},e=s[t];if(e)return e;const a=r.flatMap(({filename:n,text:c})=>c.split(/\n+/).map(A.trim).map(i=>({filename:n,line:i})));return s[t]=a,await w.set("syriacCorpus",s),a}export{w as I,V as S,v as a,$ as s,tt as u};
