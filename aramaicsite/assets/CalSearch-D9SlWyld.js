import{d as F,c as r,M as g,b as T,a1 as H,aV as U,ax as E,a as N,o as y,f as x,n as S,g as b,m as f,h as j,j as I,V as J,ay as D,_ as B,L as P,F as w,i as z}from"./index-BndXiBJs.js";import{u as $}from"./index-D28CGL-2.js";import{g as O}from"./getRegexFilterFn-CU_0py8y.js";import{b as Q}from"./betterSplit-CW8NIeFU.js";import{u as G,A as q}from"./assetsStore-B8Olnj2j.js";import{_ as K}from"./InfiniteScrollOld.vue_vue_type_script_setup_true_lang-Di7EcDzV.js";import{s as W}from"./startViewTransition-CnFw7TNy.js";import{V as C}from"./VTextField-Bqha0Jd1.js";import"./VInput-Ukit73ke.js";import"./forwardRefs-DWGaNmQL.js";function X(l,o,t="application/octet-stream"){const s=document.createElement("a"),i=new Blob([l],{type:t});s.href=URL.createObjectURL(i),s.download=o,s.click()}function h(l,o,t="",s=!1){const a=(t?`color: ${t};`:"")+(s?"font-weight: bold;":""),d=a?` style='${a}'`:"";return`<${o}${d}>${l}</${o}>`}function Y(l){const o=l.map(t=>`(?:${t})`).join("|");return RegExp(o)}const L=h("<br>","div"),Z=`=============
`,R=F("calStore",()=>{const l=G(),o=r(()=>{var e;return((e=l[q.calJson].data)==null?void 0:e.split(Z).filter(Boolean).map(p=>p.split(`
`)).map(([p,...V])=>({entryName:p.replace(/\.txt$/,""),contents:V,contentsString:V.join(`
`)})))||[]}),t=$("positive",""),s=$("negative",""),i=$("highlight",""),u=r(()=>({positive:t.value,negative:s.value,highlight:i.value})),a=r(()=>g.mapValues(u.value,ne)),d=r(()=>!a.value.positive.length&&!a.value.negative.length),c=r(()=>O(a.value.positive.map(e=>RegExp(e)),a.value.negative.map(e=>RegExp(e)))),m=r(()=>d.value?[]:o.value.filter(e=>c.value(e.contentsString))),_=r(()=>{const e=g.mapValues(a.value,p=>p.some(g.identity)&&p.join(", "));return[e.positive&&`Should contain: ${e.positive}`,e.negative&&`Should not contain: ${e.negative}`,e.highlight&&`Highlight: ${e.highlight}`].filter(Boolean).map(p=>h(p,"div","brown",!0))}),n=r(()=>{if(!m.value.length)return"";const e=[`Total: ${m.value.length} entries`].map(V=>h(V,"div","green",!0)),p=h("=".repeat(25),"div");return[..._.value,e,p].join(L)}),v=r(()=>g.values(a.value).flat()),k=r(()=>Y(v.value)),M=r(()=>{if(!m.value.length)return[];const e=m.value.map(te(k.value));return[n.value,L,...e]}),A=r(()=>M.value.join(""));return{cal:o,positive:t,negative:s,highlight:i,searchers:u,searchObj:a,isNoSearch:d,calMatchingParts:M,calMatchingHTML:A}});function ee(l){return function(o){const t=Q(o,l).reduce((s,i,u)=>{const a=u%2?"red":"",d=u%2;return s+h(i,"span",a,d)},"");return h(t,"div")}}function te(l){return function({entryName:o,contents:t}){const s=h("+".repeat(25),"div","blue"),i=h(o,"div","purple",!0),u=t.map(ee(l));return[i,...u,s,L].join("")}}function ne(l){return g.chain(l).split(",").map(g.trim).compact().value()}const oe={class:"rows"},ae=T({__name:"CalInputs",emits:["download"],setup(l,{emit:o}){H(_=>({a42cee84:u.value,"01ecb7c4":i.value}));const t=U(),{isDark:s}=E(),i=r(()=>t.current.value.colors.background),u=r(()=>t.current.value.colors.header),a=R(),d=o,c=N(a.searchers),m=g.debounce(()=>{W(()=>{g.assign(a,c)})},1e3);return(_,n)=>(y(),x("div",{class:D([{invert:f(s)},"inputs"])},[S("div",oe,[b(C,{modelValue:c.positive,"onUpdate:modelValue":[n[0]||(n[0]=v=>c.positive=v),f(m)],variant:"outlined",density:"compact",autocomplete:"no",label:"Should contain",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n[4]||(n[4]=S("div",{class:"hint"},"e.g. Gal, Sam, CPA ",-1)),b(C,{modelValue:c.negative,"onUpdate:modelValue":[n[1]||(n[1]=v=>c.negative=v),f(m)],variant:"outlined",density:"compact",autocomplete:"no",label:"Should not contain",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n[5]||(n[5]=S("div",{class:"hint"},"e.g. Syr, JBA, Man, Com",-1)),b(C,{modelValue:c.highlight,"onUpdate:modelValue":[n[2]||(n[2]=v=>c.highlight=v),f(m)],variant:"outlined",density:"compact",autocomplete:"no",label:"Also highlight",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n[6]||(n[6]=S("div",{class:"hint"},"e.g. LJLA, Qumran, Jud",-1))]),b(J,{disabled:f(a).isNoSearch,color:"green",variant:"outlined",class:"button",size:"large",onClick:n[3]||(n[3]=v=>d("download"))},{default:j(()=>n[7]||(n[7]=[I(" Download ")])),_:1},8,["disabled"])],2))}}),se=B(ae,[["__scopeId","data-v-d009929f"]]),le=["innerHTML"],re=T({__name:"CalSearch",setup(l){const o=R(),{calMatchingParts:t,calMatchingHTML:s}=P(o),i=()=>{X(s.value,"result.html")};return(u,a)=>(y(),x(w,null,[b(se,{onDownload:i}),b(K,{items:f(t),class:"search-results-box"},{default:j(({items:d})=>[(y(!0),x(w,null,z(d,(c,m)=>(y(),x("div",{key:m},[S("div",{innerHTML:c},null,8,le)]))),128))]),_:1},8,["items"])],64))}}),be=B(re,[["__scopeId","data-v-e1d8d18b"]]);export{be as default};
