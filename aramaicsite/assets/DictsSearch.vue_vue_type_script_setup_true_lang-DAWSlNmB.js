var R=Object.defineProperty;var $=(s,e,t)=>e in s?R(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var h=(s,e,t)=>$(s,typeof e!="symbol"?e+"":e,t);import{d as N,a as O,c as m,w as F,b as E,e as P,o as i,f,F as v,i as M,D as d,h as S,j as x,k as b,V as B,p as A,_ as T,bn as z,g as L,m as p,bH as K,n as H}from"./index-BmEQ_S1N.js";import{u as I,L as C}from"./GrepLine.vue_vue_type_style_index_0_lang-BegEw5nL.js";import{u as Q}from"./index-CXZ00WhQ.js";import{u as X,S as q,a as G}from"./SearchResults-CmBlX7iY.js";import{u as U,A as V}from"./assetsStore-p4TiRUo-.js";var _=(s=>(s.BrowseAndSearch="BrowseAndSearch",s.DictsSearch="DictsSearch",s))(_||{});const j=N("componentMountStore",()=>{const s=O(new Set);function e(n){s.add(n)}function t(n){s.delete(n)}return{components:s,mount:e,unmount:t}}),W={[C.turoyo]:[{key:"ritter",title:"Ritter",isChosen:!0},{key:"jastrow",title:"Jastrow",isChosen:!1},{key:"jan",title:"XÃ«zne",isChosen:!1}],[C.maalula]:[{key:"arnold",title:"Arnold",isChosen:!0}]},Y=N("simpleDictStore",()=>{const s=U(),e=j(),t=I(),n=m(()=>{switch(t.value){case C.turoyo:return V.turoyoDictsJson;case C.maalula:default:return V.maalulaDictsJson}}),l=m(()=>{var a;return((a=s[n.value])==null?void 0:a.data)||{}}),o=Q("dict",[]),{searcher:c,searcherString:r}=X(),u=m(()=>W[t.value]||[]);F(()=>{e.components.has(_.DictsSearch)&&!o.value.length&&(o.value=u.value.filter(({isChosen:a})=>a).map(({key:a})=>a))});const D=m(()=>r.value?u.value.map(({key:a,title:g})=>{const J=w(a).filter(y=>c.value.regex.test(y)).map(y=>({title:"",line:y}));return{key:a,title:g,lines:J}}):[]);function w(a){var g;return((g=l.value)==null?void 0:g[a])||[]}return{searcher:c,initialDicts:u,dictData:l,searcherString:r,chosenDictionaries:o,matchingDictLinesArr:D}});class k{constructor({key:e,title:t,isChosen:n}){h(this,"key");h(this,"title");h(this,"isChosen");this.key=e,this.title=t,this.isChosen=n}toggle(){this.isChosen=!this.isChosen}choose(){this.isChosen=!0}unchoose(){this.isChosen=!1}static instantiate(e){return new k(e)}}class Z{constructor(e){h(this,"data");this.data=e.map(k.instantiate)}optionByKey(e){return this.data.find(t=>t.key===e)}toggle(e){var t;(t=this.optionByKey(e))==null||t.toggle()}chooseAll(){this.data.forEach(e=>e.choose())}unchooseAll(){this.data.forEach(e=>e.unchoose())}toggleAll(){this.areAllChosen?this.unchooseAll():this.chooseAll()}chooseKeys(e){this.unchooseAll(),this.data.forEach(t=>e!=null&&e.includes(t.key)?t.choose():t.unchoose())}get chosenKeys(){return this.data.filter(({isChosen:e})=>e).map(({key:e})=>e)}get areAllChosen(){return this.data.every(e=>e.isChosen)}}const ee={class:"container d-flex justify-center"},te=E({__name:"OptionsChooser",props:{optionsProp:{},hasAll:{type:Boolean},chosenOptions:{}},emits:["chosen-options"],setup(s,{emit:e}){const t=e,n=O(new Z(s.optionsProp));P(()=>s.chosenOptions,o=>n.chooseKeys(o),{immediate:!0});const l=o=>{o?n.toggle(o):n.toggleAll(),t("chosen-options",n.chosenKeys)};return(o,c)=>(i(),f("div",ee,[(i(!0),f(v,null,M(n.data,({title:r,key:u,isChosen:D})=>(i(),d(B,{key:u,variant:D?"outlined":"text",onClick:w=>l(u)},{default:S(()=>[x(b(r),1)]),_:2},1032,["variant","onClick"]))),128)),o.hasAll?(i(),d(B,{key:0,variant:n.areAllChosen?"outlined":"text"+o.foo,onClick:c[0]||(c[0]=r=>l())},{default:S(()=>c[1]||(c[1]=[x(" All ")])),_:1},8,["variant"])):A("",!0)]))}}),se=T(te,[["__scopeId","data-v-50fe08bd"]]),oe=s=>{const e=j();e.mount(s),z(()=>{e.unmount(s)})},he=E({__name:"DictsSearch",setup(s){const e=Y();oe(_.DictsSearch);const t=m(()=>e.matchingDictLinesArr.filter(({key:o})=>e.chosenDictionaries.includes(o)));function n(o){e.searcherString=o}function l(o){e.chosenDictionaries=o}return(o,c)=>(i(),f(v,null,[L(K,{class:"searcher-wrapper"},{default:S(()=>[L(q,{"searcher-string":p(e).searcherString,"corpus-name":o.corpusName,onSearcherString:n},null,8,["searcher-string","corpus-name"])]),_:1}),p(e).initialDicts.length>1?(i(),d(se,{key:0,"options-prop":p(e).initialDicts,"chosen-options":p(e).chosenDictionaries,"has-all":"",onChosenOptions:l},null,8,["options-prop","chosen-options"])):A("",!0),(i(!0),f(v,null,M(t.value,r=>(i(),d(K,{key:r.key},{default:S(()=>[H("h1",null,b(r.title),1),r.lines.length?(i(),d(G,{key:0,"lines-matching":r.lines,searcher:p(e).searcher},null,8,["lines-matching","searcher"])):A("",!0)]),_:2},1024))),128))],64))}});export{he as _};
