import{d as F,a1 as H,c as r,a2 as U,y as g,b as w,T as A,bx as E,bn as N,a as I,Q as J,o as x,f as C,n as b,g as S,m as f,h as M,j as D,V as P,ax as Q,_ as B,x as z,v as O,i as G,F as q}from"./index-DZd0l_Ui.js";import{u as _}from"./index-B4tkWkfU.js";import{g as K}from"./getRegexFilterFn-CU_0py8y.js";import{b as W}from"./betterSplit-CW8NIeFU.js";import{_ as X}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-C3FW6FFF.js";import{V as $}from"./VTextField-sUGCQIyH.js";import"./VField-OZLmlP_-.js";import"./index-B6QGlVGp.js";import"./transition-DD7NTUm4.js";import"./index-oQ0exmSc.js";function Y(l,o,t="application/octet-stream"){const s=document.createElement("a"),i=new Blob([l],{type:t});s.href=URL.createObjectURL(i),s.download=o,s.click()}function h(l,o,t="",s=!1){const a=(t?`color: ${t};`:"")+(s?"font-weight: bold;":""),d=a?` style='${a}'`:"";return`<${o}${d}>${l}</${o}>`}function Z(l){const o=l.map(t=>`(?:${t})`).join("|");return RegExp(o)}const L=h("<br>","div"),ee=`=============
`,j=F("calStore",()=>{const l=H(),o=r(()=>{var e;return((e=l[U.calJson].data)==null?void 0:e.split(ee).filter(Boolean).map(m=>m.split(`
`)).map(([m,...V])=>({entryName:m.replace(/\.txt$/,""),contents:V,contentsString:V.join(`
`)})))||[]}),t=_("positive",""),s=_("negative",""),i=_("highlight",""),c=r(()=>({positive:t.value,negative:s.value,highlight:i.value})),a=r(()=>g.mapValues(c.value,oe)),d=r(()=>!a.value.positive.length&&!a.value.negative.length),u=r(()=>K(a.value.positive.map(e=>RegExp(e)),a.value.negative.map(e=>RegExp(e)))),p=r(()=>d.value?[]:o.value.filter(e=>u.value(e.contentsString))),y=r(()=>{const e=g.mapValues(a.value,m=>m.some(g.identity)&&m.join(", "));return[e.positive&&`Should contain: ${e.positive}`,e.negative&&`Should not contain: ${e.negative}`,e.highlight&&`Highlight: ${e.highlight}`].filter(Boolean).map(m=>h(m,"div","brown",!0))}),n=r(()=>{if(!p.value.length)return"";const e=[`Total: ${p.value.length} entries`].map(V=>h(V,"div","green",!0)),m=h("=".repeat(25),"div");return[...y.value,e,m].join(L)}),v=r(()=>g.values(a.value).flat()),R=r(()=>Z(v.value)),T=r(()=>{if(!p.value.length)return[];const e=p.value.map(ne(R.value));return[n.value,L,...e]}),k=r(()=>T.value.join(""));return{cal:o,positive:t,negative:s,highlight:i,searchers:c,searchObj:a,isNoSearch:d,calMatchingParts:T,calMatchingHTML:k}});function te(l){return function(o){const t=W(o,l).reduce((s,i,c)=>{const a=c%2?"red":"",d=c%2;return s+h(i,"span",a,d)},"");return h(t,"div")}}function ne(l){return function({entryName:o,contents:t}){const s=h("+".repeat(25),"div","blue"),i=h(o,"div","purple",!0),c=t.map(te(l));return[i,...c,s,L].join("")}}function oe(l){return g.chain(l).split(",").map(g.trim).compact().value()}const ae={class:"rows"},se=w({__name:"CalInputs",emits:["download"],setup(l,{emit:o}){A(y=>({a42cee84:c.value,"01ecb7c4":i.value}));const t=E(),{isDark:s}=N(),i=r(()=>t.current.value.colors.background),c=r(()=>t.current.value.colors.header),a=j(),d=o,u=I(a.searchers),p=g.debounce(()=>{J(()=>{g.assign(a,u)})},1e3);return(y,n)=>(x(),C("div",{class:Q([{invert:f(s)},"inputs"])},[b("div",ae,[S($,{modelValue:u.positive,"onUpdate:modelValue":[n[0]||(n[0]=v=>u.positive=v),f(p)],variant:"outlined",density:"compact",autocomplete:"no",label:"Should contain",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n[4]||(n[4]=b("div",{class:"hint"},"e.g. Gal, Sam, CPA ",-1)),S($,{modelValue:u.negative,"onUpdate:modelValue":[n[1]||(n[1]=v=>u.negative=v),f(p)],variant:"outlined",density:"compact",autocomplete:"no",label:"Should not contain",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n[5]||(n[5]=b("div",{class:"hint"},"e.g. Syr, JBA, Man, Com",-1)),S($,{modelValue:u.highlight,"onUpdate:modelValue":[n[2]||(n[2]=v=>u.highlight=v),f(p)],variant:"outlined",density:"compact",autocomplete:"no",label:"Also highlight",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),n[6]||(n[6]=b("div",{class:"hint"},"e.g. LJLA, Qumran, Jud",-1))]),S(P,{disabled:f(a).isNoSearch,color:"green",variant:"outlined",class:"button",size:"large",onClick:n[3]||(n[3]=v=>d("download"))},{default:M(()=>n[7]||(n[7]=[D(" Download ")])),_:1},8,["disabled"])],2))}}),le=B(se,[["__scopeId","data-v-d009929f"]]),re=["innerHTML"],ie=w({__name:"CalSearch",setup(l){const o=j(),{calMatchingParts:t,calMatchingHTML:s}=z(o),i=()=>{Y(s.value,"result.html")};return(c,a)=>(x(),O(X,{items:f(t),"is-root-scroll":"",class:"search-results-box"},{default:M(({items:d})=>[S(le,{onDownload:i}),(x(!0),C(q,null,G(d,(u,p)=>(x(),C("div",{key:p},[b("div",{innerHTML:u},null,8,re)]))),128))]),_:1},8,["items"]))}}),Se=B(ie,[["__scopeId","data-v-f55c442a"]]);export{Se as default};
