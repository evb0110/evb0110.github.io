import{z as ve,ar as se,bh as pe,r as U,bo as he,c as h,bp as be,H as fe,bq as ye,g as o,I as oe,F as R,aE as ge,av as Se,bi as Ce,aX as me,J as ke,b as Ve,a as we,w as _e,y as m,ay as De,br as Ae,o as c,f as d,m as A,n,p as I,a4 as xe,aB as Be,l as Pe,h as y,j as Y,V as J,ax as F,i as L,a5 as X,k as w,v as M,bs as Re,_ as Te}from"./index-A2dtmQVC.js";import{u as Ee,a as O,S as ie,s as ee,I as re}from"./syriacCorpusStore-zWRjgBA8.js";import{_ as ze}from"./InfiniteScrollOld.vue_vue_type_script_setup_true_lang-BtLM07Nw.js";import{b as He}from"./betterSplit-CW8NIeFU.js";import{u as Ie}from"./index-BrJ1tfgv.js";import{V as Le}from"./VTextField-UgTcV7em.js";import{d as $e,a as Fe,V as ae,f as Me,e as Ue}from"./VRadioGroup-D2y6ofTR.js";import{V as qe}from"./index-BrL7OF0L.js";import{u as Ge,V as ne,m as Ne}from"./VField-tCl29vn-.js";import{a as ue,m as Oe}from"./VCheckboxBtn-Dg2Z5dYp.js";import{V as Ze}from"./VTooltip-p6wdQyd9.js";import"./index-Dob3nYDb.js";import"./transition-BltgP3Ds.js";import"./index-BTjyK_6c.js";import"./scopeId-C1S2p8LD.js";import"./VOverlay-B08zSa0t.js";function je(l){const[u,v,i]=Array.from({length:3}).map(()=>Math.floor(Math.random()*256));return Ke(u,v,i,l)}function Ke(l,u,v,i){const[b,p,_]=[l,u,v].map(f=>f.toString(16).padStart(2,"0")),s=Math.round(i*255).toString(16);return"#"+b+p+_+s}const ce={1792:"End of Paragraph",1793:"Supralinear Full Stop",1794:"Sublinear Full Stop",1795:"Supralinear Colon",1796:"Sublinear Colon",1797:"Horizontal Colon",1798:"Colon skewed left",1799:"Colon skewed right",1800:"Supralinear Colon skewed left",1801:"Sublinear Colon skewed right",1802:"Contraction",1803:"Harklean Obelus",1804:"Harklean Metobelus",1805:"Harklean Asteriscus",1807:"Abbreviation Mark",1808:"Alaph",1809:"Superscript Alaph",1810:"Beth",1811:"Gamal",1812:"Gamal Garshuni",1813:"Dalath",1814:"Dotless Dalath Rish",1815:"He",1816:"Waw",1817:"Zain",1818:"Heth",1819:"Teth",1820:"Teth Garshuni",1821:"Yudh",1822:"Yudh He",1823:"Kaph",1824:"Lamadh",1825:"Mim",1826:"Nun",1827:"Semkath",1828:"Final Semkath",1829:"E",1830:"Pe",1831:"Reversed Pe",1832:"Sadhe",1833:"Qaph",1834:"Rish",1835:"Shin",1836:"Taw",1837:"Persian Bheth",1838:"Persian Ghamal",1839:"Persian Dhalath",1869:"Sogdian Zhain",1870:"Sogdian Khaph",1871:"Sogdian Fe",1840:"Pthaha Above",1841:"Pthaha Below",1842:"Pthaha Dotted",1843:"Zqapha Above",1844:"Zqapha Below",1845:"Zqapha Dotted",1846:"Rbasa Above",1847:"Rbasa Below",1848:"Dotted Zlama Horizontal",1849:"Dotted Zlama Angular",1850:"Hbasa Above",1851:"Hbasa Below",1852:"Hbasa-Esata Dotted",1853:"Esasa Above",1854:"Esasa Below",1855:"Rwaha",1856:"Feminine Dot",1857:"Qushshaya",1858:"Rukkakha",1859:"Two Vertical Dots Above",1860:"Two Vertical Dots Below",1861:"Three Dots Above",1862:"Three Dots Below",1863:"Oblique Line Above",1864:"Oblique Line Below",1865:"Music",1866:"Barrekh",776:"Combining Diaeresis",803:"Combining Dot Below",775:"Combining Dot Above",1455:"Hebrew Mark Masora Circle"};function Qe(l){return l.split("").map(v=>{const i=v.charCodeAt(0);return ce[i]?ce[i]:v}).join(" | ")}async function We(l){try{await navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([l],{type:"text/html"}),"text/plain":new Blob([l],{type:"text/plain"})})])}catch{}}const de="<div><br> </div>",Ye='style="color: red;"',Je='style="color: purple;"',Xe='style="font-family: Estrangelo Edessa;"';function ea(l){const v=l.map(i=>{const b=`<div ${Je}>${i.filename}</div>`,p=i.splitted.map((s,f)=>`<span ${f%2?Ye:""}>${s}</span>`).join(""),_=`<div ${Xe}>${p}</div>`;return[b,_,de,de].join(`
`)}).join(`
`);We(v)}const aa=ke({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Ne(),...Oe()},"VSwitch"),te=ve()({name:"VSwitch",inheritAttrs:!1,props:aa(),emits:{"update:focused":l=>!0,"update:modelValue":l=>!0,"update:indeterminate":l=>!0},setup(l,u){let{attrs:v,slots:i}=u;const b=se(l,"indeterminate"),p=se(l,"modelValue"),{loaderClasses:_}=pe(l),{isFocused:s,focus:f,blur:g}=Ge(l),D=U(),T=he&&window.matchMedia("(forced-colors: active)").matches,C=h(()=>typeof l.loading=="string"&&l.loading!==""?l.loading:l.color),Z=be(),q=h(()=>l.id||`switch-${Z}`);function x(){b.value&&(b.value=!1)}function j(k){var B,S;k.stopPropagation(),k.preventDefault(),(S=(B=D.value)==null?void 0:B.input)==null||S.click()}return fe(()=>{const[k,B]=ye(v),S=ne.filterProps(l),G=ue.filterProps(l);return o(ne,oe({class:["v-switch",{"v-switch--flat":l.flat},{"v-switch--inset":l.inset},{"v-switch--indeterminate":b.value},_.value,l.class]},k,S,{modelValue:p.value,"onUpdate:modelValue":E=>p.value=E,id:q.value,focused:s.value,style:l.style}),{...i,default:E=>{let{id:z,messagesId:K,isDisabled:Q,isReadonly:H,isValid:N}=E;const $={model:p,isValid:N};return o(ue,oe({ref:D},G,{modelValue:p.value,"onUpdate:modelValue":[P=>p.value=P,x],id:z.value,"aria-describedby":K.value,type:"checkbox","aria-checked":b.value?"mixed":void 0,disabled:Q.value,readonly:H.value,onFocus:f,onBlur:g},B),{...i,default:P=>{let{backgroundColorClasses:t,backgroundColorStyles:e}=P;return o("div",{class:["v-switch__track",T?void 0:t.value],style:e.value,onClick:j},[i["track-true"]&&o("div",{key:"prepend",class:"v-switch__track-true"},[i["track-true"]($)]),i["track-false"]&&o("div",{key:"append",class:"v-switch__track-false"},[i["track-false"]($)])])},input:P=>{let{inputNode:t,icon:e,backgroundColorClasses:a,backgroundColorStyles:r}=P;return o(R,null,[t,o("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":e||l.loading},l.inset||T?void 0:a.value],style:l.inset?void 0:r.value},[i.thumb?o(ge,{defaults:{VIcon:{icon:e,size:"x-small"}}},{default:()=>[i.thumb({...$,icon:e})]}):o(qe,null,{default:()=>[l.loading?o(Ce,{name:"v-switch",active:!0,color:N.value===!1?void 0:C.value},{default:V=>i.loader?i.loader(V):o(me,{active:V.isActive,color:V.color,indeterminate:!0,size:"16",width:"2"},null)}):e&&o(Se,{key:String(e),icon:e,size:"x-small"},null)]})])])}})}})}),{}}}),ta={class:"syriac-corpus-search"},la={key:0,class:"processing-progress"},sa={class:"search-block"},oa={class:"switches-and-letters"},ia={class:"switches"},ra={key:0},na={class:"choose-corpora"},ua={key:1,class:"syriac-search-results"},ca={class:"search-stats"},da={class:"categories-wrapper"},ma={class:"category",style:{color:"red"}},va={style:{color:"green"}},pa={class:"selection-buttons"},ha={class:"syriac-text syriac-text-line"},ba="color: red; ",fa=Ve({__name:"CorpusSearch",setup(l){const u=Ee(),v={get chosenCorpora(){return{pnt:!0,pot:!0,syr:!1}}},i=O("ignoreDiacritics"),b=O("translit"),p=O("simpleSymbols"),_=O("categorize"),s=we({ignoreDiacritics:i.value??!0,translit:b.value??!0,simpleSymbols:p.value??!0,categorize:_.value??!1});_e(()=>{i.value=s.ignoreDiacritics,b.value=s.translit,p.value=s.simpleSymbols,_.value=s.categorize});const f=U(null),g=U({}),D=U(v.chosenCorpora),T=U(null),C=Ie("search","");C.value&&H();const Z=h(()=>m.toPairs(ie)),q=h(()=>m.toPairs(D.value).filter(([,t])=>t).map(([t])=>t)),x=h(()=>u.matchingSyriacLines.map(({filename:t,line:e})=>{const a=RegExp(u.finalSearchString,"u"),r=s.ignoreDiacritics?e.splitInclusive(a):He(e.str,a);return{id:e.id,filename:t,splitted:r}})),j=h(()=>m.chain(x.value).map(t=>t.splitted).map(t=>t.filter((e,a)=>a%2)).thru(m.spread(m.union)).uniq().value()),k=h(()=>{const t=m.chain(j.value).map(e=>[e,[]]).fromPairs().value();return x.value.forEach(e=>{e.splitted.filter((a,r)=>r%2).forEach(a=>{t[a]&&t[a].push(m.cloneDeep(e))})}),m.chain(t).toPairs().map(([e,a])=>[e,m.uniqBy(a,r=>r.id)]).sort((e,a)=>a[1].length-e[1].length).value()}),B=h(()=>{var t,e;return!s.categorize||!f.value?x.value:(e=(t=k.value)==null?void 0:t.find(([a])=>a===f.value))==null?void 0:e[1]}),S=h(()=>x.value.filter(({id:t})=>g.value[t])),G=h(()=>s.simpleSymbols?ee.translitAnsiArr:ee.translitArr),E=h(()=>G.value.map(()=>je(.08)).map(t=>({backgroundColor:t}))),z=h(()=>({translit:!s.ignoreDiacritics,ansi:!s.ignoreDiacritics||!s.translit}));(async()=>{const t=await re.get("chosenSyriacCorpora");t&&(D.value=m.pick(t,m.keys(ie))),u.initSyriacCorpus(q.value)})();const K=m.debounce(()=>{re.set("chosenSyriacCorpora",De(D.value)),u.initSyriacCorpus(q.value)},Ae.SEC),Q=(t,e)=>{const a=m.cloneDeep(g.value);t?a[e]=t:delete a[e],setTimeout(()=>g.value=a,0)};function H(){T.value=null,s.categorize=!1,f.value=null,u.searchString=C.value,g.value={}}function N(t){u.doIgnoreDiacritics=t,t||(s.translit=!1)}function $(t){C.value="",u.isTranslit=t}function P(t){C.value="",u.isSimpleSymbols=t}return(t,e)=>(c(),d("div",ta,[A(u).isPreprocessingSyriacCorpus?(c(),d("div",la,[e[9]||(e[9]=n("h4",null,"Preprocessing the Corpus",-1)),o(me,{size:200,width:15,color:"light-blue",indeterminate:"",striped:""})])):I("",!0),n("div",{class:F([{disabled:A(u).isPreprocessingSyriacCorpus},"search-block-and-switches"])},[n("div",sa,[o(Le,{modelValue:A(C),"onUpdate:modelValue":e[0]||(e[0]=a=>Pe(C)?C.value=a:null),class:"search-block__search-string",density:"compact",label:"Search string",variant:"outlined",clearable:"","onClick:clear":H,onKeyup:xe(Be(H,["prevent","stop"]),["enter","native"])},null,8,["modelValue","onKeyup"]),o(J,{variant:"outlined",onClick:H},{default:y(()=>e[10]||(e[10]=[Y(" Search ")])),_:1})]),n("div",null,[o(Fe,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=a=>T.value=a),elevation:1},{default:y(()=>[o($e,{title:"Regex hints"},{text:y(()=>e[11]||(e[11]=[n("pre",null,"[^ \\d]*(?<=[dwlb\\s^])(?<!qw)<b>dmyk</b>\\S*",-1),n("pre",null,"[^ \\d]*(?<=[dwlb\\s^])<b>tmyh</b>\\S*",-1)])),_:1})]),_:1},8,["modelValue"])]),n("div",oa,[n("div",ia,[o(te,{modelValue:s.ignoreDiacritics,"onUpdate:modelValue":[e[2]||(e[2]=a=>s.ignoreDiacritics=a),N],label:(s.ignoreDiacritics?"Ignore":"Respect")+" diacritics"},null,8,["modelValue","label"]),o(te,{modelValue:s.translit,"onUpdate:modelValue":[e[3]||(e[3]=a=>s.translit=a),$],class:F({disabled:z.value.translit}),disabled:z.value.translit,label:s.translit?"Transliteration":"Original letters"},null,8,["modelValue","class","disabled","label"]),o(te,{modelValue:s.simpleSymbols,"onUpdate:modelValue":[e[4]||(e[4]=a=>s.simpleSymbols=a),P],class:F({disabled:z.value.ansi}),disabled:z.value.ansi,label:s.simpleSymbols?"Simple symbols":"Scientific transliteration"},null,8,["modelValue","class","disabled","label"])]),s.translit?(c(),d("table",ra,[n("tbody",null,[n("tr",null,[(c(!0),d(R,null,L(A(ee).originalLettersArr,(a,r)=>(c(),d("td",{key:a,style:X(E.value[r]),class:"syriac-text"},w(a),5))),128))]),n("tr",null,[(c(!0),d(R,null,L(G.value,(a,r)=>(c(),d("td",{key:a,style:X(E.value[r])},w(a),5))),128))])])])):I("",!0)]),n("div",na,[(c(!0),d(R,null,L(Z.value,([a,r])=>(c(),M(ae,{modelValue:D.value[a],"onUpdate:modelValue":[V=>D.value[a]=V,A(K)],key:a,label:r.name},null,8,["modelValue","onUpdate:modelValue","label"]))),128))])],2),A(u).searchString?(c(),d("div",ua,[n("div",ca," Found "+w(x.value.length)+" contexts ",1),n("div",da,[k.value.length>1?(c(),M(ae,{key:0,modelValue:s.categorize,"onUpdate:modelValue":e[5]||(e[5]=a=>s.categorize=a),class:F({disabled:!s.ignoreDiacritics}),disabled:!s.ignoreDiacritics,label:`Show ${k.value.length} categories`},null,8,["modelValue","class","disabled","label"])):I("",!0),s.categorize?(c(),M(Ue,{key:1,modelValue:f.value,"onUpdate:modelValue":e[6]||(e[6]=a=>f.value=a),class:"radio-group","hide-details":"",row:""},{default:y(()=>[(c(!0),d(R,null,L(k.value,([a,r])=>(c(),M(Me,{key:a,value:a,class:"radio-button"},{label:y(()=>[o(Ze,{top:""},{activator:y(({on:V})=>[n("label",Re(V,!0),[n("span",ma,w(`${a}`),1)],16)]),default:y(()=>[n("span",null,w(`${A(Qe)(a)}`),1)]),_:2},1024),n("span",va,w(`(${r.length})`),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):I("",!0)]),n("div",pa,[o(J,{disabled:!S.value.length,color:"primary",variant:"outlined",tile:"","x-large":"",onClick:e[7]||(e[7]=a=>A(ea)(S.value))},{default:y(()=>[Y(" Copy Selection "+w(S.value.length?`(${S.value.length})`:"")+" To Clipboard ",1)]),_:1},8,["disabled"]),o(J,{disabled:!S.value.length,color:"#ffa500",variant:"outlined",tile:"","x-large":"",onClick:e[8]||(e[8]=a=>g.value={})},{default:y(()=>e[12]||(e[12]=[Y(" Clear Selection ")])),_:1},8,["disabled"])]),B.value?(c(),M(ze,{key:0,items:B.value},{default:y(({items:a})=>[(c(!0),d(R,null,L(a,(r,V)=>(c(),d("div",{key:V,class:"grep-line"},[o(ae,{"model-value":g.value[r.id],"onUpdate:modelValue":W=>Q(W,r.id)},{label:y(()=>[n("div",{class:F({"in-buffer":g.value[r.id]}),style:{color:"purple"}},w(r.filename),3)]),_:2},1032,["model-value","onUpdate:modelValue"]),n("div",ha,[(c(!0),d(R,null,L(r.splitted,(W,le)=>(c(),d("span",{key:le,style:X(le%2?ba:"")},w(W),5))),128))])]))),128))]),_:1},8,["items"])):I("",!0)])):I("",!0)]))}}),za=Te(fa,[["__scopeId","data-v-009b7a5c"]]);export{za as default};
