import{d as U,c as r,M as g,b as M,a1 as A,aU as F,aw as H,a as E,o as y,f as C,n as b,g as S,m as f,h as T,j as N,V as D,ax as I,_ as B,L as J,D as P,i as z,F as O}from"./index-DMQf1O_k.js";import{u as _}from"./index-BLy5M0uB.js";import{g as Q}from"./getRegexFilterFn-CU_0py8y.js";import{b as G}from"./betterSplit-CW8NIeFU.js";import{u as q,A as K}from"./assetsStore-DoG6ncEr.js";import{_ as W}from"./InfiniteScroll.vue_vue_type_script_setup_true_lang-DjrTytQL.js";import{s as X}from"./startViewTransition-CnFw7TNy.js";import{V as $}from"./VTextField-BOW8IMRG.js";import"./VInput-Dbp1XgiD.js";import"./forwardRefs-DWGaNmQL.js";function Y(l,n,t="application/octet-stream"){const s=document.createElement("a"),i=new Blob([l],{type:t});s.href=URL.createObjectURL(i),s.download=n,s.click()}function h(l,n,t="",s=!1){const a=(t?`color: ${t};`:"")+(s?"font-weight: bold;":""),d=a?` style='${a}'`:"";return`<${n}${d}>${l}</${n}>`}function Z(l){const n=l.map(t=>`(?:${t})`).join("|");return RegExp(n)}const L=h("<br>","div"),ee=`=============
`,j=U("calStore",()=>{const l=q(),n=r(()=>{var e;return((e=l[K.calJson].data)==null?void 0:e.split(ee).filter(Boolean).map(p=>p.split(`
`)).map(([p,...V])=>({entryName:p.replace(/\.txt$/,""),contents:V,contentsString:V.join(`
`)})))||[]}),t=_("positive",""),s=_("negative",""),i=_("highlight",""),c=r(()=>({positive:t.value,negative:s.value,highlight:i.value})),a=r(()=>g.mapValues(c.value,ne)),d=r(()=>!a.value.positive.length&&!a.value.negative.length),u=r(()=>Q(a.value.positive.map(e=>RegExp(e)),a.value.negative.map(e=>RegExp(e)))),m=r(()=>d.value?[]:n.value.filter(e=>u.value(e.contentsString))),x=r(()=>{const e=g.mapValues(a.value,p=>p.some(g.identity)&&p.join(", "));return[e.positive&&`Should contain: ${e.positive}`,e.negative&&`Should not contain: ${e.negative}`,e.highlight&&`Highlight: ${e.highlight}`].filter(Boolean).map(p=>h(p,"div","brown",!0))}),o=r(()=>{if(!m.value.length)return"";const e=[`Total: ${m.value.length} entries`].map(V=>h(V,"div","green",!0)),p=h("=".repeat(25),"div");return[...x.value,e,p].join(L)}),v=r(()=>g.values(a.value).flat()),R=r(()=>Z(v.value)),w=r(()=>{if(!m.value.length)return[];const e=m.value.map(oe(R.value));return[o.value,L,...e]}),k=r(()=>w.value.join(""));return{cal:n,positive:t,negative:s,highlight:i,searchers:c,searchObj:a,isNoSearch:d,calMatchingParts:w,calMatchingHTML:k}});function te(l){return function(n){const t=G(n,l).reduce((s,i,c)=>{const a=c%2?"red":"",d=c%2;return s+h(i,"span",a,d)},"");return h(t,"div")}}function oe(l){return function({entryName:n,contents:t}){const s=h("+".repeat(25),"div","blue"),i=h(n,"div","purple",!0),c=t.map(te(l));return[i,...c,s,L].join("")}}function ne(l){return g.chain(l).split(",").map(g.trim).compact().value()}const ae={class:"rows"},se=M({__name:"CalInputs",emits:["download"],setup(l,{emit:n}){A(x=>({a42cee84:c.value,"01ecb7c4":i.value}));const t=F(),{isDark:s}=H(),i=r(()=>t.current.value.colors.background),c=r(()=>t.current.value.colors.header),a=j(),d=n,u=E(a.searchers),m=g.debounce(()=>{X(()=>{g.assign(a,u)})},1e3);return(x,o)=>(y(),C("div",{class:I([{invert:f(s)},"inputs"])},[b("div",ae,[S($,{modelValue:u.positive,"onUpdate:modelValue":[o[0]||(o[0]=v=>u.positive=v),f(m)],variant:"outlined",density:"compact",autocomplete:"no",label:"Should contain",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),o[4]||(o[4]=b("div",{class:"hint"},"e.g. Gal, Sam, CPA ",-1)),S($,{modelValue:u.negative,"onUpdate:modelValue":[o[1]||(o[1]=v=>u.negative=v),f(m)],variant:"outlined",density:"compact",autocomplete:"no",label:"Should not contain",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),o[5]||(o[5]=b("div",{class:"hint"},"e.g. Syr, JBA, Man, Com",-1)),S($,{modelValue:u.highlight,"onUpdate:modelValue":[o[2]||(o[2]=v=>u.highlight=v),f(m)],variant:"outlined",density:"compact",autocomplete:"no",label:"Also highlight",clearable:"","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),o[6]||(o[6]=b("div",{class:"hint"},"e.g. LJLA, Qumran, Jud",-1))]),S(D,{disabled:f(a).isNoSearch,color:"green",variant:"outlined",class:"button",size:"large",onClick:o[3]||(o[3]=v=>d("download"))},{default:T(()=>o[7]||(o[7]=[N(" Download ")])),_:1},8,["disabled"])],2))}}),le=B(se,[["__scopeId","data-v-d009929f"]]),re=["innerHTML"],ie=M({__name:"CalSearch",setup(l){const n=j(),{calMatchingParts:t,calMatchingHTML:s}=J(n),i=()=>{Y(s.value,"result.html")};return(c,a)=>(y(),P(W,{items:f(t),"is-root-scroll":"",class:"search-results-box"},{default:T(({items:d})=>[S(le,{onDownload:i}),(y(!0),C(O,null,z(d,(u,m)=>(y(),C("div",{key:m},[b("div",{innerHTML:u},null,8,re)]))),128))]),_:1},8,["items"]))}}),Se=B(ie,[["__scopeId","data-v-f55c442a"]]);export{Se as default};
